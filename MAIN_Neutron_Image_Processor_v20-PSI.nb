(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    432391,       9292]
NotebookOptionsPosition[    405407,       8834]
NotebookOutlinePosition[    406014,       8855]
CellTagsIndexPosition[    405971,       8852]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Default :
upperLimit = Length@files;
testBatch = selectedImages;

fieldOfView:
112.8  for Rounds I & II
123.125 for Round III\
\>", "Abstract",
 CellChangeTimes->{{3.7670129024547567`*^9, 3.7670129391062937`*^9}, {
   3.7670241182202716`*^9, 3.7670241261062202`*^9}, {3.7670275663942585`*^9, 
   3.767027572537467*^9}, {3.769231259524869*^9, 3.769231295305197*^9}, 
   3.78196442085034*^9, 3.7819645909344263`*^9, {3.7819650079479833`*^9, 
   3.7819650173361454`*^9}, 3.781965438367121*^9, {3.806853380556097*^9, 
   3.806853383373561*^9}, {3.807010200749958*^9, 3.807010238774444*^9}, 
   3.8073489176454964`*^9},ExpressionUUID->"76b6aff5-3fbb-4e32-afe8-\
4cc5af2f6a3c"],

Cell["Possible Improvements", "Abstract",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
  3.769158606943906*^9, 3.7691586572504983`*^9}, {3.7692223025981207`*^9, 
  3.769222339641034*^9}},ExpressionUUID->"3dc700d4-5b6b-41d8-9979-\
0e29b4ad4067"],

Cell["Use Compile, when appropriate, throughout the code", "Subitem",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
   3.769158606943906*^9, 3.7691586572504983`*^9}, 3.7692223043414335`*^9, {
   3.769222342585159*^9, 3.769222345000705*^9}, {3.769230882123254*^9, 
   3.769230908195506*^9}, {3.770115650982784*^9, 3.7701156661114388`*^9}, {
   3.804171808390911*^9, 
   3.804171808392909*^9}},ExpressionUUID->"2820d418-f4f9-41d2-ba5d-\
5f1758558e62"],

Cell[CellGroupData[{

Cell["Initialize", "Section",
 CellChangeTimes->{{3.7601694528358383`*^9, 
  3.760169472551669*^9}},ExpressionUUID->"ca134099-a44f-4fdc-af75-\
6ea375b76f8d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$HistoryLength", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"CellContext", "\[Rule]", "Notebook"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"$Context", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fieldOfView", ":=", "123.125"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"packageDirectory", ":=", 
  "\"\<C:\\\\Michael's Folder\\\\INM Files\\\\NMI (VTPMML)\\\\MHD \
Project\\\\Image Processing\\\\Mathematica Packages\\\\\>\""}], "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{"packageDirectory", "<>", "\"\<QuantileRegression.m\>\""}], "]"}],
    ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nbd", "=", 
   RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"imageDirectory", ":=", 
  "\"\<W:\\\\MHD - Neutron Imaging\\\\Round III\\\\Image Processing Tests\\\\\
\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subFolder", "=", 
    RowBox[{
    "imageDirectory", "<>", 
     "\"\<VFS 125 mT 120 sccm\\\\120 sccm v4\\\\\>\""}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"output", ":=", 
  RowBox[{"nbd", "<>", "\"\<Output\\\\\>\""}]}], "\[IndentingNewLine]", 
 RowBox[{"input", ":=", "\"\<Input\\\\\>\""}], "\[IndentingNewLine]", 
 RowBox[{"shapesFolder", ":=", "\"\<Shapes\\\\\>\""}], "\n", 
 RowBox[{"correctedFolder", ":=", 
  "\"\<Corrected Images\\\\\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"traceFolder", ":=", "\"\<Tracing\\\\\>\""}], "\n", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "@", "subFolder"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"files", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToExpression", "@", 
        RowBox[{"FileBaseName", "[", "#", "]"}]}], "&"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowerLimit", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upperLimit", "=", 
   RowBox[{"Length", "@", "files"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectedImages", "=", 
   RowBox[{"upperLimit", "-", "lowerLimit", "+", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"testBatch", "=", "selectedImages"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"defaultWidthPixels", ":=", "1024"}], "\[IndentingNewLine]", 
 RowBox[{"widthPixels", ":=", "1024"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameRate", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toCentimeters", "=", "10"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"useKernels", "=", 
   RowBox[{
    RowBox[{"2", "*", "$ProcessorCount"}], "-", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedVariable", "@", "monitorCounter"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"Plot", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"ListPlot", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"ListLinePlot", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"Histogram", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
       RowBox[{"ChartElementFunction", "\[Rule]", "\"\<GlassRectangle\>\""}], 
       ",", 
       RowBox[{"ColorFunction", "\[Rule]", "\"\<GrayTones\>\""}], ",", 
       RowBox[{"LabelingFunction", "\[Rule]", "Above"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axesLabelsVelocity", ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<y, cm\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(v\), \(y\)]\), cm/s\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<y, cm\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(v\), \(x\)]\), cm/s\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<y, cm\>\"", ",", "\"\<v, cm/s\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<x, cm\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(v\), \(y\)]\), cm/s\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<x, cm\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(v\), \(x\)]\), cm/s\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<x, cm\>\"", ",", "\"\<v, cm/s\>\""}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"axesLabelsShape", ":=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<y, cm\>\"", ",", "\"\<Radius, mm\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<y, cm\>\"", ",", 
       "\"\<Area, \!\(\*SuperscriptBox[\(mm\), \(2\)]\)\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<y, cm\>\"", ",", "\"\<Aspect Ratio\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<y, cm\>\"", ",", "\"\<Eccentricity\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<y, cm\>\"", ",", "\"\<Tilt, \[Degree]\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<y, cm\>\"", ",", "\"\<Tilt Magnitude, \[Degree]\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<x, cm\>\"", ",", "\"\<Radius, mm\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<x, cm\>\"", ",", 
       "\"\<Area, \!\(\*SuperscriptBox[\(mm\), \(2\)]\)\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<x, cm\>\"", ",", "\"\<Aspect Ratio\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<x, cm\>\"", ",", "\"\<Eccentricity\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<x, cm\>\"", ",", "\"\<Tilt, \[Degree]\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\"\<x, cm\>\"", ",", "\"\<Tilt Magnitude, \[Degree]\>\""}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"progress", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"TableForm", "@", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<Processing...\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"ProgressIndicator", "@", 
       RowBox[{"Dynamic", "[", 
        RowBox[{
         RowBox[{"x", "/", "y"}], "//", "N"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{"Round", "@", "x"}]}], "<>", "\"\</\>\"", "<>", 
       RowBox[{"ToString", "@", "y"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"ToString", "@", 
       RowBox[{"PercentForm", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "/", "y"}], "//", "N"}], ",", 
         RowBox[{"DefaultPrintPrecision", "\[Rule]", "1"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"launchNukes", "[", "useKernels_", "]"}], ":=", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "@", 
        RowBox[{"Kernels", "[", "]"}]}], "<", "useKernels"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Speak", "@", "\"\<Set DEFCON 1\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LaunchKernels", "[", "\[IndentingNewLine]", 
        RowBox[{"useKernels", "-", 
         RowBox[{"Length", "@", 
          RowBox[{"Kernels", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      ",", "\[IndentingNewLine]", "Nothing"}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"memoizationSync", "[", "f_Symbol", "]"}], "[", "x_", "]"}], ":=", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"result", "=", 
       RowBox[{"memo", "[", 
        RowBox[{"f", ",", "x"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "===", "Null"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"value", "=", 
           RowBox[{"valueOnMain", "[", 
            RowBox[{"f", ",", "x"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"value", "===", "Null"}], ",", "\[IndentingNewLine]", 
           RowBox[{"f", "/:", 
            RowBox[{"memo", "[", 
             RowBox[{"f", ",", "x"}], "]"}], "=", 
            RowBox[{"setValueOnMain", "[", 
             RowBox[{"f", ",", "x", ",", 
              RowBox[{"f", "[", "x", "]"}]}], "]"}]}], ",", 
           RowBox[{"f", "/:", 
            RowBox[{"memo", "[", 
             RowBox[{"f", ",", "x"}], "]"}], "=", "value"}]}], "]"}]}], "]"}],
        ",", "result"}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"memo", "[", "___", "]"}], ":=", "Null"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DistributeDefinitions", "@", "memo"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"valueOnMain", "[", 
    RowBox[{"f_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"memo", "[", 
    RowBox[{"f", ",", "x"}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setValueOnMain", "[", 
    RowBox[{"f_", ",", "x_", ",", "fx_"}], "]"}], ":=", 
   RowBox[{"f", "/:", 
    RowBox[{"memo", "[", 
     RowBox[{"f", ",", "x"}], "]"}], "=", "fx"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetSharedFunction", "[", 
   RowBox[{"valueOnMain", ",", "setValueOnMain"}], "]"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"clearParallelCache", "[", "f_Symbol", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"UpValues", "@", "f"}], "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ParallelEvaluate", "[", 
      RowBox[{
       RowBox[{"UpValues", "@", "f"}], "=", 
       RowBox[{"{", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], 
  "\n", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DirectoryQ", "@", "output"}], ",", "\[IndentingNewLine]", 
     "Nothing", ",", "\[IndentingNewLine]", 
     RowBox[{"CreateDirectory", "@", "output"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launchNukes", "@", "useKernels"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7177377158430915`*^9, 3.717737755035079*^9}, {
   3.717737785881243*^9, 3.7177378777432365`*^9}, {3.717737915081128*^9, 
   3.7177380504220033`*^9}, {3.7177380880730743`*^9, 3.717738300412363*^9}, {
   3.7177383333519278`*^9, 3.7177383334300537`*^9}, {3.7177383751516523`*^9, 
   3.71773861392185*^9}, {3.7177386519353323`*^9, 3.717739081522292*^9}, {
   3.717743829219696*^9, 3.7177438660163803`*^9}, {3.7177440825436897`*^9, 
   3.7177441583677993`*^9}, {3.7177441965440702`*^9, 
   3.7177441966913266`*^9}, {3.7237333110360184`*^9, 
   3.7237333200208473`*^9}, {3.7264886469717426`*^9, 
   3.7264886600385194`*^9}, {3.7283034273935757`*^9, 
   3.7283034581743827`*^9}, {3.729676337796929*^9, 3.729676341823734*^9}, {
   3.747041048631316*^9, 3.74704104879334*^9}, {3.7513674506230288`*^9, 
   3.7513674979286723`*^9}, {3.7513707604688616`*^9, 3.7513707609725127`*^9}, 
   3.751712760209059*^9, {3.751718054524271*^9, 3.751718059769699*^9}, {
   3.7518135482953935`*^9, 3.7518135725814433`*^9}, {3.7518710407937007`*^9, 
   3.751871052004719*^9}, {3.751871358211807*^9, 3.751871364445162*^9}, {
   3.751879175723353*^9, 3.7518791825590715`*^9}, {3.7519575243057594`*^9, 
   3.751957528260184*^9}, {3.7519581327610455`*^9, 3.7519581412344737`*^9}, {
   3.751958453957793*^9, 3.7519584557566743`*^9}, {3.751968334426799*^9, 
   3.7519683353822217`*^9}, {3.7519700282986717`*^9, 3.75197002848617*^9}, {
   3.7519737833049164`*^9, 3.75197380799761*^9}, {3.7519738973199735`*^9, 
   3.7519738974366484`*^9}, 3.751974453373953*^9, 3.7519744838607883`*^9, {
   3.7519745775281367`*^9, 3.7519745791647434`*^9}, {3.7519863856792855`*^9, 
   3.751986410580202*^9}, {3.751987189723457*^9, 3.7519872067171807`*^9}, {
   3.7519872740525713`*^9, 3.751987274251018*^9}, 3.7519887579797745`*^9, {
   3.7519888044417067`*^9, 3.7519888045384264`*^9}, {3.7519889388743944`*^9, 
   3.751988953257942*^9}, {3.75198898540973*^9, 3.7519889857218943`*^9}, {
   3.7519891583567*^9, 3.751989168418381*^9}, {3.751989242284319*^9, 
   3.7519892558884606`*^9}, {3.7519893723305483`*^9, 3.751989372402337*^9}, {
   3.7519931269744205`*^9, 3.7519931279248924`*^9}, {3.751993166925639*^9, 
   3.7519931670293694`*^9}, 3.75199861425095*^9, {3.7519986697422304`*^9, 
   3.7519986922896194`*^9}, {3.751999213796385*^9, 3.7519992351032796`*^9}, {
   3.7519994435814323`*^9, 3.7519994603814545`*^9}, {3.7519996162634587`*^9, 
   3.7519996233658457`*^9}, {3.7519999333676405`*^9, 
   3.7519999359958153`*^9}, {3.7520002180623083`*^9, 
   3.7520002187803435`*^9}, {3.7520002493768325`*^9, 
   3.7520002505482464`*^9}, {3.752000407725655*^9, 3.752000411067837*^9}, {
   3.7520004699823575`*^9, 3.75200047026727*^9}, {3.7520022702769604`*^9, 
   3.7520022747149506`*^9}, {3.7520046929402857`*^9, 
   3.7520046960967264`*^9}, {3.7520502955602303`*^9, 
   3.7520503446601734`*^9}, {3.7520514690035224`*^9, 
   3.7520514690514917`*^9}, {3.7520515670681887`*^9, 
   3.7520515977009263`*^9}, {3.7520517074841633`*^9, 
   3.7520517090997686`*^9}, {3.7520518266893578`*^9, 
   3.7520518310232763`*^9}, {3.7520519932426023`*^9, 
   3.7520519966515093`*^9}, {3.752211767119261*^9, 3.7522117933048677`*^9}, 
   3.7522118378507395`*^9, {3.7522119014341974`*^9, 3.7522119154280024`*^9}, {
   3.752211947983062*^9, 3.7522119754180403`*^9}, {3.75238986004722*^9, 
   3.7523898600877047`*^9}, 3.759935401921358*^9, {3.7600950420507*^9, 
   3.7600950507155514`*^9}, 3.76009546165426*^9, {3.760097847762862*^9, 
   3.7600978479823008`*^9}, {3.7601571295604706`*^9, 3.760157129648235*^9}, 
   3.7601592766146355`*^9, {3.7601729472799244`*^9, 3.760172947511306*^9}, {
   3.7601732107197742`*^9, 3.760173211161602*^9}, 3.760175621125779*^9, 
   3.7602497894762554`*^9, 3.7602549941536517`*^9, 3.7602587711196823`*^9, {
   3.760269954882045*^9, 3.760269955256042*^9}, {3.7602794081805344`*^9, 
   3.760279410170213*^9}, {3.7602794702182603`*^9, 3.7602794767148857`*^9}, {
   3.7603410399150243`*^9, 3.760341041124792*^9}, {3.7604556788470125`*^9, 
   3.760455727922307*^9}, {3.7607682966617975`*^9, 3.760768308975419*^9}, 
   3.7607854536095047`*^9, {3.7608865838057194`*^9, 3.760886593361717*^9}, {
   3.7608866844010015`*^9, 3.7608866845675573`*^9}, {3.760887388038473*^9, 
   3.7608873882957788`*^9}, {3.760892595971661*^9, 3.7608926320929804`*^9}, {
   3.760929281108795*^9, 3.7609292932042255`*^9}, {3.7609293967314425`*^9, 
   3.7609294116522813`*^9}, {3.7609299152508698`*^9, 
   3.7609299156738005`*^9}, {3.760929954547063*^9, 3.7609300117870555`*^9}, {
   3.7609305684759817`*^9, 3.7609305685647535`*^9}, {3.7609314858821344`*^9, 
   3.7609314866510773`*^9}, {3.76093194642652*^9, 3.7609320560911016`*^9}, {
   3.7609321259960537`*^9, 3.760932174706381*^9}, {3.760932243970749*^9, 
   3.7609322520343113`*^9}, {3.7609322828032403`*^9, 
   3.7609322830575356`*^9}, {3.7609323214867444`*^9, 3.760932328043228*^9}, {
   3.7609324262318645`*^9, 3.760932446891398*^9}, {3.7609325111705904`*^9, 
   3.7609325119006367`*^9}, {3.760932875991317*^9, 3.760932877280859*^9}, 
   3.7609344640420094`*^9, {3.7609346032407713`*^9, 3.7609346068281736`*^9}, 
   3.7609433236004734`*^9, {3.760956474733452*^9, 3.760956588831177*^9}, {
   3.760957423846837*^9, 3.760957424285645*^9}, {3.7609580829565725`*^9, 
   3.760958083252755*^9}, {3.7609624911993523`*^9, 3.760962491368901*^9}, 
   3.760964457907423*^9, {3.7609646733113832`*^9, 3.7609646739666595`*^9}, {
   3.7612251729077897`*^9, 3.761225175298395*^9}, 3.761228707061983*^9, {
   3.761228758894994*^9, 3.7612287693206973`*^9}, 3.76122887626292*^9, {
   3.761241692049399*^9, 3.761241700577155*^9}, {3.761276326824277*^9, 
   3.7612763974426746`*^9}, {3.761276432872349*^9, 3.7612764775169487`*^9}, {
   3.7612946605842495`*^9, 3.761294670639862*^9}, {3.761299408431904*^9, 
   3.761299408500719*^9}, {3.7612996367268124`*^9, 3.7612996374924726`*^9}, {
   3.761300049404646*^9, 3.7613000513349247`*^9}, 3.7613041176850076`*^9, {
   3.7613180259074817`*^9, 3.7613180299262967`*^9}, {3.761326801495341*^9, 
   3.761326801590087*^9}, {3.761361249393982*^9, 3.7613612743078856`*^9}, 
   3.761361637701935*^9, 3.7613688777915*^9, {3.7613702345313025`*^9, 
   3.761370234824539*^9}, 3.7613711538469987`*^9, {3.7613717056648607`*^9, 
   3.761371739016631*^9}, {3.7613737377183404`*^9, 3.761373764221431*^9}, {
   3.7613739329982166`*^9, 3.7613739347046556`*^9}, {3.76138015596413*^9, 
   3.7613801562354217`*^9}, 3.7613846372534046`*^9, 3.7613861252512884`*^9, {
   3.761386510741501*^9, 3.761386512992342*^9}, {3.76138735930517*^9, 
   3.7613873604308023`*^9}, 3.7613919238287992`*^9, {3.7613966008619995`*^9, 
   3.761396602922511*^9}, {3.761636027755991*^9, 3.7616360430679235`*^9}, {
   3.766942172979191*^9, 3.766942185577417*^9}, 3.76694229048433*^9, {
   3.76698598843591*^9, 3.766985991303247*^9}, 3.7669860317540455`*^9, {
   3.7669913037058306`*^9, 3.7669913039282355`*^9}, 3.7670126231138024`*^9, 
   3.767012709196599*^9, {3.7670139258103695`*^9, 3.767013947480813*^9}, {
   3.767021749847092*^9, 3.7670217534872546`*^9}, {3.768653732446519*^9, 
   3.768653732775638*^9}, 3.768653806757841*^9, 3.768654833538556*^9, {
   3.7690915969429607`*^9, 3.769091604654603*^9}, 3.7690926375926604`*^9, {
   3.769092687161451*^9, 3.7690926909751077`*^9}, {3.7691367179698753`*^9, 
   3.7691367268764544`*^9}, {3.769136937617241*^9, 3.769136941341298*^9}, {
   3.7692219887275896`*^9, 3.7692219904131145`*^9}, {3.769226248769722*^9, 
   3.769226249073911*^9}, {3.769228101270114*^9, 3.7692281096685047`*^9}, {
   3.7692298255531473`*^9, 3.7692298278938856`*^9}, {3.769230939113803*^9, 
   3.769230939997447*^9}, 3.7692358310107045`*^9, {3.7692428094572515`*^9, 
   3.769242809520052*^9}, 3.7692483672085886`*^9, {3.7692484506898394`*^9, 
   3.769248463296644*^9}, {3.769248950324164*^9, 3.769248961523179*^9}, {
   3.769251480357107*^9, 3.769251480800929*^9}, 3.76925294874541*^9, 
   3.7692539485996914`*^9, 3.769254121287918*^9, {3.7692542606685486`*^9, 
   3.7692543016806774`*^9}, {3.772357886343944*^9, 3.772357886662093*^9}, {
   3.7743560495574293`*^9, 3.7743560503413105`*^9}, {3.807702643632616*^9, 
   3.8077026443506966`*^9}, {3.807802647061116*^9, 3.807802690618781*^9}, {
   3.807802789050304*^9, 3.807802790434594*^9}, {3.8078042304295197`*^9, 
   3.80780423257777*^9}, {3.8078719958175964`*^9, 3.8078720131959934`*^9}, {
   3.8078721138010426`*^9, 3.807872114079229*^9}, {3.808158332661435*^9, 
   3.808158338480175*^9}, {3.8081988497261553`*^9, 3.8081988527100515`*^9}, {
   3.80819897338212*^9, 3.8081990018350487`*^9}, {3.8083108283804502`*^9, 
   3.808310866760787*^9}, {3.8083146392786903`*^9, 3.8083146398073454`*^9}, {
   3.808319339982309*^9, 3.80831934150458*^9}, {3.8083948582223616`*^9, 
   3.808394867655267*^9}, {3.8083951573730555`*^9, 3.8083951890038376`*^9}, {
   3.8083952233126383`*^9, 3.8083952286685467`*^9}, {3.8084103041438985`*^9, 
   3.8084103077051954`*^9}, {3.8084233686262074`*^9, 
   3.8084233883071413`*^9}, {3.8084615984124146`*^9, 
   3.8084615989300413`*^9}, {3.808492627127034*^9, 3.808492680465439*^9}, 
   3.808493025495162*^9, 3.8084931701676245`*^9, {3.80849415146312*^9, 
   3.8084941545267725`*^9}, 3.8085844933389735`*^9, {3.808587065796912*^9, 
   3.8085870684518023`*^9}, {3.8085884935819063`*^9, 3.808588493651718*^9}, {
   3.8085885283795013`*^9, 3.8085885299722376`*^9}, {3.8086401677702456`*^9, 
   3.808640170530858*^9}, 3.8086526456212683`*^9, {3.8086536647759285`*^9, 
   3.8086536674167957`*^9}, {3.8086634005037813`*^9, 3.808663412348542*^9}, {
   3.808697055535565*^9, 3.8086970556213355`*^9}, {3.8090691238241353`*^9, 
   3.8090691637836237`*^9}, {3.8090718698562903`*^9, 
   3.8090719109462233`*^9}, {3.8091255339523396`*^9, 
   3.8091255404212747`*^9}, {3.809125607186399*^9, 3.8091256074990244`*^9}, {
   3.809125671076771*^9, 3.80912567145187*^9}, {3.8091259210282555`*^9, 
   3.8091259231686497`*^9}, {3.8091813655035934`*^9, 3.8091813684232883`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"edac2b02-475e-4e60-b366-13d62ed9901a"],

Cell[CellGroupData[{

Cell["Data From Processed Sequences", "Subsection",
 CellChangeTimes->{{3.7520000744520516`*^9, 3.7520000907368383`*^9}, {
  3.7601695348999557`*^9, 3.7601695399544315`*^9}, {3.7602506683880315`*^9, 
  3.7602506728526797`*^9}, {3.7603536186791306`*^9, 3.760353621440745*^9}, {
  3.760353741639697*^9, 3.760353745734726*^9}, {3.7743551208129144`*^9, 
  3.774355137875325*^9}},ExpressionUUID->"017da1e3-7fcb-4307-b933-\
24e60c1d6fe2"],

Cell[BoxData[{
 RowBox[{"importCorrected", ":=", 
  "\"\<C:\\\\Users\\\\trtik-adm\\\\Desktop\\\\Test \
Zone\\\\Output\\\\Corrected Images\\\\\>\""}], "\n", 
 RowBox[{
  RowBox[{
  "importShapes", ":=", 
   "\"\<C:\\\\Users\\\\trtik-adm\\\\Desktop\\\\Test \
Zone\\\\Output\\\\Shapes\\\\\>\""}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"dataFolder", ":=", 
  "\"\<D:\\\\Michael\\\\Science\\\\VTPMML\\\\MHD Project\\\\PSI \
Experiment\\\\Data From Processed Sequences\\\\\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"importData", "=", 
   RowBox[{
   "dataFolder", "<>", "\"\<Field ON\\\\100 sccm Field ON\\\\\>\""}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7177377158430915`*^9, 3.717737755035079*^9}, {
   3.717737785881243*^9, 3.7177378777432365`*^9}, {3.717737915081128*^9, 
   3.7177380504220033`*^9}, {3.7177380880730743`*^9, 3.717738300412363*^9}, {
   3.7177383333519278`*^9, 3.7177383334300537`*^9}, {3.7177383751516523`*^9, 
   3.71773861392185*^9}, {3.7177386519353323`*^9, 3.717739081522292*^9}, {
   3.717743829219696*^9, 3.7177438660163803`*^9}, {3.7177440825436897`*^9, 
   3.7177441583677993`*^9}, {3.7177441965440702`*^9, 
   3.7177441966913266`*^9}, {3.7237333110360184`*^9, 
   3.7237333200208473`*^9}, {3.7264886469717426`*^9, 
   3.7264886600385194`*^9}, {3.7283034273935757`*^9, 
   3.7283034581743827`*^9}, {3.729676337796929*^9, 3.729676341823734*^9}, {
   3.747041048631316*^9, 3.74704104879334*^9}, {3.7513674506230288`*^9, 
   3.7513674979286723`*^9}, {3.7513707604688616`*^9, 3.7513707609725127`*^9}, 
   3.751712760209059*^9, {3.751718054524271*^9, 3.751718059769699*^9}, {
   3.7518135482953935`*^9, 3.7518135725814433`*^9}, {3.7518710407937007`*^9, 
   3.751871052004719*^9}, {3.751871358211807*^9, 3.751871364445162*^9}, {
   3.751879175723353*^9, 3.7518791825590715`*^9}, {3.7519575243057594`*^9, 
   3.751957528260184*^9}, {3.7519581327610455`*^9, 3.7519581412344737`*^9}, {
   3.751958453957793*^9, 3.7519584557566743`*^9}, {3.751968334426799*^9, 
   3.7519683353822217`*^9}, {3.7519700282986717`*^9, 3.75197002848617*^9}, {
   3.7519737833049164`*^9, 3.75197380799761*^9}, {3.7519738973199735`*^9, 
   3.7519738974366484`*^9}, 3.751974453373953*^9, 3.7519744838607883`*^9, {
   3.7519745775281367`*^9, 3.7519745791647434`*^9}, {3.7519863856792855`*^9, 
   3.751986410580202*^9}, {3.751987189723457*^9, 3.7519872067171807`*^9}, {
   3.7519872740525713`*^9, 3.751987274251018*^9}, 3.7519887579797745`*^9, {
   3.7519888044417067`*^9, 3.7519888045384264`*^9}, {3.7519889388743944`*^9, 
   3.751988953257942*^9}, {3.75198898540973*^9, 3.7519889857218943`*^9}, {
   3.7519891583567*^9, 3.751989168418381*^9}, {3.751989242284319*^9, 
   3.7519892558884606`*^9}, {3.7519893723305483`*^9, 3.751989372402337*^9}, {
   3.7519931269744205`*^9, 3.7519931279248924`*^9}, {3.751993166925639*^9, 
   3.7519931670293694`*^9}, 3.75199861425095*^9, {3.7519986697422304`*^9, 
   3.7519986922896194`*^9}, {3.751999213796385*^9, 3.7519992351032796`*^9}, {
   3.7519994435814323`*^9, 3.7519994603814545`*^9}, {3.7519996162634587`*^9, 
   3.7519996233658457`*^9}, {3.7519999333676405`*^9, 
   3.7519999359958153`*^9}, {3.7520002180623083`*^9, 
   3.7520002187803435`*^9}, {3.7520002493768325`*^9, 
   3.7520002505482464`*^9}, {3.752000407725655*^9, 3.752000411067837*^9}, {
   3.7520004699823575`*^9, 3.75200047026727*^9}, {3.7520022702769604`*^9, 
   3.7520022747149506`*^9}, {3.7520046929402857`*^9, 
   3.7520046960967264`*^9}, {3.7520502955602303`*^9, 
   3.7520503446601734`*^9}, {3.7520514690035224`*^9, 
   3.7520514690514917`*^9}, {3.7520515670681887`*^9, 
   3.7520515977009263`*^9}, {3.7520517074841633`*^9, 
   3.7520517090997686`*^9}, {3.7520518266893578`*^9, 
   3.7520518310232763`*^9}, {3.7520519932426023`*^9, 
   3.7520519966515093`*^9}, {3.752211767119261*^9, 3.7522117933048677`*^9}, 
   3.7522118378507395`*^9, {3.7522119014341974`*^9, 3.7522119154280024`*^9}, {
   3.752211947983062*^9, 3.7522119754180403`*^9}, {3.75238986004722*^9, 
   3.7523898600877047`*^9}, 3.759935401921358*^9, {3.7600950420507*^9, 
   3.7600950507155514`*^9}, 3.76009546165426*^9, {3.760097847762862*^9, 
   3.7600978479823008`*^9}, {3.7601571295604706`*^9, 3.760157129648235*^9}, 
   3.7601592766146355`*^9, {3.7601729472799244`*^9, 3.760172947511306*^9}, {
   3.7601732107197742`*^9, 3.760173211161602*^9}, 3.760175621125779*^9, 
   3.7602497894762554`*^9, 3.7602549941536517`*^9, 3.7602587711196823`*^9, {
   3.760269954882045*^9, 3.760269955256042*^9}, {3.7602794081805344`*^9, 
   3.760279410170213*^9}, {3.7602794702182603`*^9, 3.7602794767148857`*^9}, {
   3.7603410399150243`*^9, 3.760341041124792*^9}, {3.7604556788470125`*^9, 
   3.760455727922307*^9}, {3.7607682966617975`*^9, 3.760768308975419*^9}, 
   3.7607854536095047`*^9, {3.7608865838057194`*^9, 3.760886593361717*^9}, {
   3.7608866844010015`*^9, 3.7608866845675573`*^9}, {3.760887388038473*^9, 
   3.7608873882957788`*^9}, {3.760892595971661*^9, 3.7608926320929804`*^9}, {
   3.760929281108795*^9, 3.7609292932042255`*^9}, {3.7609293967314425`*^9, 
   3.7609294116522813`*^9}, {3.7609299152508698`*^9, 
   3.7609299156738005`*^9}, {3.760929954547063*^9, 3.7609300117870555`*^9}, {
   3.7609305684759817`*^9, 3.7609305685647535`*^9}, {3.7609314858821344`*^9, 
   3.7609314866510773`*^9}, {3.76093194642652*^9, 3.7609320560911016`*^9}, {
   3.7609321259960537`*^9, 3.760932174706381*^9}, {3.760932243970749*^9, 
   3.7609322520343113`*^9}, {3.7609322828032403`*^9, 
   3.7609322830575356`*^9}, {3.7609323214867444`*^9, 3.760932328043228*^9}, {
   3.7609324262318645`*^9, 3.760932446891398*^9}, {3.7609325111705904`*^9, 
   3.7609325119006367`*^9}, {3.760932875991317*^9, 3.760932877280859*^9}, 
   3.7609344640420094`*^9, {3.7609346032407713`*^9, 3.7609346068281736`*^9}, 
   3.7609433236004734`*^9, {3.760956474733452*^9, 3.760956588831177*^9}, {
   3.760957423846837*^9, 3.760957424285645*^9}, {3.7609580829565725`*^9, 
   3.760958083252755*^9}, {3.7609624911993523`*^9, 3.760962491368901*^9}, 
   3.760964457907423*^9, {3.7609646733113832`*^9, 3.7609646739666595`*^9}, {
   3.7612251729077897`*^9, 3.761225175298395*^9}, 3.761228707061983*^9, {
   3.761228758894994*^9, 3.7612287693206973`*^9}, 3.76122887626292*^9, {
   3.761241692049399*^9, 3.761241700577155*^9}, {3.761276326824277*^9, 
   3.7612763974426746`*^9}, {3.761276432872349*^9, 3.7612764775169487`*^9}, {
   3.7612946605842495`*^9, 3.761294670639862*^9}, {3.761299408431904*^9, 
   3.761299408500719*^9}, {3.7612996367268124`*^9, 3.7612996374924726`*^9}, {
   3.761300049404646*^9, 3.7613000513349247`*^9}, 3.7613041176850076`*^9, {
   3.7613180259074817`*^9, 3.7613180299262967`*^9}, {3.761326801495341*^9, 
   3.761326801590087*^9}, {3.761361249393982*^9, 3.7613612743078856`*^9}, 
   3.761361637701935*^9, 3.7613688777915*^9, {3.7613702345313025`*^9, 
   3.761370234824539*^9}, 3.7613711538469987`*^9, {3.7613717056648607`*^9, 
   3.761371739016631*^9}, {3.7613737377183404`*^9, 3.761373764221431*^9}, {
   3.7613739329982166`*^9, 3.7613739347046556`*^9}, {3.76138015596413*^9, 
   3.7613801562354217`*^9}, 3.7613846372534046`*^9, 3.7613861252512884`*^9, {
   3.761386510741501*^9, 3.761386512992342*^9}, {3.76138735930517*^9, 
   3.7613873604308023`*^9}, 3.7613919238287992`*^9, {3.7613966008619995`*^9, 
   3.761396602922511*^9}, {3.761636027755991*^9, 3.7616360430679235`*^9}, {
   3.766942172979191*^9, 3.766942185577417*^9}, 3.76694229048433*^9, {
   3.76698598843591*^9, 3.766985991303247*^9}, 3.7669860317540455`*^9, {
   3.7669913037058306`*^9, 3.7669913039282355`*^9}, 3.7670126231138024`*^9, 
   3.767012709196599*^9, {3.7670139258103695`*^9, 3.767013947480813*^9}, {
   3.767021749847092*^9, 3.7670217534872546`*^9}, {3.768653732446519*^9, 
   3.768653732775638*^9}, 3.768653806757841*^9, 3.768654833538556*^9, {
   3.7690915969429607`*^9, 3.769091604654603*^9}, 3.7690926375926604`*^9, {
   3.769092687161451*^9, 3.7690926909751077`*^9}, {3.7691367179698753`*^9, 
   3.7691367268764544`*^9}, {3.769136937617241*^9, 3.769136941341298*^9}, {
   3.7692219887275896`*^9, 3.7692219904131145`*^9}, {3.769226248769722*^9, 
   3.769226249073911*^9}, {3.769228101270114*^9, 3.7692281096685047`*^9}, {
   3.7692298255531473`*^9, 3.7692298278938856`*^9}, {3.769230939113803*^9, 
   3.769230939997447*^9}, 3.7692358310107045`*^9, {3.7692428094572515`*^9, 
   3.769242809520052*^9}, 3.7692483672085886`*^9, {3.7692484506898394`*^9, 
   3.769248463296644*^9}, {3.769248950324164*^9, 3.769248961523179*^9}, {
   3.769251480357107*^9, 3.769251480800929*^9}, 3.76925294874541*^9, 
   3.7692539485996914`*^9, 3.769254121287918*^9, {3.7692542606685486`*^9, 
   3.769254304182972*^9}, 3.769254561146017*^9, {3.7692550688252745`*^9, 
   3.7692550688951178`*^9}, 3.7692556720371647`*^9, 3.7692563123658314`*^9, {
   3.7692568578690987`*^9, 3.76925685805161*^9}, {3.7692608638082695`*^9, 
   3.769260867592142*^9}, {3.7692614734910927`*^9, 3.769261473550933*^9}, {
   3.769262033221088*^9, 3.7692620333088474`*^9}, 3.773314928546344*^9, 
   3.773314963474622*^9, 3.773315068202137*^9, 3.7733235447192135`*^9, 
   3.7733250823672314`*^9, 3.7733260117414703`*^9, {3.7733274501609077`*^9, 
   3.7733274502464867`*^9}, 3.773328786749815*^9, 3.7733299870126977`*^9, 
   3.773331923334993*^9, {3.7733332642759495`*^9, 3.7733332690996475`*^9}, {
   3.773334201482791*^9, 3.773334202867092*^9}, {3.773335168738841*^9, 
   3.7733351688714886`*^9}, 3.7733399340579033`*^9, {3.7733891065475345`*^9, 
   3.7733891360127134`*^9}, 3.7733912800187206`*^9, 3.773393217642024*^9, 
   3.7733950115768895`*^9, {3.77339616715102*^9, 3.7733961672627225`*^9}, 
   3.77339724651875*^9, 3.7733989388778105`*^9, 3.7733995996863127`*^9, {
   3.773400363301696*^9, 3.773400374211552*^9}, {3.773400834511348*^9, 
   3.7734008432520957`*^9}, 3.7743550289923368`*^9, {3.7819642974953613`*^9, 
   3.7819643015196095`*^9}, 3.781964396630724*^9, {3.782136624626034*^9, 
   3.7821366847691636`*^9}, {3.782137358417632*^9, 3.782137358674957*^9}, 
   3.8061715061814065`*^9, 3.806970140632617*^9, {3.8070099828260784`*^9, 
   3.807009983790612*^9}, {3.8076146522346926`*^9, 3.8076146523932004`*^9}, 
   3.8076146877877426`*^9, {3.807614945063823*^9, 3.807614945132634*^9}, {
   3.807700968752561*^9, 3.8077009962368584`*^9}, 3.8077010363618617`*^9, {
   3.8078027166643763`*^9, 3.807802727867118*^9}, {3.8078778547232666`*^9, 
   3.8078778550568843`*^9}, {3.807877965519026*^9, 3.807877975578659*^9}, 
   3.8078862240474215`*^9, {3.8081583147903185`*^9, 3.808158320199028*^9}, {
   3.808199017803692*^9, 3.8081990190072155`*^9}, {3.808395081187389*^9, 
   3.8083950845877295`*^9}, {3.8087255246607227`*^9, 3.808725528836543*^9}, {
   3.8091257045768023`*^9, 3.8091257119045706`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"47925b52-880c-4534-8e82-9c8c13d9193b"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Image Sequence Import", "Section",
 CellChangeTimes->{{3.751808845615265*^9, 3.75180886393727*^9}, {
  3.7620667007477703`*^9, 3.76206671783607*^9}, {3.7669426529453535`*^9, 
  3.766942654064663*^9}},ExpressionUUID->"35abad1e-7e64-4b42-bdf8-\
50951d2c24e3"],

Cell[CellGroupData[{

Cell["[UNTESTED] A Monitoring Module For ParallelMap", "Subsection",
 CellChangeTimes->{{3.7781579110073633`*^9, 3.7781579274404755`*^9}, {
  3.808055113159553*^9, 3.808055134742937*^9}, {3.809183168893592*^9, 
  3.809183178325199*^9}},
 FontSize->24,ExpressionUUID->"eac7f8cb-4351-460b-bda7-41520db751b0"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "monitorParallelMap", "]"}], ";", 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"monitorParallelMap", "[", "\[IndentingNewLine]", 
     RowBox[{"foo_", ",", "expr_", ",", 
      RowBox[{"levelSpec_", ":", 
       RowBox[{"{", "1", "}"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "ParallelMap", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "exprCount", ",", 
         RowBox[{"progress", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"launchNukes", "@", "useKernels"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"SetSharedVariable", "@", "progress"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"exprCount", "=", 
         RowBox[{"Length", "@", 
          RowBox[{"Level", "[", 
           RowBox[{"expr", ",", "levelSpec"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"Monitor", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Pause", "[", ".25", "]"}], ";", 
                RowBox[{"progress", "++"}], ";", 
                RowBox[{"foo", "@", "#"}]}], ")"}], "&"}], ",", 
             "\[IndentingNewLine]", "expr", ",", "levelSpec", ",", "opts"}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Column", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"\"\<Processing ...\>\"", ",", "\[IndentingNewLine]", 
               RowBox[{"ProgressIndicator", "[", 
                RowBox[{"progress", ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "exprCount"}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ToString", "@", "progress"}], "<>", "\"\</\>\"", "<>", 
                RowBox[{"ToString", "@", "exprCount"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ToString", "@", 
                 RowBox[{"Round", "[", 
                  RowBox[{
                   RowBox[{"100", "*", 
                    RowBox[{"progress", "/", "exprCount"}]}], "//", "N"}], 
                  "]"}]}], "<>", "\"\< %\>\""}]}], "\[IndentingNewLine]", 
              "}"}], ",", 
             RowBox[{"Alignment", "\[Rule]", "Left"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"UnsetShared", "@", "progress"}], ";", "\[IndentingNewLine]", 
        "res"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"monitorParallelMap", "[", 
      RowBox[{"f", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"Range", "[", "10", "]"}], "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.808041001846167*^9, 3.8080410106526003`*^9}, {
  3.8080417898913727`*^9, 3.80804179003791*^9}, {3.8080418263348074`*^9, 
  3.808041945139677*^9}, {3.808041998941593*^9, 3.8080420003161087`*^9}, {
  3.8080420867248325`*^9, 3.8080421836258316`*^9}, {3.8080423532339964`*^9, 
  3.8080423672947726`*^9}, {3.8080550758717127`*^9, 
  3.808055102416027*^9}},ExpressionUUID->"ae3c69d3-3b63-4707-8988-\
3bf867d4b302"]
}, Closed]],

Cell[CellGroupData[{

Cell["Import Images", "Subsection",
 CellChangeTimes->{{3.7781579110073633`*^9, 
  3.7781579274404755`*^9}},ExpressionUUID->"5551d25d-20c7-431b-8299-\
80566cdd9a9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"launchNukes", "@", "useKernels"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"images", "=", 
    RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Import", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"subFolder", "<>", "#"}], ",", "\[IndentingNewLine]", 
         RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
        "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"files", "[", 
       RowBox[{"[", 
        RowBox[{"lowerLimit", ";;", "upperLimit"}], "]"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Speak", "@", "\"\<Image import complete\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"widthPixels", "=", 
   RowBox[{"First", "@", 
    RowBox[{"ImageDimensions", "@", 
     RowBox[{"First", "@", "images"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"unitConversion", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"widthPixels", "/", "defaultWidthPixels"}], ")"}], "*", 
     RowBox[{"fieldOfView", "/", "widthPixels"}]}], "//", "N"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7177377158430915`*^9, 3.717737755035079*^9}, {
   3.717737785881243*^9, 3.7177378777432365`*^9}, {3.717737915081128*^9, 
   3.7177380504220033`*^9}, {3.7177380880730743`*^9, 3.717738300412363*^9}, {
   3.7177383333519278`*^9, 3.7177383334300537`*^9}, {3.7177383751516523`*^9, 
   3.71773861392185*^9}, {3.7177386519353323`*^9, 3.717739081522292*^9}, {
   3.717743829219696*^9, 3.7177438660163803`*^9}, {3.7177440825436897`*^9, 
   3.7177441583677993`*^9}, {3.7177441965440702`*^9, 
   3.7177441966913266`*^9}, {3.7237333110360184`*^9, 
   3.7237333200208473`*^9}, {3.7264886469717426`*^9, 
   3.7264886600385194`*^9}, {3.7283034273935757`*^9, 
   3.7283034581743827`*^9}, {3.729676337796929*^9, 3.729676341823734*^9}, {
   3.747041048631316*^9, 3.74704104879334*^9}, {3.7513674506230288`*^9, 
   3.751367533932418*^9}, 3.7513678787540135`*^9, {3.751368682841755*^9, 
   3.751368710653499*^9}, {3.7513689560071154`*^9, 3.751368969333048*^9}, {
   3.7513702998183403`*^9, 3.7513703169215965`*^9}, {3.751370787710986*^9, 
   3.7513707969726477`*^9}, {3.751694728455764*^9, 3.7516947508282638`*^9}, {
   3.7516956463966684`*^9, 3.751695664837387*^9}, {3.7517117899960823`*^9, 
   3.751711790208119*^9}, {3.751715307345482*^9, 3.7517153142250805`*^9}, {
   3.751717768351387*^9, 3.7517178095255127`*^9}, {3.7517178904197807`*^9, 
   3.751717892263572*^9}, {3.751718021858073*^9, 3.7517180449997435`*^9}, 
   3.7517958177090473`*^9, {3.7517962384460444`*^9, 3.751796247771106*^9}, {
   3.751798356897586*^9, 3.751798359319228*^9}, {3.7518003178915434`*^9, 
   3.751800322200385*^9}, {3.7518054063190494`*^9, 3.751805413644461*^9}, {
   3.7518090738015766`*^9, 3.7518090780190587`*^9}, {3.751809128739005*^9, 
   3.7518091377363367`*^9}, {3.751809633506062*^9, 3.7518097128353043`*^9}, {
   3.751809747610074*^9, 3.751809763471615*^9}, {3.7518098013434286`*^9, 
   3.7518098312315564`*^9}, 3.75181018092091*^9, {3.751810440182747*^9, 
   3.7518104638003564`*^9}, {3.7518104975231147`*^9, 
   3.7518105003860273`*^9}, {3.7518706948423195`*^9, 
   3.7518706950687003`*^9}, {3.7518710217670946`*^9, 
   3.7518710268604765`*^9}, {3.751879180640204*^9, 3.751879198671009*^9}, {
   3.751954609915016*^9, 3.7519546122218122`*^9}, {3.7519574350255146`*^9, 
   3.7519574378918285`*^9}, {3.751957531661088*^9, 3.75195753194832*^9}, 
   3.7519739381155186`*^9, {3.751974564149325*^9, 3.7519745737382736`*^9}, {
   3.7519746061642714`*^9, 3.7519746074588327`*^9}, {3.7519863533188334`*^9, 
   3.7519863536130424`*^9}, {3.751986413477455*^9, 3.7519864235716724`*^9}, {
   3.7519870974555826`*^9, 3.7519871318905077`*^9}, {3.7520039790994835`*^9, 
   3.75200399610083*^9}, 3.752050298923599*^9, {3.7520514591520195`*^9, 
   3.752051513645871*^9}, {3.7520515810146384`*^9, 3.7520516070481863`*^9}, {
   3.7520517026397276`*^9, 3.7520517030814557`*^9}, {3.752051745263569*^9, 
   3.7520517836363487`*^9}, 3.752071268552267*^9, 3.7522119243556566`*^9, {
   3.760172950640916*^9, 3.760172954195407*^9}, {3.7601730596555715`*^9, 
   3.7601730603896136`*^9}, {3.760173095951811*^9, 3.7601731098661714`*^9}, {
   3.7601732070097156`*^9, 3.760173207577176*^9}, {3.7608967010022516`*^9, 
   3.760896713375206*^9}, {3.760929196843571*^9, 3.760929229387312*^9}, 
   3.7609305771199694`*^9, {3.76093208087411*^9, 3.760932116185805*^9}, {
   3.76093218508365*^9, 3.7609322280421505`*^9}, {3.760932258883037*^9, 
   3.7609322613026257`*^9}, {3.7609324644993386`*^9, 3.760932476353635*^9}, 
   3.760948494764584*^9, {3.760954822229915*^9, 3.760954828183131*^9}, {
   3.760957174116322*^9, 3.7609571745322294`*^9}, {3.760957895235751*^9, 
   3.760957921379594*^9}, {3.7609651595617104`*^9, 3.7609651654958453`*^9}, 
   3.766942329181452*^9, {3.7669913588611794`*^9, 3.766991372423643*^9}, {
   3.766991452706896*^9, 3.7669914596365013`*^9}, {3.7733251351813517`*^9, 
   3.7733251395267253`*^9}, {3.773325185989688*^9, 3.773325186386649*^9}, {
   3.7733257324780903`*^9, 3.7733257327822776`*^9}, {3.774353549740924*^9, 
   3.7743535683312254`*^9}, {3.774356924700407*^9, 3.77435692509933*^9}, 
   3.781942547787493*^9, {3.781964424005331*^9, 3.781964436813111*^9}, 
   3.7819645936458735`*^9, 3.781964626501112*^9, {3.781965173948187*^9, 
   3.7819651765249186`*^9}, {3.7819653615969667`*^9, 3.781965392188747*^9}, {
   3.8019348250993767`*^9, 3.8019348480521955`*^9}, {3.8060005877783375`*^9, 
   3.8060005921221704`*^9}, {3.8077026810235076`*^9, 
   3.8077026932721896`*^9}, {3.807704889142043*^9, 3.807704892267189*^9}, 
   3.8077049722117996`*^9, {3.807705005072728*^9, 3.8077050146023197`*^9}, {
   3.8078720728441277`*^9, 3.807872072977702*^9}, {3.8459054575399604`*^9, 
   3.8459054686992903`*^9}},ExpressionUUID->"d4381aa1-91bc-498f-ae1f-\
ae9879b13ef8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ View The Image Sequence ]]", "Subsection",
 CellChangeTimes->{{3.7520000744520516`*^9, 3.7520000907368383`*^9}, {
  3.7601695348999557`*^9, 3.7601695399544315`*^9}, {3.7602506683880315`*^9, 
  3.7602506728526797`*^9}, {3.7603536186791306`*^9, 3.760353621440745*^9}, {
  3.760353741639697*^9, 
  3.760353745734726*^9}},ExpressionUUID->"25fd5b27-2d4e-4bea-8607-\
f6b7b1b934ab"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Image", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Colorize", "@", 
      RowBox[{"images", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\[IndentingNewLine]", 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", "selectedImages", ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.752051628073289*^9, 3.7520516683084273`*^9}, {
   3.752052107223207*^9, 3.7520521075779905`*^9}, {3.752211931433508*^9, 
   3.752211931624024*^9}, {3.7522119728671727`*^9, 3.7522119730357203`*^9}, {
   3.7600950555414543`*^9, 3.760095055715*^9}, {3.7601022898168464`*^9, 
   3.7601022898976574`*^9}, {3.7601691716785593`*^9, 
   3.7601691717892437`*^9}, {3.760169529419608*^9, 3.760169529514329*^9}, {
   3.7601756292171326`*^9, 3.7601756293418007`*^9}, {3.7601849737228966`*^9, 
   3.760184973930319*^9}, {3.760185141401884*^9, 3.7601851496269093`*^9}, {
   3.760208449086478*^9, 3.7602084492637234`*^9}, {3.760269991014202*^9, 
   3.7602700104487963`*^9}, {3.7603285080640154`*^9, 3.760328520373093*^9}, {
   3.7603345136322155`*^9, 3.760334513697034*^9}, {3.760676437070323*^9, 
   3.760676446020754*^9}, {3.7608866790157037`*^9, 3.7608866792540903`*^9}, {
   3.760896565491361*^9, 3.7608965809029293`*^9}, 3.7609300205634704`*^9, {
   3.7609650062622337`*^9, 3.760965006375925*^9}, {3.76128745138564*^9, 
   3.761287457267913*^9}, {3.7612947810342197`*^9, 3.7612947811110115`*^9}, {
   3.766942339093336*^9, 3.7669423504773107`*^9}, {3.7692486521726995`*^9, 
   3.7692486533056693`*^9}, {3.769248989786003*^9, 3.7692489900572395`*^9}, 
   3.781965393119829*^9, 3.7819654434026275`*^9, {3.8067386731345043`*^9, 
   3.8067386820856967`*^9}, {3.8067470338007236`*^9, 3.806747035097294*^9}, {
   3.8067478057302523`*^9, 3.806747808260709*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"73c4344f-b100-4e22-bd4f-f410eaa567bf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Image Filtering & Edge Detection", "Section",
 CellChangeTimes->{{3.7601693862689934`*^9, 3.760169427604337*^9}, {
  3.7602507522263055`*^9, 3.760250764234357*^9}, {3.760676200148013*^9, 
  3.760676213509284*^9}, {3.76069462662806*^9, 3.7606946282048607`*^9}, {
  3.8077010877057886`*^9, 3.807701102564895*^9}, {3.807701274986268*^9, 
  3.8077012836736994`*^9}},ExpressionUUID->"73171e84-ff78-4f70-8ad6-\
58ce60256525"],

Cell[CellGroupData[{

Cell["Noise Filter", "Subsection",
 CellChangeTimes->{{3.7520000744520516`*^9, 3.7520000907368383`*^9}, {
  3.7601695348999557`*^9, 3.7601695399544315`*^9}, {3.7602506683880315`*^9, 
  3.7602506728526797`*^9}, {3.7603536186791306`*^9, 3.760353621440745*^9}, {
  3.760353741639697*^9, 3.760353745734726*^9}, {3.8077932510878696`*^9, 
  3.8077932536151047`*^9}},ExpressionUUID->"c9bcd0c6-5d88-4c60-b234-\
c425b1f6174a"],

Cell["\<\
Defaults :

stepsPerona=5;
conductancePerona=Automatic;
gradientDeviationPerona=1;
variationWeight=0.8;
variationIterations=100;
stepsCurvature=7;
conductanceCurvature:=\[Infinity]
luminanceCompression=0.5;\
\>", "Abstract",
 CellChangeTimes->{{3.8084619043443875`*^9, 3.808461913812336*^9}, {
   3.80846225469326*^9, 3.8084622610324526`*^9}, 
   3.8084686603039556`*^9},ExpressionUUID->"e42d8b65-6fa7-4c27-8d7b-\
edffa91acb40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stepsPerona", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conductancePerona", "=", "Automatic"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradientDeviationPerona", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"variationWeight", "=", "0.8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"variationIterations", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stepsCurvature", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"conductanceCurvature", ":=", "\[Infinity]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"luminanceCompression", "=", "0.5"}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"smallScaleFilter", "[", "imageID_", "]"}], ":=", 
   RowBox[{
    RowBox[{"PeronaMalikFilter", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"images", "[", 
       RowBox[{"[", "imageID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      "stepsPerona", ",", "conductancePerona", ",", 
      "gradientDeviationPerona"}], "\[IndentingNewLine]", "]"}], "//", 
    "ImageAdjust"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"midScaleFilter", "[", "imageID_", "]"}], ":=", 
   RowBox[{
    RowBox[{"TotalVariationFilter", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"smallScaleFilter", "@", "imageID"}], ",", 
      "\[IndentingNewLine]", "variationWeight", ",", 
      RowBox[{"Method", "\[Rule]", "\"\<Poisson\>\""}], ",", 
      RowBox[{"MaxIterations", "\[Rule]", "variationIterations"}]}], 
     "\[IndentingNewLine]", "]"}], "//", "ImageAdjust"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"largeScaleFilter", "[", "imageID_", "]"}], ":=", 
   RowBox[{"CurvatureFlowFilter", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"midScaleFilter", "@", "imageID"}], ",", "\[IndentingNewLine]", 
     "stepsCurvature", ",", "conductanceCurvature"}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"correctedImage", "[", "imageID_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
      RowBox[{"#", ",", "\[IndentingNewLine]", 
       RowBox[{"#", "-", 
        RowBox[{"ColorNegate", "@", 
         RowBox[{"ColorToneMapping", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", "luminanceCompression", ",", 
           RowBox[{"Method", "\[Rule]", "\"\<Luminance\>\""}]}], 
          "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
     "&"}], "@", 
    RowBox[{
     RowBox[{"memoizationSync", "[", "largeScaleFilter", "]"}], "[", 
     "imageID", "]"}]}], "//", "ImageAdjust"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.801902510617508*^9, 3.801902697663455*^9}, {
   3.80190279521441*^9, 3.8019027986304693`*^9}, {3.8019028383361607`*^9, 
   3.801902937760687*^9}, {3.801903003582923*^9, 3.8019030169734106`*^9}, {
   3.8019032251969624`*^9, 3.8019032419376183`*^9}, {3.8019044795255756`*^9, 
   3.8019045248909163`*^9}, {3.801904806264716*^9, 3.8019048159337416`*^9}, {
   3.8019122295848284`*^9, 3.801912242811656*^9}, {3.801912390030693*^9, 
   3.8019124116423388`*^9}, {3.801912444794856*^9, 3.8019124448608146`*^9}, {
   3.801912505048626*^9, 3.8019125370968256`*^9}, 3.8019266052219477`*^9, {
   3.8019268059310045`*^9, 3.8019268259447365`*^9}, {3.801930830516444*^9, 
   3.8019308305694127`*^9}, 3.801931133994851*^9, {3.80193156437278*^9, 
   3.8019316067715826`*^9}, {3.8019321047525067`*^9, 
   3.8019321364495597`*^9}, {3.801932168527079*^9, 3.8019321796228886`*^9}, {
   3.8019338821087055`*^9, 3.8019339409639*^9}, 3.8019345008068113`*^9, {
   3.8019347159920936`*^9, 3.80193471726031*^9}, {3.801935320819688*^9, 
   3.801935344419428*^9}, {3.8019359439390125`*^9, 3.8019359665630484`*^9}, 
   3.8019363831908674`*^9, {3.8019365723091087`*^9, 3.8019365772200747`*^9}, {
   3.801936614308693*^9, 3.801936638297857*^9}, {3.8019978764504213`*^9, 
   3.8019978983588843`*^9}, {3.801998159848137*^9, 3.8019981611503325`*^9}, {
   3.802001038355687*^9, 3.8020010683081884`*^9}, {3.802001136837597*^9, 
   3.802001260375929*^9}, {3.8020084419905124`*^9, 3.8020084422033796`*^9}, 
   3.802008482944617*^9, {3.8020784076896143`*^9, 3.80207840822928*^9}, {
   3.8067535449483824`*^9, 3.806753566531569*^9}, 3.8067536042060814`*^9, {
   3.806753641314763*^9, 3.8067536557939777`*^9}, {3.8067724044724784`*^9, 
   3.8067724499089484`*^9}, {3.806772486126459*^9, 3.8067725550844545`*^9}, {
   3.806774253567011*^9, 3.8067742782240534`*^9}, {3.8067743559593253`*^9, 
   3.8067744305553913`*^9}, {3.806774596294463*^9, 3.806774607219626*^9}, {
   3.8067817200829887`*^9, 3.80678177784382*^9}, {3.807008813941397*^9, 
   3.8070088278339944`*^9}, 3.807287273190432*^9, {3.8072873054489193`*^9, 
   3.807287305756097*^9}, 3.8072909202943287`*^9, {3.807794652862811*^9, 
   3.8077946533570013`*^9}, {3.8077946950720215`*^9, 
   3.8077946982615795`*^9}, {3.807795433696824*^9, 3.8077954370421176`*^9}, {
   3.8078031899316263`*^9, 3.8078031918808837`*^9}, {3.807803243963147*^9, 
   3.8078032440489902`*^9}, {3.8078036778483067`*^9, 
   3.8078036884489517`*^9}, {3.8078044899722266`*^9, 
   3.8078045059784384`*^9}, {3.807853659233405*^9, 3.8078536592792835`*^9}, {
   3.8078683873193626`*^9, 3.8078684424136963`*^9}, {3.807868486206795*^9, 
   3.807868551350561*^9}, {3.8078685986784353`*^9, 3.8078686120343995`*^9}, {
   3.8078686501049585`*^9, 3.8078687925324745`*^9}, {3.80786886442444*^9, 
   3.8078688670843844`*^9}, {3.807869346903177*^9, 3.807869346987948*^9}, {
   3.807872157132963*^9, 3.807872169640955*^9}, {3.8078722068044252`*^9, 
   3.807872215394166*^9}, {3.8078848302405787`*^9, 3.8078848493481665`*^9}, {
   3.8078861790301313`*^9, 3.8078861791418295`*^9}, {3.807887643715031*^9, 
   3.80788764692027*^9}, {3.8088200597654905`*^9, 3.808820100466028*^9}},
 CellLabel->
  "In[349]:=",ExpressionUUID->"06671b36-aca7-4947-911e-c04466145ab8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Edge Filter", "Subsection",
 CellChangeTimes->{{3.7520000744520516`*^9, 3.7520000907368383`*^9}, {
  3.7601695348999557`*^9, 3.7601695399544315`*^9}, {3.7602506683880315`*^9, 
  3.7602506728526797`*^9}, {3.7603536186791306`*^9, 3.760353621440745*^9}, {
  3.760353741639697*^9, 3.760353745734726*^9}, {3.8077932510878696`*^9, 
  3.8077932650161157`*^9}, {3.80786976455254*^9, 3.80786976576908*^9}, {
  3.807871648618176*^9, 
  3.807871648913387*^9}},ExpressionUUID->"67689526-4625-490a-a673-\
d716c66eed63"],

Cell["\<\
Defaults :

gradientScale = 55;
haloThreshold = 0.3;
erosionFactor = 5;
cutoffScale = 5;\
\>", "Abstract",
 CellChangeTimes->{{3.8084619043443875`*^9, 3.808461913812336*^9}, {
  3.80846225469326*^9, 
  3.8084622610324526`*^9}},ExpressionUUID->"b6e66938-af96-4838-b3ae-\
71ea1601ab69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gradientScale", "=", "37.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"haloThreshold", "=", "0.35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"erosionFactor", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cutoffScale", "=", "5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adjustGradient", "[", "imageID_", "]"}], ":=", 
   RowBox[{"ImageAdjust", "@", 
    RowBox[{"GradientFilter", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"memoizationSync", "[", "correctedImage", "]"}], "[", 
       "imageID", "]"}], ",", "\[IndentingNewLine]", "gradientScale", ",", 
      RowBox[{"Method", "\[Rule]", " ", "\"\<Gaussian\>\""}]}], 
     "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getBinaryHalos", "[", "image_", "]"}], ":=", 
   RowBox[{"MorphologicalBinarize", "[", 
    RowBox[{"image", ",", "haloThreshold"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"edgeEstimate", "[", "image_", "]"}], ":=", 
   RowBox[{"Thinning", "@", 
    RowBox[{"Erosion", "[", "\[IndentingNewLine]", 
     RowBox[{"image", ",", 
      RowBox[{"DiskMatrix", "@", "erosionFactor"}]}], "\[IndentingNewLine]", 
     "]"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cleanEdges", "[", "image_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Binarize", "@", 
     RowBox[{"MeanFilter", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FillingTransform", "@", "image"}], ",", "cutoffScale"}], 
      "\[IndentingNewLine]", "]"}]}], "//", "DeleteBorderComponents"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeHaloFilter", "[", "imageID_", "]"}], ":=", 
  RowBox[{"cleanEdges", "@", 
   RowBox[{"edgeEstimate", "@", 
    RowBox[{"getBinaryHalos", "@", 
     RowBox[{"adjustGradient", "@", "imageID"}]}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.807871321694466*^9, 3.807871395946723*^9}, {
   3.807871555731164*^9, 3.8078716229326344`*^9}, {3.8078716644837413`*^9, 
   3.807871688019881*^9}, {3.8078717512376304`*^9, 3.8078717647390947`*^9}, {
   3.8078871205190787`*^9, 3.8078871364763565`*^9}, {3.80788769928235*^9, 
   3.807887700472081*^9}, 3.8078888572392855`*^9, {3.8080402418160176`*^9, 
   3.808040243150943*^9}, {3.808493457640046*^9, 3.808493458117833*^9}, {
   3.808493663454938*^9, 3.8084936636682434`*^9}, {3.8084937291244173`*^9, 
   3.8084937294684963`*^9}, {3.8084938075099707`*^9, 
   3.8084938075807805`*^9}, {3.8084939180693054`*^9, 
   3.8084939204602184`*^9}, {3.8086537681358366`*^9, 3.808653768261433*^9}, {
   3.8086635676634445`*^9, 3.808663575597158*^9}, {3.80866361614291*^9, 
   3.8086636162047443`*^9}, 3.80866388229183*^9, {3.8086639513553457`*^9, 
   3.808663969192946*^9}, {3.8086640824025774`*^9, 3.8086640928555593`*^9}, 
   3.8086971475247903`*^9, {3.8086972166681833`*^9, 3.8086972398654833`*^9}, {
   3.8086972820755405`*^9, 3.8086972823767333`*^9}, {3.80909070620969*^9, 
   3.809090710045879*^9}, {3.809125777919656*^9, 3.8091257826227317`*^9}, {
   3.8091262274169073`*^9, 3.8091262574327083`*^9}, {3.8091263066821756`*^9, 
   3.8091263385416083`*^9}, {3.8091263747601995`*^9, 3.809126412759613*^9}, {
   3.8091264435565596`*^9, 3.8091264532908983`*^9}, {3.8091604128187222`*^9, 
   3.809160415818844*^9}, {3.8091605754277315`*^9, 3.809160580005624*^9}, {
   3.8091606196777573`*^9, 3.809160661989933*^9}, {3.8091607188804655`*^9, 
   3.8091607347399073`*^9}, {3.80916077028657*^9, 3.8091608262864585`*^9}, {
   3.80916135989452*^9, 3.80916150434727*^9}, {3.80916154740951*^9, 
   3.8091616247372985`*^9}, {3.809162000174016*^9, 3.80916200040845*^9}, {
   3.809162056721018*^9, 3.8091620569711804`*^9}, {3.809183390689931*^9, 
   3.809183434080804*^9}, 3.809183575446165*^9, {3.8091836956054277`*^9, 
   3.8091836971410956`*^9}, {3.8091838322510557`*^9, 3.809183908052532*^9}, {
   3.8091840030353675`*^9, 3.8091840125794897`*^9}},
 CellLabel->
  "In[340]:=",ExpressionUUID->"b3657ebc-015d-4dae-ab75-a0feff1304db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testID", "=", "28"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HighlightImage", "[", 
      RowBox[{
       RowBox[{"images", "[", 
        RowBox[{"[", "testID", "]"}], "]"}], ",", 
       RowBox[{"Binarize", "[", 
        RowBox[{
         RowBox[{"images", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"images", "[", 
         RowBox[{"[", "testID", "]"}], "]"}], "//", "Colorize"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"edgeHaloFilter", "@", "testID"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"Dividers", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8091611867072372`*^9, 3.8091612167855873`*^9}, {
  3.809161300535351*^9, 3.8091613518787775`*^9}, {3.8091615140035934`*^9, 
  3.8091615406752534`*^9}, {3.809161586190628*^9, 3.809161586284272*^9}, {
  3.8091616342844105`*^9, 3.809161662940612*^9}, {3.8091617168466134`*^9, 
  3.8091618351119967`*^9}, {3.8091618668151073`*^9, 3.809161913783966*^9}, {
  3.8091619488151364`*^9, 3.809162077861431*^9}, {3.80918332117723*^9, 
  3.8091833375497055`*^9}, {3.8091833735907354`*^9, 3.809183373837085*^9}, {
  3.809183436748768*^9, 3.8091834380898633`*^9}, {3.8091836010749474`*^9, 
  3.8091838860272923`*^9}, {3.8091839264982977`*^9, 3.8091839471730843`*^9}, {
  3.809183986762537*^9, 3.809183988066122*^9}, {3.8091840186893744`*^9, 
  3.809184042402621*^9}, {3.8091841306911106`*^9, 3.809184154890554*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"ee835835-713c-4ed0-be06-c25acdbdf70b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"images", "[", 
        RowBox[{"[", "testID", "]"}], "]"}], "//", "Colorize"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"correctedImage", "@", "testID"}], "//", "Colorize"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"getBinaryHalos", "@", 
       RowBox[{"adjustGradient", "@", "testID"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"edgeHaloFilter", "@", "testID"}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Dividers", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"images", "[", 
    RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"edgeHaloFilter", "@", "testID"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8086636209919004`*^9, 3.8086636699296083`*^9}, {
   3.8086637313404226`*^9, 3.808663866161578*^9}, {3.8086639032240105`*^9, 
   3.808663922344943*^9}, {3.808663982026517*^9, 3.8086640676222954`*^9}, {
   3.80866411308115*^9, 3.808664114014646*^9}, {3.8086641451022496`*^9, 
   3.808664201462266*^9}, {3.8086642495757847`*^9, 3.80866424966754*^9}, {
   3.808664567630138*^9, 3.8086646168166094`*^9}, {3.8086971909470053`*^9, 
   3.8086972069372864`*^9}, {3.8086972629224014`*^9, 3.808697272936058*^9}, {
   3.808697312626004*^9, 3.808697402918213*^9}, {3.808697529416656*^9, 
   3.80869756419744*^9}, {3.8088114565930753`*^9, 3.808811456942075*^9}, 
   3.8091257632635093`*^9, {3.8091261635425835`*^9, 3.8091262138861732`*^9}, {
   3.8091263620727463`*^9, 3.8091263621663995`*^9}, 3.809126426322193*^9, {
   3.809126471728031*^9, 3.8091264982438345`*^9}, {3.809126630680482*^9, 
   3.8091266311181545`*^9}, {3.8091603993655205`*^9, 3.809160399459509*^9}, {
   3.809160435677904*^9, 3.809160435802831*^9}, 3.8091604971781206`*^9, {
   3.809160752942772*^9, 3.809160753098978*^9}, 3.8091617329091024`*^9, {
   3.8091841589210463`*^9, 3.8091841602264805`*^9}},
 CellLabel->
  "In[373]:=",ExpressionUUID->"aebc364d-d081-4371-ad47-cda9c1c090ca"]
}, Closed]],

Cell[CellGroupData[{

Cell["Process Images", "Subsection",
 CellChangeTimes->{{3.7520000744520516`*^9, 3.7520000907368383`*^9}, {
   3.7601695348999557`*^9, 3.7601695399544315`*^9}, {3.7602506683880315`*^9, 
   3.7602506728526797`*^9}, {3.7603536186791306`*^9, 3.760353621440745*^9}, {
   3.760353741639697*^9, 3.760353745734726*^9}, {3.8077932510878696`*^9, 
   3.8077932536151047`*^9}, {3.8077932854793267`*^9, 3.807793291982922*^9}, 
   3.807794966705544*^9},ExpressionUUID->"7ef77be6-35e1-48ff-8fa7-\
55a51994d53a"],

Cell["Possible Improvements", "Abstract",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
  3.769158606943906*^9, 3.7691586572504983`*^9}, {3.7692223025981207`*^9, 
  3.769222339641034*^9}},ExpressionUUID->"be4aaeef-0081-4d6a-a2c3-\
395d604ef133"],

Cell["\<\
Save the filtering/segmentation/interrogation settings in a .txt file\
\>", "Subitem",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
   3.769158606943906*^9, 3.7691586572504983`*^9}, 3.7692223043414335`*^9, {
   3.769222342585159*^9, 3.769222345000705*^9}, {3.769230882123254*^9, 
   3.769230908195506*^9}, {3.770115650982784*^9, 3.7701156661114388`*^9}, {
   3.804171808390911*^9, 3.804171808392909*^9}, {3.808664716529004*^9, 
   3.808664758072644*^9}},ExpressionUUID->"c2e83949-2696-47a3-9384-\
b835195024bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"launchNukes", "@", "useKernels"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Speak", "@", "\"\<Processing images\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"shapes", "=", 
      RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"edgeHaloFilter", "[", "m", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", "testBatch"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", "testBatch"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Speak", "@", "\"\<Image processing complete\>\""}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"filteredImages", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"memoizationSync", "[", "largeScaleFilter", "]"}], "[", "#", 
      "]"}], "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "shapes"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"correctedImages", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"memoizationSync", "[", "correctedImage", "]"}], "[", "#", 
      "]"}], "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "shapes"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8019298742429714`*^9, 3.8019299063720655`*^9}, {
   3.8019300924412823`*^9, 3.8019301087607136`*^9}, {3.801930579687254*^9, 
   3.801930582051792*^9}, {3.8019309454917297`*^9, 3.801930978169538*^9}, {
   3.801931163088299*^9, 3.8019311641426487`*^9}, {3.8019342766195016`*^9, 
   3.801934286509338*^9}, {3.8019372670071664`*^9, 3.801937268418292*^9}, {
   3.8020781637066603`*^9, 3.8020781679840245`*^9}, {3.8020839443581038`*^9, 
   3.8020839454182673`*^9}, {3.802084006262455*^9, 3.802084007822282*^9}, {
   3.80600049924096*^9, 3.806000501178546*^9}, {3.8060005684017954`*^9, 
   3.806000570058078*^9}, {3.8068650727670507`*^9, 3.8068650941260395`*^9}, {
   3.8068652507979755`*^9, 3.8068652591735487`*^9}, 3.806865416909681*^9, {
   3.807010334176634*^9, 3.807010334270383*^9}, {3.807292337163897*^9, 
   3.8072923394916596`*^9}, {3.8072945753688188`*^9, 3.8072945773675413`*^9}, 
   3.8076342837061*^9, {3.8077014545638647`*^9, 3.807701458579523*^9}, {
   3.8077015089855475`*^9, 3.807701511269065*^9}, {3.8077048604935303`*^9, 
   3.807704876016949*^9}, {3.8077049122347345`*^9, 3.8077049192411594`*^9}, {
   3.8077049925529537`*^9, 3.807704992908004*^9}, {3.8077910193330116`*^9, 
   3.807791019871572*^9}, {3.807794550950467*^9, 3.8077945516376247`*^9}, 
   3.807794960028829*^9, {3.807802218867481*^9, 3.807802231401183*^9}, {
   3.8078722714329147`*^9, 3.8078722741675935`*^9}, {3.8078725261918664`*^9, 
   3.8078725373395305`*^9}, {3.8078728173308787`*^9, 3.807872821633321*^9}, {
   3.8078823733929453`*^9, 3.807882379006748*^9}, 3.807888921392132*^9, {
   3.80805523257681*^9, 3.8080552441191864`*^9}, {3.8084941807477813`*^9, 
   3.808494185365019*^9}},
 CellLabel->
  "In[375]:=",ExpressionUUID->"bd37bc39-e5cd-41cc-81bb-80dface241d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ View Computed Edges ]]", "Subsection",
 CellChangeTimes->{{3.7520000744520516`*^9, 3.7520000907368383`*^9}, {
  3.76025078342931*^9, 3.7602507895888357`*^9}, {3.760340938834385*^9, 
  3.7603409388992095`*^9}, {3.760341115299405*^9, 3.7603411228900948`*^9}, {
  3.7603537317112336`*^9, 3.760353734687275*^9}, {3.8077011273301916`*^9, 
  3.8077011305648117`*^9}},ExpressionUUID->"99adb542-1bb8-47b6-b181-\
df6e79a763bf"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Image", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Colorize", "@", 
        RowBox[{"ImageAdjust", "@", 
         RowBox[{"images", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"EdgeDetect", "@", 
        RowBox[{"shapes", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
     ",", 
     RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\[IndentingNewLine]", 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", "testBatch", ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.751700730257186*^9, 3.751700731514145*^9}, {
   3.751700803055996*^9, 3.751700894769446*^9}, {3.75170168791494*^9, 
   3.7517017158123417`*^9}, {3.7517018639348807`*^9, 
   3.7517018813064365`*^9}, {3.751702000600077*^9, 3.7517020040009823`*^9}, {
   3.7517020929207115`*^9, 3.751702094374817*^9}, {3.7517021366123123`*^9, 
   3.7517022073671875`*^9}, {3.751702283850288*^9, 3.7517023691726875`*^9}, {
   3.751702459503128*^9, 3.7517024625770082`*^9}, {3.7517025075358562`*^9, 
   3.751702507690447*^9}, {3.7517025544328527`*^9, 3.7517026450326138`*^9}, {
   3.7517027493084974`*^9, 3.751702798489914*^9}, {3.7517033244357896`*^9, 
   3.751703337393525*^9}, {3.751711727942279*^9, 3.7517117287710857`*^9}, {
   3.751711885870966*^9, 3.7517119147704134`*^9}, {3.7517119485475397`*^9, 
   3.751711968531616*^9}, {3.751712034162498*^9, 3.7517120503384576`*^9}, {
   3.751713541664321*^9, 3.7517136199388924`*^9}, {3.751713687605045*^9, 
   3.751713755409109*^9}, {3.751713832880621*^9, 3.7517138330900264`*^9}, {
   3.751713908700861*^9, 3.751713912277277*^9}, 3.751714424472802*^9, {
   3.7517144986898108`*^9, 3.7517144988174677`*^9}, 3.7517145333293276`*^9, {
   3.75171457242127*^9, 3.751714586649246*^9}, 3.7517149872322397`*^9, {
   3.751717468935364*^9, 3.751717469014146*^9}, {3.7517175253189983`*^9, 
   3.751717525424712*^9}, {3.751717659856103*^9, 3.751717659934868*^9}, 
   3.7517181008374166`*^9, {3.7517900368797226`*^9, 3.751790065749035*^9}, {
   3.7520000431110544`*^9, 3.752000043358457*^9}, 3.752050025062169*^9, {
   3.7599348836140394`*^9, 3.759934883679885*^9}, {3.760090169159897*^9, 
   3.7600901692407*^9}, {3.760095135940873*^9, 3.760095136163306*^9}, {
   3.760102286088817*^9, 3.7601022861875753`*^9}, {3.7601592880909357`*^9, 
   3.760159288282446*^9}, {3.7601595445118027`*^9, 3.7601595570961475`*^9}, {
   3.7601768558145957`*^9, 3.7601768790368967`*^9}, {3.7602084736665735`*^9, 
   3.7602084737894983`*^9}, {3.7606764656703105`*^9, 3.760676466403374*^9}, {
   3.760930039275576*^9, 3.760930051866666*^9}, {3.760964995528971*^9, 
   3.7609650186610827`*^9}, {3.761276747823949*^9, 3.7612767774899645`*^9}, {
   3.761276924675457*^9, 3.7612769247877183`*^9}, {3.761276965378317*^9, 
   3.761276965521964*^9}, 3.76128751126997*^9, 3.7612884815980234`*^9, {
   3.7612951248997126`*^9, 3.761295125059143*^9}, {3.761295252100294*^9, 
   3.761295257626461*^9}, {3.7612994432542105`*^9, 3.761299443451232*^9}, {
   3.76130002659076*^9, 3.7613000266595774`*^9}, {3.76130445904753*^9, 
   3.7613044592270503`*^9}, {3.7613287614853525`*^9, 3.76132876157611*^9}, {
   3.7613613178096976`*^9, 3.7613613179493246`*^9}, {3.7613649767414384`*^9, 
   3.761364976851144*^9}, {3.7613685189988585`*^9, 3.7613685191494555`*^9}, {
   3.7613686346150913`*^9, 3.7613686346928844`*^9}, {3.7613741903330216`*^9, 
   3.7613741905155325`*^9}, {3.761375484380458*^9, 3.76137548444239*^9}, {
   3.761384785877242*^9, 3.761384786033822*^9}, {3.761386962296254*^9, 
   3.7613869623760405`*^9}, {3.7613920491590652`*^9, 
   3.7613920493415775`*^9}, {3.7613923821584325`*^9, 3.76139238223024*^9}, {
   3.7669425728541827`*^9, 3.7669425732779217`*^9}, {3.769248620973722*^9, 
   3.7692486210185766`*^9}, {3.769248981842235*^9, 3.7692489840343704`*^9}, {
   3.7743536331952105`*^9, 3.7743536342094965`*^9}, {3.774353665220571*^9, 
   3.7743536653901496`*^9}, 3.7819650477105527`*^9, 3.7820232284353657`*^9, {
   3.8021162731144905`*^9, 3.8021163336138973`*^9}, {3.8021163853345437`*^9, 
   3.8021164066432657`*^9}, {3.8060642451675367`*^9, 
   3.8060642700023685`*^9}, {3.806069145569377*^9, 3.806069149022863*^9}, {
   3.8061514392805395`*^9, 3.806151464271459*^9}, {3.806151501440106*^9, 
   3.806151523343813*^9}, {3.806151590616054*^9, 3.806151609240404*^9}, {
   3.8061516404527063`*^9, 3.8061517323539896`*^9}, {3.8061518252889977`*^9, 
   3.8061518566562824`*^9}, {3.806177626217577*^9, 3.8061776265528154`*^9}, {
   3.806976442559767*^9, 3.80697645371791*^9}, {3.8076191691645813`*^9, 
   3.807619171305842*^9}, {3.8076192731332397`*^9, 3.807619284059403*^9}, {
   3.8076202214120083`*^9, 3.807620225061229*^9}, {3.8077011940174847`*^9, 
   3.8077012025647793`*^9}, {3.808055236960824*^9, 3.808055241710908*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"a0c52905-37b7-4e1f-a8fb-0c4a99b54622"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export/Import Filtered Images & Shapes", "Section",
 CellChangeTimes->{{3.751808845615265*^9, 3.75180886393727*^9}, {
  3.751808901177807*^9, 3.7518089106497416`*^9}, {3.8077013107205276`*^9, 
  3.807701320907961*^9}},ExpressionUUID->"fa407044-2d2f-45bd-acae-\
09dd04cf05a8"],

Cell[CellGroupData[{

Cell[">> Import Shape Sequence <<", "Subsection",
 CellChangeTimes->{{3.7692477686521626`*^9, 3.7692477928154936`*^9}, {
  3.8080409691978493`*^9, 
  3.8080409711372128`*^9}},ExpressionUUID->"603b9821-0f7f-4cb3-a916-\
a850c4cb7bea"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "@", "importShapes"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"files", "=", 
     RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ToExpression", "@", 
         RowBox[{"FileBaseName", "[", "#", "]"}]}], "&"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"shapes", "=", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Import", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"importShapes", "<>", "#"}], ",", "\[IndentingNewLine]", 
          RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "files"}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7692478588199587`*^9, 3.7692479076660247`*^9}, {
   3.7692479491019816`*^9, 3.7692480107794824`*^9}, {3.769248080560097*^9, 
   3.769248082795139*^9}, 3.76925173810561*^9, {3.7692519131140194`*^9, 
   3.7692519622119937`*^9}, {3.7692527540730815`*^9, 3.7692527788126087`*^9}, 
   3.7692528430520706`*^9, 3.769253962919899*^9, 3.7692541268950825`*^9, {
   3.7692542697392874`*^9, 3.769254283408947*^9}, {3.7692569202597485`*^9, 
   3.7692569210426507`*^9}, {3.7692601786821566`*^9, 3.769260178799868*^9}, 
   3.773315116965008*^9, {3.774353628559586*^9, 3.774353628585515*^9}, {
   3.774353699939827*^9, 3.7743537001413116`*^9}, {3.7819643972873163`*^9, 
   3.781964398013515*^9}, {3.8021161784434175`*^9, 3.802116179530509*^9}, {
   3.8061716138162394`*^9, 3.8061716139932528`*^9}, {3.806171677114572*^9, 
   3.8061716787851768`*^9}, {3.806171743514888*^9, 3.806171744306552*^9}, {
   3.8061776089431896`*^9, 3.806177610353205*^9}, {3.806970243093007*^9, 
   3.806970243284496*^9}, {3.8072948914557962`*^9, 3.807294891532591*^9}, {
   3.8076146429459553`*^9, 3.807614643137374*^9}, {3.8076150005429945`*^9, 
   3.8076150006217833`*^9}, {3.807701376892087*^9, 3.807701377064438*^9}, {
   3.8077050330741615`*^9, 3.807705047312853*^9}, {3.807794991860236*^9, 
   3.8077949921933427`*^9}, {3.8078779027007627`*^9, 3.807877902812465*^9}, {
   3.8078780160394125`*^9, 3.807878016508088*^9}, {3.8078890989458427`*^9, 
   3.8078890990495653`*^9}, {3.808038593533242*^9, 3.808038593683544*^9}, {
   3.8081371585065746`*^9, 3.8081371598490343`*^9}, {3.845905482067376*^9, 
   3.8459054875781126`*^9}},ExpressionUUID->"033a074b-7352-4fd5-81cd-\
1999fec08685"]
}, Open  ]],

Cell[CellGroupData[{

Cell[">> Import Corrected Images <<", "Subsection",
 CellChangeTimes->{{3.7692477686521626`*^9, 3.7692477928154936`*^9}, {
   3.8077013421579123`*^9, 3.807701345783128*^9}, {3.8080409643739977`*^9, 
   3.808040966781883*^9}, {3.8081581035713606`*^9, 3.8081581067158585`*^9}, 
   3.808158213578257*^9},ExpressionUUID->"76dde5e4-d54b-4046-a156-\
9e2abb4bcd05"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"launchNukes", "@", "useKernels"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "@", "importCorrected"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"files", "=", 
     RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FileNames", "[", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ToExpression", "@", 
         RowBox[{"FileBaseName", "[", "#", "]"}]}], "&"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"correctedImages", "=", 
     RowBox[{"ParallelMap", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Import", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"importCorrected", "<>", "#"}], ",", "\[IndentingNewLine]", 
          RowBox[{"IncludeMetaInformation", "\[Rule]", "None"}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "files"}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7692478588199587`*^9, 3.7692479076660247`*^9}, {
   3.7692479491019816`*^9, 3.7692480107794824`*^9}, {3.769248080560097*^9, 
   3.769248082795139*^9}, 3.76925173810561*^9, {3.7692519131140194`*^9, 
   3.7692519622119937`*^9}, {3.7692527540730815`*^9, 3.7692527788126087`*^9}, 
   3.7692528430520706`*^9, 3.769253962919899*^9, 3.7692541268950825`*^9, {
   3.7692542697392874`*^9, 3.769254283408947*^9}, {3.7692569202597485`*^9, 
   3.7692569210426507`*^9}, {3.7692601786821566`*^9, 3.769260178799868*^9}, 
   3.773315116965008*^9, {3.774353628559586*^9, 3.774353628585515*^9}, {
   3.774353699939827*^9, 3.7743537001413116`*^9}, {3.7819643972873163`*^9, 
   3.781964398013515*^9}, {3.8021161784434175`*^9, 3.802116179530509*^9}, {
   3.8061716138162394`*^9, 3.8061716139932528`*^9}, {3.806171677114572*^9, 
   3.8061716787851768`*^9}, {3.806171743514888*^9, 3.806171744306552*^9}, {
   3.8061776089431896`*^9, 3.806177610353205*^9}, {3.806970243093007*^9, 
   3.806970243284496*^9}, {3.8072948914557962`*^9, 3.807294891532591*^9}, {
   3.8076146429459553`*^9, 3.807614643137374*^9}, {3.8076150005429945`*^9, 
   3.8076150006217833`*^9}, {3.807701351673732*^9, 3.807701394360863*^9}, 
   3.807701678204179*^9, {3.807705052538098*^9, 3.8077050608503804`*^9}, {
   3.807794995235265*^9, 3.807794996544711*^9}, {3.8078779039728017`*^9, 
   3.807877904132374*^9}, {3.807878039454593*^9, 3.807878039683978*^9}, {
   3.807889009357051*^9, 3.8078890094407473`*^9}, {3.807956326505091*^9, 
   3.8079563302885523`*^9}, {3.8080385911321063`*^9, 3.808038591291679*^9}, {
   3.8080392698888683`*^9, 3.808039272345059*^9}, {3.808040280390045*^9, 
   3.808040362173689*^9}, {3.8080404326739454`*^9, 3.808040433596467*^9}, 
   3.8080405049811745`*^9, {3.808040979341723*^9, 3.80804098209984*^9}, 
   3.8081126100605288`*^9, {3.80815821630098*^9, 3.8081582548357396`*^9}, 
   3.808198679273079*^9, {3.8083187624455805`*^9, 3.8083187647220125`*^9}, {
   3.8459054929715366`*^9, 
   3.84590549666617*^9}},ExpressionUUID->"498933b0-c3a4-45fe-a819-\
f21062c0ab04"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export The Bubble Shape Sequence >>", "Subsection",
 CellChangeTimes->{{3.7612417161251016`*^9, 
  3.7612417440409446`*^9}},ExpressionUUID->"a67736a4-2bfb-44f8-a593-\
9ad050d68387"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Speak", "@", "\"\<Exporting bubble shape images\>\""}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"output", "<>", "shapesFolder"}], "]"}], ",", 
      "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"output", "<>", "shapesFolder"}], "//", "CreateDirectory"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"monitorCounter", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", 
        RowBox[{"Length", "@", "shapes"}]}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Export", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"output", "<>", "shapesFolder", "<>", "\"\<Frame_\>\"", "<>", 
           RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<.png\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"shapes", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"monitorCounter", "++"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "shapes"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Speak", "@", "\"\<Image export complete\>\""}]}]}]], "Input",
 CellChangeTimes->{{3.761241747471836*^9, 3.7612417525776973`*^9}, {
   3.761241791976473*^9, 3.761241832865331*^9}, {3.761241970471409*^9, 
   3.7612420062452188`*^9}, {3.761279903645647*^9, 3.7612799174946957`*^9}, {
   3.7612822724997215`*^9, 3.761282296606557*^9}, {3.761282571689996*^9, 
   3.761282644901845*^9}, {3.761282767128497*^9, 3.7612828307295923`*^9}, {
   3.761282997016981*^9, 3.7612830101450167`*^9}, {3.7612830708725853`*^9, 
   3.7612830729276667`*^9}, {3.7669425789204407`*^9, 3.766942585241539*^9}, {
   3.769246241781739*^9, 3.769246241870208*^9}, {3.7692569270984898`*^9, 
   3.7692569277716775`*^9}, {3.769260221810302*^9, 3.769260221856179*^9}, {
   3.781964736253527*^9, 3.7819647387698994`*^9}, {3.7819647919557805`*^9, 
   3.78196479828197*^9}, {3.7819649079202433`*^9, 3.7819649088956394`*^9}, {
   3.782023517700699*^9, 3.782023519882348*^9}, {3.7821374454907193`*^9, 
   3.782137445661268*^9}, {3.802115452464846*^9, 3.8021154676921196`*^9}, {
   3.8021164655521336`*^9, 3.8021164666182814`*^9}, {3.8021165505474033`*^9, 
   3.802116553135475*^9}, 3.8061720637491136`*^9, 3.806172180281579*^9, {
   3.806975554346463*^9, 3.8069755560161915`*^9}, {3.8077012128612585`*^9, 
   3.807701212955394*^9}, {3.807794983466172*^9, 3.80779498363472*^9}, {
   3.808040955311593*^9, 3.8080409612473893`*^9}, {3.8081371632732706`*^9, 
   3.808137169865279*^9}},
 CellLabel->
  "In[382]:=",ExpressionUUID->"4ca4521a-1507-42a8-bab3-5422b188811b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export The Corrected Image Sequence >>", "Subsection",
 CellChangeTimes->{{3.7612417161251016`*^9, 3.7612417440409446`*^9}, {
  3.807615420967802*^9, 3.807615424511803*^9}, {3.8081581195744905`*^9, 
  3.808158121660641*^9}, {3.8081582000416393`*^9, 
  3.8081582013860397`*^9}},ExpressionUUID->"4eb7c598-ba33-450d-9d89-\
b88294287f54"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Speak", "@", "\"\<Exporting filtered images\>\""}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"output", "<>", "correctedFolder"}], "]"}], ",", 
      "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"output", "<>", "correctedFolder"}], "//", 
       "CreateDirectory"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"monitorCounter", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", 
        RowBox[{"Length", "@", "correctedImages"}]}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Export", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"output", "<>", "correctedFolder", "<>", "\"\<Frame_\>\"", "<>", 
           RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\<.png\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"correctedImages", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"monitorCounter", "++"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"progress", "[", 
      RowBox[{"monitorCounter", ",", 
       RowBox[{"Length", "@", "correctedImages"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Speak", "@", "\"\<Image export complete\>\""}]}]}]], "Input",
 CellChangeTimes->{{3.761241747471836*^9, 3.7612417525776973`*^9}, {
   3.761241791976473*^9, 3.761241832865331*^9}, {3.761241970471409*^9, 
   3.7612420062452188`*^9}, {3.761279903645647*^9, 3.7612799174946957`*^9}, {
   3.7612822724997215`*^9, 3.761282296606557*^9}, {3.761282571689996*^9, 
   3.761282644901845*^9}, {3.761282767128497*^9, 3.7612828307295923`*^9}, {
   3.761282997016981*^9, 3.7612830101450167`*^9}, {3.7612830708725853`*^9, 
   3.7612830729276667`*^9}, {3.7669425789204407`*^9, 3.766942585241539*^9}, {
   3.769246241781739*^9, 3.769246241870208*^9}, {3.7692569270984898`*^9, 
   3.7692569277716775`*^9}, {3.769260221810302*^9, 3.769260221856179*^9}, {
   3.781964736253527*^9, 3.7819647387698994`*^9}, {3.7819647919557805`*^9, 
   3.78196479828197*^9}, {3.7819649079202433`*^9, 3.7819649088956394`*^9}, {
   3.782023517700699*^9, 3.782023519882348*^9}, {3.7821374454907193`*^9, 
   3.782137445661268*^9}, {3.802115452464846*^9, 3.8021154676921196`*^9}, {
   3.8021164655521336`*^9, 3.8021164666182814`*^9}, {3.8021165505474033`*^9, 
   3.802116553135475*^9}, 3.8061720637491136`*^9, 3.806172180281579*^9, {
   3.806975554346463*^9, 3.8069755560161915`*^9}, {3.807615429497422*^9, 
   3.8076154341768646`*^9}, {3.8076155160716853`*^9, 3.807615553695283*^9}, {
   3.807701215345792*^9, 3.807701215455281*^9}, {3.807794985058836*^9, 
   3.807794985218475*^9}, 3.807795604920823*^9, {3.807885358492693*^9, 
   3.8078853632415743`*^9}, {3.8078854823952003`*^9, 
   3.8078855590964513`*^9}, {3.807885595731655*^9, 3.80788560043499*^9}, {
   3.8078857367852573`*^9, 3.807885743519601*^9}, {3.807889013907893*^9, 
   3.807889013989602*^9}, {3.8079492231003532`*^9, 3.8079492232679048`*^9}, {
   3.808040957775303*^9, 3.8080409598865232`*^9}, {3.8081581255408635`*^9, 
   3.8081581461814203`*^9}, {3.808158369043503*^9, 3.808158381532364*^9}, {
   3.8081584264833107`*^9, 3.808158452419815*^9}, {3.8081584863651485`*^9, 
   3.80815850714804*^9}, {3.808200208164496*^9, 3.8082002593465605`*^9}},
 CellLabel->
  "In[387]:=",ExpressionUUID->"81c48a80-21ae-4be4-b551-d8e30d945f45"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bubble Identification & Measurements", "Section",
 CellChangeTimes->{{3.751808845615265*^9, 3.75180886393727*^9}, {
  3.751808917792242*^9, 3.751808932761138*^9}, {3.751809044002904*^9, 
  3.7518090458985295`*^9}, {3.7602508154433937`*^9, 
  3.76025081781104*^9}},ExpressionUUID->"0c10bdc7-1e83-4f75-afc1-\
ae629374c1d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bubbleParameters", ":=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Image\>\"", ",", "\"\<Centroid\>\"", ",", 
     "\"\<MeanCentroidDistance\>\"", ",", "\"\<FilledCount\>\"", ",", 
     "\"\<SemiAxes\>\"", ",", "\"\<Eccentricity\>\"", ",", 
     "\"\<Orientation\>\""}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"selectedShapes", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"shapes", "[", 
      RowBox[{"[", "x", "]"}], "]"}], ",", "bubbleParameters"}], 
    "\[IndentingNewLine]", "]"}], "/.", 
   RowBox[{"Rule", "\[Rule]", "List"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7518804741196995`*^9, 3.751880484495264*^9}, {
   3.751881208731094*^9, 3.751881234824321*^9}, 3.751951660698275*^9, {
   3.7519522775994883`*^9, 3.751952277869765*^9}, 3.752384866636897*^9, {
   3.7599349909719176`*^9, 3.759935085936244*^9}, {3.7599371438484235`*^9, 
   3.7599371998497577`*^9}, {3.7600848973814473`*^9, 3.760084902141735*^9}, {
   3.760157179713343*^9, 3.760157316535739*^9}, 3.760157770608785*^9, {
   3.7601578915603228`*^9, 3.760157936336626*^9}, 3.760158135968637*^9, {
   3.7601593398714576`*^9, 3.760159343102814*^9}, {3.7601606444955163`*^9, 
   3.7601606469898524`*^9}, 3.760161081887044*^9, {3.7608874390813065`*^9, 
   3.760887442327317*^9}, {3.7608985393720007`*^9, 3.760898539550523*^9}, {
   3.7609383341091976`*^9, 3.7609383386765237`*^9}, {3.7669425953275013`*^9, 
   3.7669426153085785`*^9}, {3.768658534534148*^9, 3.768658540846247*^9}, 
   3.7733161395538445`*^9, {3.782023547547119*^9, 3.7820235733537593`*^9}, 
   3.8021156549247465`*^9, 3.80211668957285*^9, {3.8021167268027744`*^9, 
   3.802116748826229*^9}, {3.80211679657885*^9, 3.8021167981306987`*^9}, 
   3.8021170319243307`*^9, {3.802117087228159*^9, 3.80211708964669*^9}, {
   3.8021171472623425`*^9, 3.802117193541007*^9}, 3.806134096426816*^9},
 CellLabel->
  "In[392]:=",ExpressionUUID->"66f11905-9bdc-43d3-83ac-6259c5fced5b"],

Cell[CellGroupData[{

Cell["Generate Bubble Sequence", "Subsection",
 CellChangeTimes->{{3.760170629795117*^9, 3.7601706401006827`*^9}, {
  3.760170795201949*^9, 3.760170798745466*^9}, {3.7606762316112127`*^9, 
  3.760676233749736*^9}, {3.7606946076196675`*^9, 3.760694610110034*^9}, {
  3.7608872199123073`*^9, 
  3.760887281392333*^9}},ExpressionUUID->"81e3ee31-d34f-40c6-873b-\
a998302564a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Speak", "@", "\"\<Analysing detected shapes\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"extract", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{"selectedShapes", "[", "m", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", "testBatch"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", "testBatch"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Speak", "@", "\"\<Shape analysis complete\>\""}]}], "Input",
 CellChangeTimes->{{3.8077046589024925`*^9, 3.807704759469014*^9}, {
  3.807705069978904*^9, 3.8077050764501405`*^9}, {3.807705583516142*^9, 
  3.80770558475084*^9}, {3.8078785323377285`*^9, 3.807878561102276*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"c6a14208-3ff4-438c-ae5d-d8baece47a39"],

Cell[BoxData[
 RowBox[{"--", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.807940906718182*^9, 
  3.8079409098892198`*^9}},ExpressionUUID->"129c71d1-56f4-437a-8351-\
1f9831882359"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export The Bubble Sequence >>", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170807076165*^9}, {
  3.760353612711093*^9, 3.7603536153939342`*^9}, {3.760887234335846*^9, 
  3.7608872387609673`*^9}, {3.76088728531983*^9, 
  3.7608872861286664`*^9}},ExpressionUUID->"1a910300-7101-44a2-af4d-\
ec92bd3299c2"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"reductionFactor", "=", "6"}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"tally1", "=", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"k", ",", 
           RowBox[{"extract", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
         ",", "1"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"testBatch", "/", "reductionFactor"}], "//", "Round"}]}], 
        "}"}]}], "\[IndentingNewLine]", "]"}], "//", "TableForm"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "<>", "\"\<Image Filter Output.pdf\>\""}], ",", 
     "\[IndentingNewLine]", "tally1"}], "\[IndentingNewLine]", "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.760085006798891*^9, 3.7600850084424973`*^9}, {
   3.7600852284464664`*^9, 3.760085230307479*^9}, {3.7600970658438735`*^9, 
   3.76009716745831*^9}, {3.7600972030442443`*^9, 3.760097249810731*^9}, {
   3.7600972999402184`*^9, 3.7600973045080023`*^9}, {3.760098028115207*^9, 
   3.7600980741059456`*^9}, {3.7601578167445602`*^9, 
   3.7601578343399367`*^9}, {3.760160853272077*^9, 3.7601608548957367`*^9}, {
   3.760160968111302*^9, 3.760160969852683*^9}, {3.760170660821293*^9, 
   3.760170696036518*^9}, {3.7602506335671096`*^9, 3.7602506376272535`*^9}, {
   3.7604547167444324`*^9, 3.7604547340816994`*^9}, {3.760676479949131*^9, 
   3.760676480531562*^9}, {3.760887060351301*^9, 3.7608870945758786`*^9}, {
   3.760887193720355*^9, 3.7608872000630713`*^9}, 3.760929305471698*^9, {
   3.766942679829764*^9, 3.7669426853895655`*^9}, 3.781964803658646*^9, 
   3.781965075894517*^9, {3.806134330043498*^9, 3.8061343302586517`*^9}, {
   3.806961510118593*^9, 3.8069615103409967`*^9}, 3.8073492280026584`*^9, {
   3.8077046430182133`*^9, 3.8077046464097834`*^9}, {3.8077063450779314`*^9, 
   3.807706369384944*^9}, {3.808042447406464*^9, 
   3.808042447804397*^9}},ExpressionUUID->"5fbe028c-c19a-43a5-8c0d-\
f62c3c410e28"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multiscale Recursive Interrogation Filter (MRIF)", "Section",
 CellChangeTimes->{{3.8090023030877514`*^9, 3.8090023262495203`*^9}, {
  3.809002671015582*^9, 3.8090026724069967`*^9}, {3.809003200274109*^9, 
  3.809003218172567*^9}, {3.809108152137757*^9, 
  3.809108153832221*^9}},ExpressionUUID->"7a32f6d2-0e5e-41cc-978c-\
e18beb807099"],

Cell["Possible Improvements", "Abstract",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
  3.769158606943906*^9, 3.7691586572504983`*^9}, {3.7692223025981207`*^9, 
  3.769222339641034*^9}},ExpressionUUID->"b93ab03c-57c7-412a-a260-\
033d0edf2014"],

Cell["Come up with more concise definitions", "Subitem",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
   3.769158606943906*^9, 3.7691586572504983`*^9}, 3.7692223043414335`*^9, {
   3.769222342585159*^9, 3.769222345000705*^9}, {3.769230882123254*^9, 
   3.769230908195506*^9}, {3.770115650982784*^9, 3.7701156661114388`*^9}, {
   3.804171808390911*^9, 3.804171808392909*^9}, {3.8081365094586353`*^9, 
   3.8081365181462297`*^9}},ExpressionUUID->"54af23c8-d623-4688-bd68-\
a9a3e2295ff0"],

Cell[CellGroupData[{

Cell["Interrogation Filter", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.8077950418489313`*^9, 3.807795048833222*^9}, {3.8080396828366003`*^9, 
  3.808039714652876*^9}, {3.8089174228965707`*^9, 
  3.808917423465049*^9}},ExpressionUUID->"137c5652-b25d-44b0-91bb-\
ca84bd73119a"],

Cell["\<\
Defaults:

interrogationScaleFactor = 2;
regionCutoffScale = 20;
regionGradientScale = 30;
levelSetIterations = 250;
regionErosionFactor = 1;
edgeCutoffScale = 5;
luminanceCompression = 0.5;
heightPixels = Last@ImageDimensions@First@images;\
\>", "Abstract",
 CellChangeTimes->{{3.8084693530785947`*^9, 
  3.808469359788123*^9}},ExpressionUUID->"5daf6f3c-7958-4b8b-aa06-\
cd95a80e9d0b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"regionShapes", ",", "regionBinarizaiton"}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"interrogationScaleFactor", "=", "2.5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regionCutoffScale", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regionGradientScale", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"levelSetIterations", "=", "250"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"regionErosionFactor", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgeCutoffScale", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"luminanceCompression", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"heightPixels", "=", 
    RowBox[{"Last", "@", 
     RowBox[{"ImageDimensions", "@", 
      RowBox[{"First", "@", "images"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bubbleData", "[", 
    RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dataset", "[", 
      RowBox[{"[", 
       RowBox[{"testID", ",", "bubbleID"}], "]"}], "]"}], ",", "1"}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"centroidEstimate", "[", 
     RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"bubbleData", "[", 
       RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}], "//", "Round"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interrogationScale", "[", 
    RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"interrogationScaleFactor", "*", 
     RowBox[{"N", "@", 
      RowBox[{"Sqrt", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"bubbleData", "[", 
          RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], "[", 
         RowBox[{"[", "5", "]"}], "]"}], "/", "\[Pi]"}], 
       "\[IndentingNewLine]", "]"}]}]}], "//", "Round"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"interrogationWindow", "[", 
    RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"heightPixels", "-", 
             RowBox[{"Last", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"heightPixels", "-", 
            RowBox[{"Last", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "0"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"heightPixels", "-", 
             RowBox[{"Last", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "+", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "<", "heightPixels"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"heightPixels", "-", 
            RowBox[{"Last", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "+", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "heightPixels"}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "0"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"First", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "+", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "<", "widthPixels"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "+", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "widthPixels"}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], "&"}], 
    "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"centroidEstimate", "[", 
       RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"interrogationScale", "[", 
       RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"virtualWindow", "[", 
    RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"heightPixels", "-", 
          RowBox[{"Last", "@", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"heightPixels", "-", 
          RowBox[{"Last", "@", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "+", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "-", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"First", "@", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "+", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}],
       "\[IndentingNewLine]", "}"}], "&"}], "@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"centroidEstimate", "[", 
       RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"interrogationScale", "[", 
       RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"imageRegion", "[", 
    RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageTake", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"images", "[", 
        RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"First", "@", "#"}], ",", 
       RowBox[{"Last", "@", "#"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"interrogationWindow", "[", 
     RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bubbleRegion", "[", 
    RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageTake", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"correctedImages", "[", 
        RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"First", "@", "#"}], ",", 
       RowBox[{"Last", "@", "#"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"interrogationWindow", "[", 
     RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"correctedRegion", "[", 
    RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{"#", "-", 
         RowBox[{"ColorNegate", "@", 
          RowBox[{"ColorToneMapping", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", "luminanceCompression", ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Luminance\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
      "&"}], "@", 
    RowBox[{"bubbleRegion", "[", 
     RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filteredRegion", "[", 
    RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
   RowBox[{"MeanFilter", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bubbleRegion", "[", 
      RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], ",", 
     "regionCutoffScale"}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regionHalo", "[", 
    RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"GradientFilter", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"filteredRegion", "[", 
       RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], ",", 
      "regionGradientScale", ",", 
      RowBox[{"Method", "\[Rule]", "\"\<Gaussian\>\""}]}], 
     "\[IndentingNewLine]", "]"}], "//", "ImageAdjust"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regionBinarizaiton", "[", 
    RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
   RowBox[{"ChanVeseBinarize", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"regionHalo", "[", 
      RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], ",", 
     RowBox[{"MaxIterations", "\[Rule]", "levelSetIterations"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regionEdges", "[", 
    RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Thinning", "@", 
    RowBox[{"Erosion", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"regionBinarizaiton", "[", 
       RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"DiskMatrix", "@", "regionErosionFactor"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"regionShapes", "[", 
    RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Binarize", "@", 
     RowBox[{"MeanFilter", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FillingTransform", "@", 
        RowBox[{"regionEdges", "[", 
         RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}]}], ",", 
       "edgeCutoffScale"}], "\[IndentingNewLine]", "]"}]}], "//", 
    "DeleteBorderComponents"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checkOutput", "[", 
   RowBox[{"dataset_", ",", "testID_", ",", "bubbleID_"}], "]"}], ":=", 
  RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"imageRegion", "[", 
          RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], "//", 
         "Colorize"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bubbleRegion", "[", 
          RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], "//", 
         "Colorize"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"correctedRegion", "[", 
          RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], "//", 
         "Colorize"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"filteredRegion", "[", 
          RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], "//", 
         "Colorize"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"regionHalo", "[", 
          RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], "//", 
         "Colorize"}], ",", "\[IndentingNewLine]", 
        RowBox[{"regionBinarizaiton", "[", 
         RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"regionEdges", "[", 
         RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"regionShapes", "[", 
         RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"imageRegion", "[", 
            RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], "//", 
           "Colorize"}], ",", "\[IndentingNewLine]", 
          RowBox[{"EdgeDetect", "@", 
           RowBox[{"regionShapes", "[", 
            RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"imageRegion", "[", 
           RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"EdgeDetect", "@", 
           RowBox[{"regionShapes", "[", 
            RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"correctedRegion", "[", 
            RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}], "//", 
           "Colorize"}], ",", "\[IndentingNewLine]", 
          RowBox[{"EdgeDetect", "@", 
           RowBox[{"regionShapes", "[", 
            RowBox[{"dataset", ",", "testID", ",", "bubbleID"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "}"}], ",", 
    RowBox[{"Dividers", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.80794209261248*^9, 3.8079421018022795`*^9}, {
   3.8079421519805536`*^9, 3.8079421735471687`*^9}, {3.8079422468587646`*^9, 
   3.80794225092188*^9}, {3.8079423053204947`*^9, 3.8079423290498877`*^9}, {
   3.8079428288643*^9, 3.807942898605093*^9}, {3.8079429623314667`*^9, 
   3.807943004116669*^9}, {3.807943292544943*^9, 3.807943319848852*^9}, {
   3.807943766953698*^9, 3.8079439711481934`*^9}, {3.8079440398081837`*^9, 
   3.807944087564305*^9}, {3.8079441527606444`*^9, 3.8079441698823495`*^9}, {
   3.807956486205914*^9, 3.807956532095162*^9}, {3.8079565973153596`*^9, 
   3.8079566201884103`*^9}, {3.807956722792636*^9, 3.807956787985623*^9}, {
   3.8079570492739*^9, 3.8079570649050703`*^9}, {3.807957106113489*^9, 
   3.807957480477507*^9}, {3.8079575604902716`*^9, 3.8079576488342*^9}, {
   3.807957845727207*^9, 3.8079578458209567`*^9}, {3.8079578795584292`*^9, 
   3.8079578967075157`*^9}, {3.80795793756705*^9, 3.807957938396406*^9}, {
   3.807957972943485*^9, 3.8079581849183006`*^9}, {3.8079582399092264`*^9, 
   3.807958368138627*^9}, {3.8079584042865114`*^9, 3.8079584139869843`*^9}, {
   3.8079590068795075`*^9, 3.8079590425467277`*^9}, {3.8079591556279697`*^9, 
   3.8079594514947968`*^9}, {3.8079596640575824`*^9, 
   3.8079596641722765`*^9}, {3.807959695951543*^9, 3.807960032196158*^9}, {
   3.807960221105085*^9, 3.8079603027958083`*^9}, {3.807960572885458*^9, 
   3.8079605838030295`*^9}, {3.807960688788906*^9, 3.807960688914569*^9}, {
   3.8079610614758687`*^9, 3.807961067377285*^9}, {3.807964885286758*^9, 
   3.8079648974599752`*^9}, 3.8079649352122345`*^9, 3.807964975490099*^9, {
   3.807965016244465*^9, 3.8079650217719517`*^9}, {3.807965135064128*^9, 
   3.8079652235083365`*^9}, 3.8079653490728607`*^9, 3.8079673237208195`*^9, {
   3.807977867560326*^9, 3.807977890083313*^9}, {3.80802966294016*^9, 
   3.8080296726830854`*^9}, {3.8080298033918257`*^9, 3.808029873995318*^9}, {
   3.8081359034311514`*^9, 3.808135906195017*^9}, {3.808200969065276*^9, 
   3.8082009695569*^9}, {3.808206581324375*^9, 3.8082066561193027`*^9}, {
   3.808207117976136*^9, 3.808207122551394*^9}, {3.80820769578623*^9, 
   3.8082077082173223`*^9}, {3.808395265444147*^9, 3.8083952696197205`*^9}, {
   3.8087245747377124`*^9, 3.8087246237328978`*^9}, {3.808724796750124*^9, 
   3.8087247980287004`*^9}, {3.80872518006216*^9, 3.8087252256978235`*^9}, {
   3.8087252606193123`*^9, 3.808725264913747*^9}, {3.8087257650588427`*^9, 
   3.808725929488937*^9}, {3.8087260344991283`*^9, 3.8087260349938016`*^9}, 
   3.808726072278286*^9, 3.8087261138593783`*^9, {3.808726145507643*^9, 
   3.808726201552462*^9}, {3.808726232953521*^9, 3.808726280315297*^9}, 
   3.80872916838247*^9, {3.808729218722434*^9, 3.8087292316027904`*^9}, {
   3.8087298298732357`*^9, 3.8087298299520245`*^9}, {3.8087298724492807`*^9, 
   3.808729887277877*^9}, 3.8087300790516443`*^9, {3.8087301443329*^9, 
   3.8087301771194296`*^9}, {3.8087304363465962`*^9, 3.8087304364194*^9}, {
   3.808730582897599*^9, 3.8087305830870934`*^9}, {3.8087309375901537`*^9, 
   3.80873098600872*^9}, {3.808731060165269*^9, 3.8087310602141366`*^9}, {
   3.808733530089575*^9, 3.8087335429177933`*^9}, {3.8087341849146338`*^9, 
   3.8087341942741504`*^9}, {3.808734727787134*^9, 3.80873477670894*^9}, {
   3.8087348343805804`*^9, 3.8087348487400866`*^9}, {3.8087348816929593`*^9, 
   3.8087349141301904`*^9}, {3.8087350055364103`*^9, 
   3.8087350068015895`*^9}, {3.80873505923905*^9, 3.808735059426407*^9}, {
   3.8087360230788307`*^9, 3.8087360249697824`*^9}, {3.8088497011350155`*^9, 
   3.8088499069363766`*^9}, 3.8088501685189433`*^9, {3.8088503882762194`*^9, 
   3.8088503900903044`*^9}, {3.808907074217992*^9, 3.808907074228964*^9}, {
   3.8089071685932665`*^9, 3.808907170088829*^9}, {3.8089162717655478`*^9, 
   3.8089162724656744`*^9}, {3.809001890994812*^9, 3.8090018941624603`*^9}, {
   3.8090020398589754`*^9, 3.8090020402808447`*^9}, {3.8090703117130404`*^9, 
   3.809070311851668*^9}, {3.8090906807129717`*^9, 3.8090906927688055`*^9}, {
   3.8092040513764553`*^9, 3.809204068434271*^9}},
 CellLabel->
  "In[987]:=",ExpressionUUID->"ec29e171-4e98-407a-a37f-1a21dae477c8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Recursive Filter", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
   3.8077950418489313`*^9, 3.807795048833222*^9}, {3.8080396828366003`*^9, 
   3.808039714652876*^9}, {3.8089174228965707`*^9, 3.808917455924672*^9}, {
   3.8089252776266623`*^9, 3.80892527768985*^9}, 
   3.8090674509564395`*^9},ExpressionUUID->"8e5b27ee-b6a8-4e8b-aa53-\
240ff0456546"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getMetric", "[", 
    RowBox[{"dataset_", ",", "metricID_"}], "]"}], ":=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{"#", ",", "1"}], "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"[", "metricID", "]"}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "dataset", ",", 
     RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recursionImageRegion", "[", 
    RowBox[{"dataset_", ",", "localID_", ",", "bubbleID_", ",", "testID_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageTake", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"images", "[", 
        RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"First", "@", "#"}], ",", 
       RowBox[{"Last", "@", "#"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"interrogationWindow", "[", 
     RowBox[{"dataset", ",", "localID", ",", "bubbleID"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recursionBubbleRegion", "[", 
    RowBox[{"dataset_", ",", "localID_", ",", "bubbleID_", ",", "testID_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageTake", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"correctedImages", "[", 
        RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"First", "@", "#"}], ",", 
       RowBox[{"Last", "@", "#"}]}], "\[IndentingNewLine]", "]"}], "&"}], "@", 
    RowBox[{"interrogationWindow", "[", 
     RowBox[{"dataset", ",", "localID", ",", "bubbleID"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recursionCorrectedRegion", "[", 
    RowBox[{"dataset_", ",", "localID_", ",", "bubbleID_", ",", "testID_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageAdjust", "@", 
      RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
       RowBox[{"#", ",", 
        RowBox[{"#", "-", 
         RowBox[{"ColorNegate", "@", 
          RowBox[{"ColorToneMapping", "[", "\[IndentingNewLine]", 
           RowBox[{"#", ",", "luminanceCompression", ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Luminance\>\""}]}], 
           "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
      "&"}], "@", 
    RowBox[{"recursionBubbleRegion", "[", 
     RowBox[{"dataset", ",", "localID", ",", "bubbleID", ",", "testID"}], 
     "]"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recursionFilteredRegion", "[", 
    RowBox[{"dataset_", ",", "localID_", ",", "bubbleID_", ",", "testID_"}], 
    "]"}], ":=", 
   RowBox[{"MeanFilter", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"recursionBubbleRegion", "[", 
      RowBox[{"dataset", ",", "localID", ",", "bubbleID", ",", "testID"}], 
      "]"}], ",", "regionCutoffScale"}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recursionRegionHalo", "[", 
    RowBox[{"dataset_", ",", "localID_", ",", "bubbleID_", ",", "testID_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"GradientFilter", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"recursionFilteredRegion", "[", 
       RowBox[{"dataset", ",", "localID", ",", "bubbleID", ",", "testID"}], 
       "]"}], ",", "regionGradientScale", ",", 
      RowBox[{"Method", "\[Rule]", "\"\<Gaussian\>\""}]}], 
     "\[IndentingNewLine]", "]"}], "//", "ImageAdjust"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recursionRegionBinarizaiton", "[", 
    RowBox[{"dataset_", ",", "localID_", ",", "bubbleID_", ",", "testID_"}], 
    "]"}], ":=", 
   RowBox[{"ChanVeseBinarize", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"recursionRegionHalo", "[", 
      RowBox[{"dataset", ",", "localID", ",", "bubbleID", ",", "testID"}], 
      "]"}], ",", 
     RowBox[{"MaxIterations", "\[Rule]", "levelSetIterations"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recursionRegionEdges", "[", 
    RowBox[{"dataset_", ",", "localID_", ",", "bubbleID_", ",", "testID_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Thinning", "@", 
    RowBox[{"Erosion", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"recursionRegionBinarizaiton", "[", 
       RowBox[{"dataset", ",", "localID", ",", "bubbleID", ",", "testID"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"DiskMatrix", "@", "regionErosionFactor"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recursionRegionShapes", "[", 
    RowBox[{"dataset_", ",", "localID_", ",", "bubbleID_", ",", "testID_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"Binarize", "@", 
     RowBox[{"MeanFilter", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FillingTransform", "@", 
        RowBox[{"recursionRegionEdges", "[", 
         RowBox[{"dataset", ",", "localID", ",", "bubbleID", ",", "testID"}], 
         "]"}]}], ",", "edgeCutoffScale"}], "\[IndentingNewLine]", "]"}]}], "//",
     "DeleteBorderComponents"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"operatorScan", "[", 
    RowBox[{"operator_", ",", "dataset_", ",", "testID_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"operator", "[", 
      RowBox[{"dataset", ",", "testID", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", 
      RowBox[{"dataset", "[", 
       RowBox[{"[", "testID", "]"}], "]"}]}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"operatorMap", "[", 
    RowBox[{"operator_", ",", "dataset_", ",", "localID_", ",", "testID_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"operator", "@@", 
      RowBox[{"{", 
       RowBox[{"dataset", ",", "#", ",", "localID", ",", "testID"}], "}"}]}], 
     "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "dataset"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"distributeElements", "[", 
    RowBox[{"elements_", ",", "distributor_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ConstantArray", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"elements", "[", 
         RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Length", "@", 
         RowBox[{"distributor", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "distributor"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkNewWindows", "[", 
    RowBox[{
    "cycleParameters_", ",", "newInterrogationScales_", ",", "widthPixels_", 
     ",", "heightPixels_"}], "]"}], ":=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"heightPixels", "-", 
               RowBox[{"Last", "@", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "-", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"heightPixels", "-", 
              RowBox[{"Last", "@", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             "0"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"heightPixels", "-", 
               RowBox[{"Last", "@", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "+", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "<", "heightPixels"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"heightPixels", "-", 
              RowBox[{"Last", "@", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "+", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             "heightPixels"}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"First", "@", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "-", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             "0"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"First", "@", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "+", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "<", "widthPixels"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"First", "@", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "+", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             "widthPixels"}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "}"}], "&"}], "@", 
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Round", "@", 
         RowBox[{"Indexed", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"First", "@", 
            RowBox[{"Transpose", "@", "cycleParameters"}]}], ",", "k"}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"newInterrogationScales", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "@", "newInterrogationScales"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkExtendedWindows", "[", 
    RowBox[{
    "cycleParameters_", ",", "newInterrogationScales_", ",", 
     "heightPixels_"}], "]"}], ":=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"heightPixels", "-", 
            RowBox[{"Last", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"heightPixels", "-", 
            RowBox[{"Last", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "+", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "+", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
          "}"}]}], "\[IndentingNewLine]", "}"}], "&"}], "@", 
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Round", "@", 
         RowBox[{"Indexed", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"First", "@", 
            RowBox[{"Transpose", "@", "cycleParameters"}]}], ",", "k"}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"newInterrogationScales", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "@", "newInterrogationScales"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"conditionalCropCorrection", "[", "windowDimensions_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "<", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "/", "2"}], ",", 
         "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", "]"}], "+", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ">", "widthPixels"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "-", "widthPixels"}], ")"}]}], 
          "/", "2"}], ",", "\[IndentingNewLine]", "0"}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], ",", 
         "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", "]"}], "+", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ">", "heightPixels"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", "heightPixels"}], ")"}]}], 
          "/", "2"}], ",", "\[IndentingNewLine]", "0"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "}"}], "&"}], "@", 
   RowBox[{"Flatten", "@", "windowDimensions"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.808813321423951*^9, 3.8088133860388603`*^9}, {
  3.8088243233692036`*^9, 3.8088243237043066`*^9}, {3.80884136045796*^9, 
  3.808841366161683*^9}, {3.8088503493730526`*^9, 3.8088503822829485`*^9}, {
  3.808914752381905*^9, 3.808914753151376*^9}, {3.808916340311536*^9, 
  3.8089163438301716`*^9}, {3.808999025788646*^9, 3.808999027316491*^9}, {
  3.809084397472054*^9, 3.8090844233506727`*^9}, {3.8090850452543836`*^9, 
  3.8090850519463987`*^9}, {3.809179947511312*^9, 3.809179956950038*^9}},
 CellLabel->
  "In[1010]:=",ExpressionUUID->"acf519cd-e47c-4529-97ce-7f686ed4b641"]
}, Open  ]],

Cell[CellGroupData[{

Cell["MRIF", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.8077950418489313`*^9, 3.807795048833222*^9}, {3.8080396828366003`*^9, 
  3.808039714652876*^9}, {3.8089174228965707`*^9, 3.808917455924672*^9}, {
  3.8089174870251846`*^9, 3.808917507433693*^9}, {3.808917555256274*^9, 
  3.8089175622333713`*^9}, {3.808925256883334*^9, 3.808925269178713*^9}, {
  3.8090674839969068`*^9, 
  3.8090674850600586`*^9}},ExpressionUUID->"a3fccd37-3b17-47bd-b563-\
6a5621524ed2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cropVector", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.25"}], ",", "0.5"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MRIF", "[", 
    RowBox[{"imageID_", ",", "recursionCriterion_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"testID", "=", "imageID"}], ",", "\[IndentingNewLine]", 
       RowBox[{"cyclingResults", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"convergenceMap", "=", 
        RowBox[{"{", "True", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"recursionDepth", "=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"criticalAreaRatio", "=", "recursionCriterion"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"globalScan", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"extract", "[", 
          RowBox[{"[", 
           RowBox[{"testID", ",", "#", ",", "2", ",", "1"}], "]"}], "]"}], 
         "&"}], "@", 
        RowBox[{"Range", "@", 
         RowBox[{"Length", "@", 
          RowBox[{"extract", "[", 
           RowBox[{"[", "testID", "]"}], "]"}]}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"initialScan", "=", 
       RowBox[{"operatorScan", "[", 
        RowBox[{"regionShapes", ",", "extract", ",", "testID"}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"initialWindows", "=", 
       RowBox[{"operatorScan", "[", 
        RowBox[{"interrogationWindow", ",", "extract", ",", "testID"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"initialExtendedWindows", "=", 
       RowBox[{"operatorScan", "[", 
        RowBox[{"virtualWindow", ",", "extract", ",", "testID"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"convergedWindows", "[", "testID", "]"}], "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"convergedRegions", "[", "testID", "]"}], "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"While", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"convergenceMap", ",", "True"}], "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"refine", "=", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"recursionDepth", "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", "initialScan", ",", "\[IndentingNewLine]", 
            RowBox[{"operatorMap", "[", 
             RowBox[{
             "recursionRegionShapes", ",", "recycle", ",", "1", ",", 
              "testID"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", "\n", 
         RowBox[{"measure", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
              RowBox[{"#", ",", "bubbleParameters"}], "\[IndentingNewLine]", 
              "]"}], "/.", 
             RowBox[{"Rule", "\[Rule]", "List"}]}], "&"}], "/@", "refine"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"emptyElements", "=", 
          RowBox[{"Position", "[", "\[IndentingNewLine]", 
           RowBox[{"measure", ",", "\[IndentingNewLine]", 
            RowBox[{"_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "\[Equal]", 
                RowBox[{"{", "}"}]}], "&"}], ")"}]}]}], "\[IndentingNewLine]",
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"measure", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"measure", ",", "emptyElements"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"refine", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"refine", ",", "emptyElements"}], "]"}]}], ";", "\n", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"recursionDepth", "\[Equal]", "1"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"measure", "\[Equal]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"filteringResults", "[", "testID", "]"}], "=", 
              RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"measure", "\[Equal]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
             "Nothing"}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\n", "\[IndentingNewLine]", 
         RowBox[{"windows", "=", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"recursionDepth", "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", "initialWindows", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"operatorMap", "[", 
             RowBox[{
             "interrogationWindow", ",", "recycle", ",", "1", ",", 
              "Nothing"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"windows", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"windows", ",", "emptyElements"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"extendedWindows", "=", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"recursionDepth", "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", "initialExtendedWindows", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"operatorMap", "[", 
             RowBox[{
             "virtualWindow", ",", "recycle", ",", "1", ",", "Nothing"}], 
             "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"extendedWindows", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"extendedWindows", ",", "emptyElements"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\n", 
         RowBox[{"newCentroids", "=", 
          RowBox[{"getMetric", "[", 
           RowBox[{"measure", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newArea", "=", 
          RowBox[{"getMetric", "[", 
           RowBox[{"measure", ",", "5"}], "]"}]}], ";", "\n", 
         "\[IndentingNewLine]", 
         RowBox[{"distributeWindows", "=", 
          RowBox[{"distributeElements", "[", 
           RowBox[{"windows", ",", "newCentroids"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"distributeExtendedWindows", "=", 
          RowBox[{"distributeElements", "[", 
           RowBox[{"extendedWindows", ",", "newCentroids"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"distributeRegions", "=", 
          RowBox[{"distributeElements", "[", 
           RowBox[{"refine", ",", "newCentroids"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"windowArea", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Times", "@@", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "@", "#"}], "-", 
                 RowBox[{"First", "@", "#"}]}], "&"}], "/@", 
               RowBox[{"distributeWindows", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", 
              ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "@", "distributeWindows"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"mergedNewCentroids", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"newCentroids", ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", "\n", 
         "\[IndentingNewLine]", 
         RowBox[{"windowShift", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Mean", "/@", 
              RowBox[{"distributeWindows", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
            RowBox[{"Range", "@", 
             RowBox[{"Length", "@", "mergedNewCentroids"}]}]}], "//", "N"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"windowOffCenter", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Subtract", "@@", 
             RowBox[{"distributeWindows", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
           RowBox[{"Range", "@", 
            RowBox[{"Length", "@", "mergedNewCentroids"}]}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"windowSizeCorrection", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "/", "2"}], "&"}], "@", 
               RowBox[{"ImageDimensions", "@", 
                RowBox[{"distributeRegions", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}]}], "//", "N"}], "//", 
             "Mean"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "@", "mergedNewCentroids"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"cropCorrection", "=", 
          RowBox[{"conditionalCropCorrection", "/@", "extendedWindows"}]}], 
         ";", "\[IndentingNewLine]", "\n", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"virtualSize", "=", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "@", "#"}], "-", 
                 RowBox[{"First", "@", "#"}]}], "&"}], "/@", 
               RowBox[{"distributeExtendedWindows", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", 
                RowBox[{"Length", "@", "distributeWindows"}]}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"cropCorrection", "=", 
            RowBox[{"Transpose", "@", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{"cropVector", "*", 
               RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
                RowBox[{"virtualSize", "-", 
                 RowBox[{"ImageDimensions", "/@", "distributeRegions"}]}], 
                "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
              ")"}]}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
         "\[IndentingNewLine]", "\n", 
         RowBox[{"mappedCentroids", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"VectorQ", "@", 
                RowBox[{"mergedNewCentroids", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], "\[Equal]", "True"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"mergedNewCentroids", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "\[IndentingNewLine]", "-", 
               RowBox[{"windowOffCenter", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "\[IndentingNewLine]", "-", 
               RowBox[{"windowSizeCorrection", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "\[IndentingNewLine]", "+", 
               RowBox[{"cropCorrection", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "\[IndentingNewLine]", "+", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"First", "@", 
                  RowBox[{"windowShift", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"heightPixels", "-", 
                  RowBox[{"Last", "@", 
                   RowBox[{"windowShift", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}]}]}], 
                "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
           RowBox[{"Range", "@", 
            RowBox[{"Length", "@", "mergedNewCentroids"}]}]}]}], ";", "\n", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"cycleParameters", "=", 
          RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2", ",", "#3"}], "}"}], "&"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"mappedCentroids", ",", "\[IndentingNewLine]", 
              RowBox[{"Flatten", "@", "newArea"}], ",", "\[IndentingNewLine]",
               "windowArea"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"newInterrogationScales", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"interrogationScaleFactor", "*", 
              RowBox[{"N", "@", 
               RowBox[{"Sqrt", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"cycleParameters", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", "2"}], "]"}], "]"}], "/", "\[Pi]"}], 
                "\[IndentingNewLine]", "]"}]}]}], "//", "Round"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "@", "cycleParameters"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\n", 
         RowBox[{"newWindows", "=", 
          RowBox[{"checkNewWindows", "[", 
           RowBox[{
           "cycleParameters", ",", "newInterrogationScales", ",", 
            "widthPixels", ",", "heightPixels"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"newExtendedWindows", "=", 
          RowBox[{"checkExtendedWindows", "[", 
           RowBox[{
           "cycleParameters", ",", "newInterrogationScales", ",", 
            "heightPixels"}], "]"}]}], ";", "\n", "\[IndentingNewLine]", "\n",
          "\[IndentingNewLine]", 
         RowBox[{"newWindowArea", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Times", "@@", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "@", "#"}], "-", 
                 RowBox[{"First", "@", "#"}]}], "&"}], "/@", 
               RowBox[{"newExtendedWindows", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", 
              ")"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "@", "newExtendedWindows"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"convergenceMap", "=", 
          RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#1", "/", "#2"}], ">", "criticalAreaRatio"}], "&"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"windowArea", ",", "newWindowArea"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\n", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"recycle", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"converged", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"measure", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", "measure"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"convergenceMap", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "False"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"convergedWindows", "[", "testID", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"distributeWindows", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "Nothing"}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
          RowBox[{"Range", "@", 
           RowBox[{"Length", "@", "convergenceMap"}]}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"convergenceMap", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "False"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"convergedRegions", "[", "testID", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"distributeRegions", "[", 
                RowBox[{"[", "#", "]"}], "]"}]}], "\[IndentingNewLine]", 
              "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "Nothing"}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
          RowBox[{"Range", "@", 
           RowBox[{"Length", "@", "convergenceMap"}]}]}], ";", 
         "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"convergenceMap", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "False"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
              RowBox[{
              "converged", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"measure", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
                  RowBox[{"mappedCentroids", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
             ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
              RowBox[{
              "recycle", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"measure", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "\[Rule]", 
                   RowBox[{"mappedCentroids", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}]}], "\[IndentingNewLine]",
                  "]"}], "\[IndentingNewLine]", "}"}]}], 
              "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "&"}], "/@", 
          RowBox[{"Range", "@", 
           RowBox[{"Length", "@", "convergenceMap"}]}]}], ";", 
         "\[IndentingNewLine]", "\n", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"cyclingResults", ",", "converged"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"recursionDepth", "++"}], ";"}]}], "\[IndentingNewLine]", 
       "\n", "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MRIFoutput", "[", "testID", "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", "#", "}"}], "&"}], "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}]}], "&"}], "@", "cyclingResults"}]}],
       ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8089984194371147`*^9, 3.8089984776854305`*^9}, {
   3.808998553223565*^9, 3.808998599903944*^9}, {3.808998631461812*^9, 
   3.808998639242032*^9}, {3.808998769239438*^9, 3.8089988781400824`*^9}, {
   3.808998916996219*^9, 3.808998954423312*^9}, {3.8089998147183976`*^9, 
   3.808999814849045*^9}, {3.8089998992168055`*^9, 3.808999899343399*^9}, {
   3.8089999447348156`*^9, 3.8089999461001635`*^9}, {3.80900007008062*^9, 
   3.8090000844380813`*^9}, {3.8090007559464836`*^9, 
   3.8090007562007413`*^9}, {3.809001495807765*^9, 3.809001501476224*^9}, {
   3.809001707293538*^9, 3.809001707548786*^9}, 3.809001989049052*^9, {
   3.809009007258585*^9, 3.809009047251131*^9}, {3.809009331865568*^9, 
   3.8090093626496105`*^9}, {3.8090094394514327`*^9, 
   3.8090094427517204`*^9}, {3.8090126199077168`*^9, 
   3.8090126210912657`*^9}, {3.8090126536827464`*^9, 
   3.8090126786562204`*^9}, {3.809012945715828*^9, 3.8090129555916147`*^9}, {
   3.809012987329282*^9, 3.8090129914075623`*^9}, {3.809013976885397*^9, 
   3.809013978899934*^9}, 3.809014010205742*^9, {3.809060563472237*^9, 
   3.809060567506426*^9}, {3.8090606023514276`*^9, 3.8090606073984084`*^9}, {
   3.809060692780363*^9, 3.809060700188509*^9}, {3.8090607463830175`*^9, 
   3.809060783284913*^9}, {3.809060855295303*^9, 3.809060856494091*^9}, {
   3.8090652797711105`*^9, 3.8090653070576134`*^9}, {3.8090654142954674`*^9, 
   3.8090655020687027`*^9}, {3.80906555002662*^9, 3.8090656093124065`*^9}, {
   3.809065653017003*^9, 3.809065678647474*^9}, {3.8090657282112083`*^9, 
   3.809065729687254*^9}, {3.809066261533866*^9, 3.809066273333256*^9}, {
   3.809066422934188*^9, 3.809066434466057*^9}, {3.8090664778912716`*^9, 
   3.8090665719164276`*^9}, {3.8090666176310997`*^9, 
   3.8090666197075353`*^9}, {3.809066655759386*^9, 3.8090666910836926`*^9}, {
   3.809067182009616*^9, 3.809067214257933*^9}, {3.809067534026492*^9, 
   3.8090675618880973`*^9}, 3.809067631865527*^9, {3.8090677613795557`*^9, 
   3.809067767495047*^9}, {3.8090733200430355`*^9, 3.809073320773125*^9}, {
   3.809073426651166*^9, 3.8090734277706633`*^9}, {3.809073649157578*^9, 
   3.809073722506219*^9}, {3.8090739523871913`*^9, 3.8090740127719316`*^9}, {
   3.809074075016118*^9, 3.80907407638472*^9}, {3.8090741377097883`*^9, 
   3.8090742016730137`*^9}, {3.8090778378090477`*^9, 3.809077871142585*^9}, {
   3.809077976957873*^9, 3.809078017536946*^9}, {3.809085504857726*^9, 
   3.809085528688612*^9}, {3.809085567943515*^9, 3.809085579680096*^9}, {
   3.809085702592935*^9, 3.8090857065442877`*^9}, {3.8090875868295097`*^9, 
   3.8090876061748915`*^9}, {3.80908848880403*^9, 3.8090885055022483`*^9}, {
   3.8090885813838453`*^9, 3.8090885925249305`*^9}, {3.8090886512238264`*^9, 
   3.8090886634981017`*^9}, {3.809088794873055*^9, 3.8090887961666775`*^9}, {
   3.809088826911332*^9, 3.809088886630512*^9}, {3.8090890291193995`*^9, 
   3.809089042510776*^9}, {3.8090902245066767`*^9, 3.809090285349052*^9}, {
   3.809092685921769*^9, 3.809092707048544*^9}, {3.809092737637974*^9, 
   3.8090927514579277`*^9}, 3.8090927850295324`*^9, {3.809092843005021*^9, 
   3.8090928573194704`*^9}, {3.809204783283434*^9, 3.8092047929190493`*^9}},
 CellLabel->
  "In[1034]:=",ExpressionUUID->"dfc1ae93-77e0-4b26-b6ce-adfbcfd9e9dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preview Global Filter Output", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.8077950418489313`*^9, 3.807795048833222*^9}, {3.8080396828366003`*^9, 
  3.808039714652876*^9}, {3.8089174228965707`*^9, 3.808917455924672*^9}, {
  3.8089174870251846`*^9, 3.808917507433693*^9}, {3.808917555256274*^9, 
  3.8089175622333713`*^9}, {3.808925256883334*^9, 3.808925269178713*^9}, {
  3.8090674839969068`*^9, 3.8090674850600586`*^9}, {3.8090765572821975`*^9, 
  3.8090765758330784`*^9}},ExpressionUUID->"bb0ffe00-ded1-43eb-af55-\
196c62a1a892"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "647"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"images", "[", 
       RowBox[{"[", "testID", "]"}], "]"}], "//", "Colorize"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"correctedImages", "[", 
       RowBox[{"[", "testID", "]"}], "]"}], "//", "Colorize"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"shapes", "[", 
      RowBox[{"[", "testID", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Dividers", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.808740240372076*^9, 3.808740257799009*^9}, {
   3.8087403720394526`*^9, 3.808740402078499*^9}, {3.808740508774948*^9, 
   3.808740535912684*^9}, {3.808811361802149*^9, 3.8088113767675486`*^9}, {
   3.8088400207613344`*^9, 3.8088400215582*^9}, {3.8088425358751817`*^9, 
   3.808842535985887*^9}, {3.808918095754788*^9, 3.808918096070942*^9}, {
   3.808922776837878*^9, 3.808922776931627*^9}, {3.808924305103036*^9, 
   3.808924306468593*^9}, {3.809001692221118*^9, 3.809001693533601*^9}, {
   3.8090133250855503`*^9, 3.809013325222187*^9}, {3.809013791503976*^9, 
   3.8090137924035673`*^9}, {3.809013876467841*^9, 3.809013876843834*^9}, {
   3.8090141097223186`*^9, 3.809014110659808*^9}, {3.8090142959129124`*^9, 
   3.809014296146288*^9}, {3.8090676888514776`*^9, 3.809067689356126*^9}, 
   3.8090677256901226`*^9, {3.809067905713434*^9, 3.8090679057803173`*^9}, {
   3.809068062664859*^9, 3.8090680627855997`*^9}, {3.8090682774322925`*^9, 
   3.8090682775629416`*^9}, {3.809068773109763*^9, 3.8090687732453985`*^9}, {
   3.809068831510726*^9, 3.809068831661322*^9}, 3.8090704988906794`*^9, {
   3.809070534364822*^9, 3.809070534538357*^9}, {3.809072318636161*^9, 
   3.8090723189091616`*^9}, {3.809072764291149*^9, 3.8090727646098146`*^9}, {
   3.809072884449435*^9, 3.8090728845332108`*^9}, {3.809073266839674*^9, 
   3.8090732672081003`*^9}, 3.809076580210354*^9, {3.8090785309719357`*^9, 
   3.8090785311295123`*^9}, {3.809087802661481*^9, 3.8090878029960566`*^9}, {
   3.8091653124528666`*^9, 3.809165312616763*^9}, {3.809165358046788*^9, 
   3.8091653585049934`*^9}, {3.809193419227124*^9, 3.809193474571453*^9}, {
   3.8091937244086394`*^9, 3.8091937245252576`*^9}, {3.809193769481366*^9, 
   3.809193769642934*^9}, {3.809194966114093*^9, 3.8091949662597866`*^9}, {
   3.809199398137119*^9, 3.809199398222888*^9}, {3.8092047411686926`*^9, 
   3.809204741528657*^9}},
 CellLabel->
  "In[1029]:=",ExpressionUUID->"f9aa589e-ed54-427a-a44f-42a0cbd7d871"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Apply MRIF To The Image Sequence", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.8077950418489313`*^9, 3.807795048833222*^9}, {3.8080396828366003`*^9, 
  3.808039714652876*^9}, {3.8089174228965707`*^9, 3.808917455924672*^9}, {
  3.8089174870251846`*^9, 3.808917507433693*^9}, {3.808917555256274*^9, 
  3.8089175622333713`*^9}, {3.808925256883334*^9, 3.808925269178713*^9}, {
  3.8090674839969068`*^9, 3.8090674850600586`*^9}, {3.8090765572821975`*^9, 
  3.8090765758330784`*^9}, {3.809076624913684*^9, 
  3.8090766381532965`*^9}},ExpressionUUID->"1761a9ad-ae22-4eb5-a40f-\
1a28984dd337"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"interrogationScaleFactor", "=", "2.5"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"criticalAreaRatio", "=", "2"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.809076656028805*^9, 3.809076708538143*^9}, {
   3.8090767826029296`*^9, 3.80907683959188*^9}, {3.8090773042426653`*^9, 
   3.80907730678386*^9}, {3.8090780236332808`*^9, 3.8090780518815985`*^9}, {
   3.809078357991787*^9, 3.809078362125511*^9}, 3.8090785027446156`*^9, {
   3.809085939571768*^9, 3.8090859489478564`*^9}, {3.809087818915039*^9, 
   3.8090878230675526`*^9}, {3.8090879846637793`*^9, 
   3.8090879847385755`*^9}, {3.8090900268862505`*^9, 
   3.8090900355380287`*^9}, {3.809097798338312*^9, 3.8090978056596966`*^9}, {
   3.8091119930078382`*^9, 3.809112011356638*^9}, {3.8091653720290976`*^9, 
   3.809165373776958*^9}, {3.80916542559312*^9, 3.8091654273208256`*^9}, {
   3.809165463824292*^9, 3.8091654648489637`*^9}, {3.809165502024572*^9, 
   3.809165507112508*^9}, {3.8091687560488515`*^9, 3.809168770297459*^9}, {
   3.809168839873397*^9, 3.8091688400419474`*^9}, {3.8091689065454164`*^9, 
   3.8091689070011606`*^9}, {3.8091689701256514`*^9, 
   3.8091689851212587`*^9}, {3.809169233958744*^9, 3.8091692344404545`*^9}, {
   3.809169271881236*^9, 3.8091693230793734`*^9}, {3.8091697552131367`*^9, 
   3.8091697562931805`*^9}, {3.8091698729259243`*^9, 
   3.8091698738205304`*^9}, {3.8091704042533255`*^9, 3.809170404356048*^9}, {
   3.809193058237842*^9, 3.809193089508207*^9}},
 CellLabel->
  "In[1040]:=",ExpressionUUID->"26c30288-3801-4c33-9bf3-ee3de75e6ba8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Speak", "@", "\"\<Performing Multiscale Filtering\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"MRIF", "[", 
         RowBox[{"m", ",", "criticalAreaRatio"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", 
         RowBox[{"Length", "@", "extract"}]}], "}"}]}], "\[IndentingNewLine]",
       "]"}], ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "extract"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Speak", "@", "\"\<Multiscale Filtering Complete\>\""}]}], "Input",
 CellChangeTimes->{{3.809076656028805*^9, 3.809076708538143*^9}, {
   3.8090767826029296`*^9, 3.80907683959188*^9}, {3.8090773042426653`*^9, 
   3.80907730678386*^9}, {3.8090780236332808`*^9, 3.8090780518815985`*^9}, {
   3.809078357991787*^9, 3.809078362125511*^9}, 3.8090785027446156`*^9, {
   3.809085939571768*^9, 3.8090859489478564`*^9}, {3.809087818915039*^9, 
   3.8090878230675526`*^9}, {3.8090879846637793`*^9, 
   3.8090879847385755`*^9}, {3.8090900268862505`*^9, 
   3.8090900355380287`*^9}, {3.809097798338312*^9, 3.8090978056596966`*^9}, {
   3.8091119930078382`*^9, 3.809112011356638*^9}, {3.8091653720290976`*^9, 
   3.809165373776958*^9}, {3.80916542559312*^9, 3.8091654273208256`*^9}, {
   3.809165463824292*^9, 3.8091654648489637`*^9}, {3.809165502024572*^9, 
   3.809165507112508*^9}, {3.8091687560488515`*^9, 3.809168770297459*^9}, {
   3.809168839873397*^9, 3.8091688400419474`*^9}, {3.8091689065454164`*^9, 
   3.8091689070011606`*^9}, {3.8091689701256514`*^9, 
   3.8091689851212587`*^9}, {3.809169233958744*^9, 3.8091692344404545`*^9}, {
   3.809169271881236*^9, 3.8091692787927976`*^9}, {3.8091704584573374`*^9, 
   3.809170459284191*^9}},
 CellLabel->
  "In[1042]:=",ExpressionUUID->"d859eb99-abcd-4b60-85c6-f4417775207a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Overlays For MRIF Detections", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.760170896953659*^9, 3.7601709031790094`*^9}, {3.8077952028241186`*^9, 
  3.8077952084087553`*^9}, {3.808138048434164*^9, 3.80813807006663*^9}, {
  3.808154094990706*^9, 3.8081540960935917`*^9}, {3.808301589967221*^9, 
  3.8083015981821637`*^9}, {3.808308119971815*^9, 3.8083081206988654`*^9}, {
  3.809011110831708*^9, 3.8090111265757337`*^9}, {3.809073092961156*^9, 
  3.809073100681066*^9}},ExpressionUUID->"41d4df71-8b25-4f6d-82cc-\
8ba6d7d60222"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getCoordinates", "[", 
    RowBox[{"dataset_", ",", "imageID_", ",", "objectID_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dataset", "[", 
       RowBox[{"[", 
        RowBox[{"imageID", ",", "objectID"}], "]"}], "]"}], ",", "2"}], 
     "\[IndentingNewLine]", "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replacementTemplate", "[", "element_", "]"}], ":=", 
   RowBox[{"element", "\[Rule]", 
    RowBox[{"{", "}"}]}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eliminationRules", "[", "positions_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"#", "\[NotEqual]", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"replacementTemplate", "/@", "#"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
     "positions"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eliminateEntries", "[", 
   RowBox[{"dataset_", ",", "positions_"}], "]"}], ":=", 
  RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
   RowBox[{"dataset", ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "@", 
     RowBox[{"eliminationRules", "@", "positions"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.808205237304002*^9, 3.808205239000454*^9}, {
   3.8082063246235237`*^9, 3.80820632517305*^9}, {3.8090706309457097`*^9, 
   3.8090706461984773`*^9}, {3.8090706961619635`*^9, 3.8090706984707212`*^9}, 
   3.8090711125918217`*^9, 3.8090904139339476`*^9},
 CellLabel->
  "In[1046]:=",ExpressionUUID->"35c9c40b-9bde-4e88-8bd1-7b7a334882c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"detectedBubbles", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"MRIFoutput", "[", "#", "]"}], "&"}], "/@", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "extract"}]}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trueCentroids", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorScan", "[", 
        RowBox[{"getCoordinates", ",", "detectedBubbles", ",", "k"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "detectedBubbles"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "Quiet"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cleanCentroids", "=", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eliminateEntries", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"trueCentroids", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Position", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"VectorQ", "/@", 
            RowBox[{"trueCentroids", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "\[Equal]", "False"}], "&"}], ")"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "trueCentroids"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], "/.", 
     RowBox[{
      RowBox[{"{", "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"blackCanvas", "=", 
    RowBox[{"Binarize", "[", 
     RowBox[{
      RowBox[{"images", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newShapes", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"detectedBubbles", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "#"}], "]"}], "]"}]}], "!=", "0"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"detectedBubbles", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "#"}], "]"}], "]"}], ",", "2"}], 
            "\[IndentingNewLine]", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Image", "@", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "]"}], "&"}], "/@", 
       RowBox[{"Range", "@", 
        RowBox[{"Length", "@", 
         RowBox[{"detectedBubbles", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "detectedBubbles"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"shapeOverlay", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ImageCompose", "[", "\[IndentingNewLine]", 
        RowBox[{"blackCanvas", ",", "\[IndentingNewLine]", 
         RowBox[{"newShapes", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"cleanCentroids", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "cleanCentroids"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "Quiet"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"emptyFrames", "=", 
    RowBox[{"Position", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImageQ", "/@", "shapeOverlay"}], ",", "\[IndentingNewLine]", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "\[Equal]", "False"}], "&"}], ")"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"shapeMasks", "=", 
   RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
    RowBox[{"shapeOverlay", ",", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "@", 
      RowBox[{"eliminationRules", "@", "emptyFrames"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.8090003070417004`*^9, 3.8090003086778793`*^9}, {
  3.8090003630826*^9, 3.809000397235771*^9}, {3.809000815388627*^9, 
  3.8090008538270197`*^9}, {3.809002128079463*^9, 3.809002130943778*^9}, {
  3.8090122438359556`*^9, 3.8090122457462263`*^9}, {3.809067839149581*^9, 
  3.8090678402296867`*^9}, {3.809075026292802*^9, 3.8090750636402063`*^9}, {
  3.809076878932242*^9, 3.809076879714216*^9}, {3.809077381398667*^9, 
  3.809077381616084*^9}, {3.809084660289987*^9, 3.8090846617919655`*^9}, {
  3.8090849670717735`*^9, 3.809084973415385*^9}, {3.8090859670211315`*^9, 
  3.8090859824283223`*^9}, {3.809086078492503*^9, 3.8090860786032095`*^9}, {
  3.809087873492613*^9, 3.8090878736196585`*^9}, {3.8090984090540237`*^9, 
  3.809098426917758*^9}, {3.8091120398266954`*^9, 3.8091120450257726`*^9}, {
  3.809207502340513*^9, 3.8092075220592265`*^9}},
 CellLabel->
  "In[1123]:=",ExpressionUUID->"1a81dab7-4a2b-4eb9-ae1d-e6031f46615f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preview MRIF Detection Overlays", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.760170896953659*^9, 3.7601709031790094`*^9}, {3.8077952028241186`*^9, 
  3.8077952084087553`*^9}, {3.808138048434164*^9, 3.80813807006663*^9}, {
  3.808154094990706*^9, 3.8081540960935917`*^9}, {3.808301589967221*^9, 
  3.8083015981821637`*^9}, {3.808308119971815*^9, 3.8083081206988654`*^9}, {
  3.809011110831708*^9, 3.8090111265757337`*^9}, {3.809073092961156*^9, 
  3.809073100681066*^9}, {3.8090750823430614`*^9, 
  3.80907508902389*^9}},ExpressionUUID->"264210da-1b9a-4180-90a2-\
b43edd8750d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"centroidMarkerSize", "=", "0.025"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"viewDetectedBubbles", "[", "imageID_", "]"}], ":=", 
  RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"images", "[", 
       RowBox[{"[", "imageID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"shapeMasks", "[", 
         RowBox[{"[", "imageID", "]"}], "]"}], ",", "White"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"cleanCentroids", "[", 
       RowBox[{"[", "imageID", "]"}], "]"}], ",", "Orange", ",", 
      RowBox[{"PointSize", "@", "centroidMarkerSize"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8083115477008753`*^9, 3.8083115709272957`*^9}, {
  3.8083144529532146`*^9, 3.8083145044958086`*^9}},
 CellLabel->
  "In[1131]:=",ExpressionUUID->"72105171-acb6-42ee-b30e-0ca436786f21"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testID", "=", "257"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "HighlightImage", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Style", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"getMetric", "[", 
           RowBox[{
            RowBox[{"MRIFoutput", "[", "testID", "]"}], ",", "3"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"PointSize", "@", "0.025"}], ",", "Red"}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"images", ",", "correctedImages", ",", "shapes"}], "}"}]}], ",",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Dividers", "\[Rule]", "All"}]}], "\[IndentingNewLine]", "]"}], 
  "\n", "\[IndentingNewLine]", "\n"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HighlightImage", "[", 
        RowBox[{
         RowBox[{"shapes", "[", 
          RowBox[{"[", "testID", "]"}], "]"}], ",", "blackCanvas"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"HighlightImage", "[", 
        RowBox[{
         RowBox[{"shapeMasks", "[", 
          RowBox[{"[", "testID", "]"}], "]"}], ",", "blackCanvas"}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"correctedImages", "[", 
           RowBox[{"[", "testID", "]"}], "]"}], "//", "Colorize"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"shapeMasks", "[", 
            RowBox[{"[", "testID", "]"}], "]"}], ",", "White"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
       "HighlightImage", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"images", "[", 
             RowBox[{"[", "testID", "]"}], "]"}], "//", "Colorize"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"shapeMasks", "[", 
              RowBox[{"[", "testID", "]"}], "]"}], ",", "White"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"cleanCentroids", "[", 
            RowBox[{"[", "testID", "]"}], "]"}], ",", "Blue", ",", 
           RowBox[{"PointSize", "@", "centroidMarkerSize"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"Dividers", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8090003070417004`*^9, 3.8090003086778793`*^9}, {
   3.8090003630826*^9, 3.809000397235771*^9}, {3.809000815388627*^9, 
   3.8090008538270197`*^9}, {3.809002128079463*^9, 3.809002130943778*^9}, {
   3.8090122438359556`*^9, 3.8090122457462263`*^9}, {3.809067839149581*^9, 
   3.8090678402296867`*^9}, {3.809075026292802*^9, 3.8090750636402063`*^9}, {
   3.809075099264582*^9, 3.8090751359297876`*^9}, {3.8090768856732607`*^9, 
   3.809076907489775*^9}, 3.8090769883595066`*^9, {3.8090773874945183`*^9, 
   3.809077450583783*^9}, 3.8090774807694135`*^9, {3.8090775541589823`*^9, 
   3.809077568648303*^9}, {3.8090776109561214`*^9, 3.80907761115858*^9}, {
   3.80907764259851*^9, 3.809077642830888*^9}, {3.8090776978942614`*^9, 
   3.8090776979969196`*^9}, {3.8090777985674267`*^9, 
   3.8090777986791267`*^9}, {3.809078405586925*^9, 3.8090784056786633`*^9}, {
   3.809078557426557*^9, 3.8090785575133247`*^9}, 3.8090851449518833`*^9, {
   3.8090860965779204`*^9, 3.8090860987056513`*^9}, {3.809086189991929*^9, 
   3.8090861900976477`*^9}, {3.8090863082336693`*^9, 3.809086308338456*^9}, {
   3.8090864645530787`*^9, 3.8090864655544643`*^9}, {3.809087910883557*^9, 
   3.8090879120127945`*^9}, {3.809088065820784*^9, 3.8090880658858128`*^9}, {
   3.8090893212430086`*^9, 3.8090893387056284`*^9}, {3.8090978614773655`*^9, 
   3.8090978636146383`*^9}, {3.80917094396349*^9, 3.8091709441440077`*^9}, {
   3.809179855743473*^9, 3.809179861883097*^9}, {3.80920499096811*^9, 
   3.809204994249234*^9}},
 CellLabel->
  "In[1133]:=",ExpressionUUID->"53dcc669-ecc2-4a9c-a11d-f9ebe8658a65"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Intensity Filtering", "Section",
 CellChangeTimes->{{3.7520000744520516`*^9, 3.7520000907368383`*^9}, {
  3.760102301287171*^9, 3.7601023044955907`*^9}, {3.7603464479672546`*^9, 
  3.760346498717848*^9}, {3.8080396673402624`*^9, 3.8080396712367544`*^9}, {
  3.808055032736223*^9, 
  3.8080550361185837`*^9}},ExpressionUUID->"74bfa0ca-5143-45f7-bc3f-\
0badd313be74"],

Cell[CellGroupData[{

Cell["Compute Intensity Maps", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.760170896953659*^9, 3.7601709031790094`*^9}, {3.8077952028241186`*^9, 
  3.8077952084087553`*^9}, {3.808138048434164*^9, 3.80813807006663*^9}, {
  3.808154094990706*^9, 3.8081540960935917`*^9}, {3.808301589967221*^9, 
  3.8083015981821637`*^9}, {3.808308119971815*^9, 3.8083081206988654`*^9}, {
  3.8090904687815285`*^9, 
  3.809090477405076*^9}},ExpressionUUID->"95b43ea5-4164-42cd-95e6-\
455771216ad6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"isolateObjects", "[", 
    RowBox[{"testID_", ",", "bubbleID_"}], "]"}], ":=", 
   RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ImageAdjust", "@", 
        RowBox[{"ImageMultiply", "[", "\[IndentingNewLine]", 
         RowBox[{"#", ",", 
          RowBox[{"#", "-", 
           RowBox[{"ColorNegate", "@", 
            RowBox[{"ColorToneMapping", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", "luminanceCompression", ",", 
              RowBox[{"Method", "\[Rule]", "\"\<Luminance\>\""}]}], 
             "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
         "]"}]}], "&"}], "@", 
      RowBox[{"ImageTake", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"correctedImages", "[", 
         RowBox[{"[", "testID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"First", "@", 
         RowBox[{
          RowBox[{"convergedWindows", "[", "testID", "]"}], "[", 
          RowBox[{"[", "bubbleID", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Last", "@", 
         RowBox[{
          RowBox[{"convergedWindows", "[", "testID", "]"}], "[", 
          RowBox[{"[", "bubbleID", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"convergedRegions", "[", "testID", "]"}], "[", 
      RowBox[{"[", "bubbleID", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getIntensityStats", "[", 
    RowBox[{"testID_", ",", "bubbleID_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ComponentMeasurements", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"isolateObjects", "[", 
       RowBox[{"testID", ",", "bubbleID"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "\"\<MaskedImage\>\"", ",", "\"\<MeanIntensity\>\"", ",", 
        "\"\<MaxIntensity\>\""}], "}"}]}], "\[IndentingNewLine]", "]"}], "/.", 
    RowBox[{"Rule", "\[Rule]", "List"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8069656593313475`*^9, 3.806965670581217*^9}, {
   3.806965994182662*^9, 3.8069659999392457`*^9}, {3.8069666219401045`*^9, 
   3.8069666258416595`*^9}, {3.806970605342121*^9, 3.8069706128595085`*^9}, {
   3.8069760907276735`*^9, 3.8069761993046703`*^9}, {3.8069762539843516`*^9, 
   3.806976280853958*^9}, {3.8069763116734886`*^9, 3.8069763457199*^9}, {
   3.8069763901210847`*^9, 3.8069764192142367`*^9}, {3.8069764796574965`*^9, 
   3.8069764814538774`*^9}, {3.806976538433509*^9, 3.806976564717194*^9}, {
   3.8069766815525665`*^9, 3.8069767112569637`*^9}, {3.806976756835004*^9, 
   3.8069767717969694`*^9}, {3.806976847000535*^9, 3.80697696758875*^9}, {
   3.806977014696348*^9, 3.806977015356769*^9}, {3.8069770576234827`*^9, 
   3.8069770577242107`*^9}, {3.8069771051508136`*^9, 
   3.8069771298008957`*^9}, {3.807008363186562*^9, 3.807008384876341*^9}, 
   3.8070084646716614`*^9, 3.8070084981502542`*^9, {3.807008574718361*^9, 
   3.8070085762031994`*^9}, {3.807008665374261*^9, 3.807008691198402*^9}, {
   3.807349444964739*^9, 3.807349488250961*^9}, {3.8073508989527855`*^9, 
   3.8073509088320937`*^9}, {3.8073509745706825`*^9, 
   3.8073510222726736`*^9}, {3.807879808447649*^9, 3.807879812621459*^9}, {
   3.807879918224051*^9, 3.807879934068734*^9}, {3.8079405000972176`*^9, 
   3.807940501287032*^9}, {3.8079782169215975`*^9, 3.8079782852879004`*^9}, {
   3.8079783582751245`*^9, 3.8079783610717726`*^9}, {3.8079785433521347`*^9, 
   3.807978543413969*^9}, {3.8080295816264977`*^9, 3.8080295892554665`*^9}, {
   3.808029639411191*^9, 3.808029652777294*^9}, {3.8080333705361514`*^9, 
   3.808033371708024*^9}, {3.8080347010505714`*^9, 3.80803470149139*^9}, {
   3.808137721116613*^9, 3.808137721631237*^9}, {3.8086672976622343`*^9, 
   3.808667298666546*^9}, 3.809097954174224*^9},
 CellLabel->
  "In[1136]:=",ExpressionUUID->"e3c6f3b5-fd1c-41ff-a424-447d7ff12a6f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"formattedBubbles", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"First", "/@", 
       RowBox[{"detectedBubbles", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "detectedBubbles"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Speak", "@", "\"\<Analysing object intensity profiles\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorCounter", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"intensityStats", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"monitorCounter", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"getIntensityStats", "[", 
            RowBox[{"k", ",", "#"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "@", 
           RowBox[{"Length", "@", 
            RowBox[{"formattedBubbles", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "@", "formattedBubbles"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
    RowBox[{"progress", "[", 
     RowBox[{"monitorCounter", ",", 
      RowBox[{"Length", "@", "formattedBubbles"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Speak", "@", "\"\<Object analysis complete\>\""}]}], "Input",
 CellChangeTimes->{{3.807634873428629*^9, 3.807634932213435*^9}, {
   3.8076990536018066`*^9, 3.8076990546796722`*^9}, {3.8077052261534443`*^9, 
   3.8077052432163773`*^9}, {3.8077053424856987`*^9, 
   3.8077053563207817`*^9}, {3.8077054903912735`*^9, 3.807705497732149*^9}, {
   3.8077057572439184`*^9, 3.8077057576478367`*^9}, {3.807705854529172*^9, 
   3.807705863383463*^9}, {3.8077060126076803`*^9, 3.807706053287154*^9}, {
   3.8077061383519144`*^9, 3.8077061515022163`*^9}, {3.807706303694373*^9, 
   3.807706310880992*^9}, 3.8078801451668*^9, {3.80797823992159*^9, 
   3.807978240495132*^9}, {3.8080286748742027`*^9, 3.8080286938741736`*^9}, {
   3.8080288096114025`*^9, 3.8080288322487373`*^9}, {3.8080294849292803`*^9, 
   3.8080294856503487`*^9}, {3.808029599066333*^9, 3.808029603007448*^9}, {
   3.80802975618526*^9, 3.808029763575952*^9}, {3.808030430303494*^9, 
   3.8080304467881827`*^9}, {3.808032313246808*^9, 3.8080323428870697`*^9}, {
   3.8080325582704535`*^9, 3.8080325601878166`*^9}, {3.809097925428116*^9, 
   3.8090979459916296`*^9}, {3.809098449429433*^9, 3.809098471147522*^9}, {
   3.8090985654691105`*^9, 3.8090985799563684`*^9}},
 CellLabel->
  "In[1138]:=",ExpressionUUID->"58c9947e-8e0b-42d5-9524-e17535ec7f26"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Apply The Intensity Filter", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170807076165*^9}, {
  3.760353612711093*^9, 3.7603536153939342`*^9}, {3.760887234335846*^9, 
  3.7608872387609673`*^9}, {3.76088728531983*^9, 3.7608872861286664`*^9}, {
  3.808038103093626*^9, 3.8080381150860806`*^9}, {3.8081371017677035`*^9, 
  3.8081371072958655`*^9}},ExpressionUUID->"b1f5d2bd-0a97-4bcc-af4b-\
a76dec3b51f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"objectLikelyhoods", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Times", "@@", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"3", ";;", "4"}], "]"}], "]"}]}], "&"}], "/@", 
        RowBox[{"Flatten", "/@", 
         RowBox[{"intensityStats", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "intensityStats"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "Quiet"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Histogram", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Flatten", "@", "objectLikelyhoods"}], ",", "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"Automatic", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "Automatic"}], "}"}]}], "\[IndentingNewLine]", 
     "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.808029935557843*^9, 3.808029972820182*^9}, {
   3.8080300200918775`*^9, 3.808030083579276*^9}, {3.808030235629532*^9, 
   3.80803025152705*^9}, {3.8080302863636026`*^9, 3.8080302963715563`*^9}, {
   3.8080303604584217`*^9, 3.8080303645948296`*^9}, {3.8080305164190273`*^9, 
   3.8080305528173847`*^9}, 3.8080324869869537`*^9, {3.808032957966191*^9, 
   3.8080329607367177`*^9}, {3.808034562727049*^9, 3.808034569803249*^9}, {
   3.8080346049591084`*^9, 3.808034608550014*^9}, {3.8080395895747843`*^9, 
   3.8080395912223177`*^9}, 3.8080396442297144`*^9, {3.808723329634039*^9, 
   3.80872334424561*^9}, {3.809098226121949*^9, 3.8090982845481586`*^9}},
 CellLabel->
  "In[1143]:=",ExpressionUUID->"df1f7568-b5d7-44e7-bce4-c5076c16fd1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find False Positives", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170807076165*^9}, {
  3.760353612711093*^9, 3.7603536153939342`*^9}, {3.760887234335846*^9, 
  3.7608872387609673`*^9}, {3.76088728531983*^9, 3.7608872861286664`*^9}, {
  3.808038103093626*^9, 3.8080381150860806`*^9}, {3.8081371017677035`*^9, 
  3.80813713053651*^9}},ExpressionUUID->"80358d00-3f0b-4f4e-9fb8-\
b2a09b6a500f"],

Cell["\<\
Default :
  
meanMaxThreshold = 0.10\
\>", "Abstract",
 CellChangeTimes->{{3.8086786368946977`*^9, 3.808678662280766*^9}, 
   3.8091709975889482`*^9},ExpressionUUID->"4c0d205f-b95e-4639-8fa0-\
cc9bbdd5c3ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"meanMaxThreshold", "=", "0.125"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.808137738055478*^9, {3.8086456987704954`*^9, 3.8086457281747127`*^9}, {
   3.8086462728047*^9, 3.8086462765177536`*^9}, {3.808646630228551*^9, 
   3.8086466303223004`*^9}, {3.8086467640526657`*^9, 
   3.8086467642022676`*^9}, {3.808646802108044*^9, 3.8086468171212163`*^9}, {
   3.8086469035224085`*^9, 3.808646905304637*^9}, {3.8086579401184034`*^9, 
   3.808657940306898*^9}, {3.8086582549557343`*^9, 3.808658255074485*^9}, {
   3.80865832967619*^9, 3.8086583298417444`*^9}, {3.8086584961800213`*^9, 
   3.808658496272702*^9}, {3.8086630769797506`*^9, 3.8086630773357954`*^9}, {
   3.8086632173142757`*^9, 3.8086632185350003`*^9}, {3.8086685550360546`*^9, 
   3.8086685552105865`*^9}, {3.8086780055258493`*^9, 3.8086780079234285`*^9}, 
   3.8087233511397257`*^9, {3.8090983019023533`*^9, 3.8090983063703823`*^9}, {
   3.8091709815113907`*^9, 3.8091709892466774`*^9}, {3.8091710256440344`*^9, 
   3.809171027111108*^9}, {3.8091713746196795`*^9, 3.8091713757426443`*^9}, {
   3.8091714353733006`*^9, 3.8091714703378353`*^9}, 3.809171521897992*^9, {
   3.809171617147449*^9, 3.80917163223428*^9}, {3.8092070158877897`*^9, 
   3.809207016076285*^9}, {3.8092071082848125`*^9, 3.809207108997835*^9}},
 CellLabel->
  "In[1145]:=",ExpressionUUID->"94c65b4a-fdeb-46bf-8a27-7c9aa7912e75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"adjustedObjectLikelyhoods", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"{", "}"}], "\[Rule]", "0"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Replace", "[", 
          RowBox[{"#", ",", 
           RowBox[{
            RowBox[{"{", "}"}], "\[Rule]", "0"}]}], "]"}], "&"}], "/@", 
        RowBox[{"objectLikelyhoods", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "objectLikelyhoods"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"acceptanceMap", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Thread", "@", 
      RowBox[{"(", 
       RowBox[{"#", ">", "meanMaxThreshold"}], ")"}]}], "&"}], "/@", 
    "adjustedObjectLikelyhoods"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.80803509596589*^9, 3.808035098864135*^9}, {
   3.808035188770956*^9, 3.8080353316826735`*^9}, {3.808035503456524*^9, 
   3.808035523119931*^9}, {3.80803569666523*^9, 3.8080357659665794`*^9}, {
   3.808035822368867*^9, 3.808035843075638*^9}, {3.8080430584484606`*^9, 
   3.8080430610385113`*^9}, 3.808055051930762*^9, {3.8081377535048146`*^9, 
   3.8081377613754187`*^9}, {3.808155613874176*^9, 3.808155614822637*^9}, {
   3.8091710004697967`*^9, 3.809171003967237*^9}},
 CellLabel->
  "In[1146]:=",ExpressionUUID->"899840c2-f2b7-4a13-a737-d2e599a1d150"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eliminate False Positives", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170807076165*^9}, {
  3.760353612711093*^9, 3.7603536153939342`*^9}, {3.760887234335846*^9, 
  3.7608872387609673`*^9}, {3.76088728531983*^9, 3.7608872861286664`*^9}, {
  3.808038103093626*^9, 3.8080381150860806`*^9}, {3.8081371017677035`*^9, 
  3.80813713053651*^9}, {3.808137505343837*^9, 
  3.8081375069362106`*^9}},ExpressionUUID->"2fc3274a-2d09-42ce-830c-\
3eac2268c4f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"falsePositions", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"acceptanceMap", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "==", "False"}], "&"}], ")"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "acceptanceMap"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"applyRules", "=", 
    RowBox[{"eliminationRules", "@", "falsePositions"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"filteredObjects", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"formattedBubbles", "[", 
        RowBox[{"[", "#", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"applyRules", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], "&"}],
     "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "formattedBubbles"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8080566091653357`*^9, 3.808056635227153*^9}, {
   3.808056669880292*^9, 3.808056678640947*^9}, {3.8080569062147818`*^9, 
   3.8080569294704704`*^9}, {3.8080571362043056`*^9, 
   3.8080571695264826`*^9}, {3.80805723795693*^9, 3.808057281359295*^9}, {
   3.8080573267763104`*^9, 3.8080573472456074`*^9}, {3.8080591523086147`*^9, 
   3.8080592434316607`*^9}, {3.8080594164116087`*^9, 
   3.8080594361318507`*^9}, {3.8080594835059958`*^9, 
   3.8080594940266805`*^9}, {3.808059789217003*^9, 3.808059790944811*^9}, 
   3.808059873603429*^9, {3.8081336899306684`*^9, 3.80813369255982*^9}, {
   3.808201634495102*^9, 3.808201635277181*^9}, 3.808202138779838*^9, {
   3.8082022999869556`*^9, 3.8082023111893473`*^9}, {3.8082024412025332`*^9, 
   3.8082024726757402`*^9}, {3.8082026216092267`*^9, 
   3.8082026380269356`*^9}, {3.8082051198759117`*^9, 3.808205123490801*^9}, {
   3.808208564679894*^9, 3.808208594043898*^9}, {3.8082389215421915`*^9, 
   3.8082389370028734`*^9}, {3.808238980382551*^9, 3.808238989091303*^9}, 
   3.8082390885519466`*^9, {3.808239153745592*^9, 3.808239154625232*^9}, {
   3.8090983447325516`*^9, 3.8090983503076143`*^9}, {3.8090986456755443`*^9, 
   3.8090986515403147`*^9}},
 CellLabel->
  "In[1148]:=",ExpressionUUID->"5db0ba91-54b1-4107-b39e-4d291e91b3ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export The Bubble Sequence >>", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170807076165*^9}, {
  3.760353612711093*^9, 3.7603536153939342`*^9}, {3.760887234335846*^9, 
  3.7608872387609673`*^9}, {3.76088728531983*^9, 3.7608872861286664`*^9}, {
  3.808038103093626*^9, 
  3.8080381150860806`*^9}},ExpressionUUID->"6fd83c9f-a61c-48bf-b045-\
76b0e561fb46"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"tally3", "=", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"k", ",", 
           RowBox[{"filteredObjects", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
         ",", "1"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"testBatch", "/", "reductionFactor"}], "//", "Round"}]}], 
        "}"}]}], "\[IndentingNewLine]", "]"}], "//", "TableForm"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "<>", "\"\<Intensity Filter Output.pdf\>\""}], ",", 
     "\[IndentingNewLine]", "tally3"}], "\[IndentingNewLine]", "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.760085006798891*^9, 3.7600850084424973`*^9}, {
   3.7600852284464664`*^9, 3.760085230307479*^9}, {3.7600970658438735`*^9, 
   3.76009716745831*^9}, {3.7600972030442443`*^9, 3.760097249810731*^9}, {
   3.7600972999402184`*^9, 3.7600973045080023`*^9}, {3.760098028115207*^9, 
   3.7600980741059456`*^9}, {3.7601578167445602`*^9, 
   3.7601578343399367`*^9}, {3.760160853272077*^9, 3.7601608548957367`*^9}, {
   3.760160968111302*^9, 3.760160969852683*^9}, {3.760170660821293*^9, 
   3.760170696036518*^9}, {3.7602506335671096`*^9, 3.7602506376272535`*^9}, {
   3.7604547167444324`*^9, 3.7604547340816994`*^9}, {3.760676479949131*^9, 
   3.760676480531562*^9}, {3.760887060351301*^9, 3.7608870945758786`*^9}, {
   3.760887193720355*^9, 3.7608872000630713`*^9}, 3.760929305471698*^9, {
   3.766942679829764*^9, 3.7669426853895655`*^9}, 3.781964803658646*^9, 
   3.781965075894517*^9, {3.806134330043498*^9, 3.8061343302586517`*^9}, {
   3.806961510118593*^9, 3.8069615103409967`*^9}, 3.8073492280026584`*^9, {
   3.8076350976628323`*^9, 3.8076351093461056`*^9}, {3.80763524541284*^9, 
   3.8076352477027154`*^9}, {3.8076353085556555`*^9, 
   3.8076353145296774`*^9}, {3.807706385591584*^9, 3.8077063909442673`*^9}, {
   3.808038123214999*^9, 3.8080381357658396`*^9}, {3.8080425055255575`*^9, 
   3.808042510196644*^9}},ExpressionUUID->"02d3884b-4c30-4100-8898-\
6808d054c629"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Size/Location Filter", "Section",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.8077950418489313`*^9, 
  3.8077951013531604`*^9}},ExpressionUUID->"021d79a9-e1d3-4ae4-94b5-\
353f0667ecdf"],

Cell[CellGroupData[{

Cell["Inspect The Size Distribution", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170807076165*^9}, {
  3.760353612711093*^9, 3.7603536153939342`*^9}, {3.760887234335846*^9, 
  3.7608872387609673`*^9}, {3.76088728531983*^9, 3.7608872861286664`*^9}, {
  3.808038103093626*^9, 3.8080381150860806`*^9}, {3.8081378237491384`*^9, 
  3.80813782941374*^9}, {3.8082386657088733`*^9, 3.808238669973507*^9}, {
  3.808303635632008*^9, 3.8083036365934286`*^9}, {3.8083194372618837`*^9, 
  3.808319438037747*^9}},ExpressionUUID->"aee27611-2370-44b9-bc54-\
e111f9895f75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"checkAreas", "=", 
    RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Flatten", "@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"filteredObjects", "[", 
               RowBox[{"[", 
                RowBox[{"k", ",", "#"}], "]"}], "]"}], ",", "2"}], 
             "\[IndentingNewLine]", "]"}], "[", 
            RowBox[{"[", "6", "]"}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "@", 
           RowBox[{"Length", "@", 
            RowBox[{"filteredObjects", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "@", "filteredObjects"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"NumberQ", "@", "#"}], "\[Equal]", "False"}], "&"}], 
        ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
   ";"}], "//", "Quiet"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"checkAreas", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1000", ",", "8500"}], "}"}], ",", "Automatic"}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQfWuCX05W/BvHU5MEC0D0Hhu1WSDaQsEXTMuyuG4H
0TUCC3eD6Dbn2cdA9EElvnMgelK40h0QnRH24AGIVu3hFMsG0jdiucF0YImr
Doi+xVVlCqIjJq6vAtGXKjaB6bJJnJw5QHri3gXcINq1TF0VRL+L3q0Ooh+Y
s+mB6FmXIi1BdKiHeCCIvtDkB6ZPcd/QzgXSOtcv6oDouDxW9yIgnVC2GUz7
HZ7ZsRhIM3/cBKaP/jp6AURfaD8FphvWVzgcAdJbM6SdQPSXj3XuBQlAdzVt
ANMHGNz2g+j046dPgOhPckaN7olvHOuPvADTDukZwR5AerV1Dphmmins5Qek
nxg88wfRceuqT2cBadW988A0AD0jsqY=
  "],
 CellLabel->
  "In[1151]:=",ExpressionUUID->"a1d75601-c001-451e-a702-c001c9ada3d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Inspect Suspect False Positives", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170807076165*^9}, {
  3.760353612711093*^9, 3.7603536153939342`*^9}, {3.760887234335846*^9, 
  3.7608872387609673`*^9}, {3.76088728531983*^9, 3.7608872861286664`*^9}, {
  3.808038103093626*^9, 3.8080381150860806`*^9}, {3.8081378237491384`*^9, 
  3.8081378552127466`*^9}},ExpressionUUID->"2aa355e3-e5e5-440a-bc6d-\
72dbc22e9a3a"],

Cell["Possible Improvements", "Abstract",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
  3.769158606943906*^9, 3.7691586572504983`*^9}, {3.7692223025981207`*^9, 
  3.769222339641034*^9}},ExpressionUUID->"89dd722e-3bb3-45ba-932a-\
7f5ee3921be9"],

Cell["Export the suspect list as a .pdf", "Subitem",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
   3.769158606943906*^9, 3.7691586572504983`*^9}, 3.7692223043414335`*^9, {
   3.769222342585159*^9, 3.769222345000705*^9}, {3.769230882123254*^9, 
   3.769230908195506*^9}, {3.770115650982784*^9, 3.7701156661114388`*^9}, {
   3.804171808390911*^9, 3.804171808392909*^9}, {3.8086787254165764`*^9, 
   3.80867873427079*^9}},ExpressionUUID->"0ebe6d5b-ebca-43a0-a671-\
d0f5dd40c79b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkStats", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{"Last", "@", 
             RowBox[{"filteredObjects", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "#"}], "]"}], "]"}]}], "\[IndentingNewLine]",
             ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "4"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", 
           RowBox[{"filteredObjects", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"Length", "@", "filteredObjects"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], ";"}], "//", "Quiet"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"testArea", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "<", "7500"}], "&"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkShapes", "=", 
     RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
        RowBox[{"checkStats", ",", "\[IndentingNewLine]", 
         RowBox[{"_", "?", 
          RowBox[{"(", "testArea", ")"}]}]}], "\[IndentingNewLine]", "]"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ListQ", "@", "#"}], "\[Equal]", "False"}], "&"}], 
         ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
    ";"}], "//", "Quiet"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"checkShapes", "//", "Length"}], "\[IndentingNewLine]", 
 RowBox[{"checkShapes", "//", "TableForm"}]}], "Input",
 CellChangeTimes->{{3.808123362920813*^9, 3.808123378733*^9}, {
   3.808123413223646*^9, 3.808123530301857*^9}, {3.8081235607571397`*^9, 
   3.808123758302466*^9}, {3.8081237887263455`*^9, 3.8081238003482265`*^9}, {
   3.8081239114083815`*^9, 3.808123918284969*^9}, {3.8081256468074846`*^9, 
   3.8081256544679747`*^9}, {3.8081259434310117`*^9, 
   3.8081259709409227`*^9}, {3.808127346632324*^9, 3.808127355655585*^9}, {
   3.808127625888404*^9, 3.808127676190728*^9}, 3.808127710487808*^9, {
   3.808305688107086*^9, 3.8083057045357885`*^9}, {3.8084767753468623`*^9, 
   3.8084767776496744`*^9}, 3.8084775516437483`*^9, {3.80847784352549*^9, 
   3.8084778470514865`*^9}, {3.8085646755762634`*^9, 
   3.8085647578254976`*^9}, {3.8085649288083086`*^9, 3.808564928870842*^9}, {
   3.8085877736769304`*^9, 3.8085877747381563`*^9}, {3.8086318300201807`*^9, 
   3.808631841736133*^9}, {3.8086582045636563`*^9, 3.8086582068595443`*^9}, {
   3.8086590284186306`*^9, 3.8086590284974194`*^9}, {3.8086593704170294`*^9, 
   3.8086593823505945`*^9}, {3.808677954270814*^9, 3.808677978812425*^9}, {
   3.8090987712194166`*^9, 3.80909877396207*^9}, 3.8091033999063454`*^9, 
   3.8091037788002715`*^9, 3.8091038443164124`*^9, 3.8091040270150867`*^9, {
   3.809104096033449*^9, 3.8091041124203186`*^9}, {3.8091054305637574`*^9, 
   3.8091054306510415`*^9}, {3.809112787548648*^9, 3.80911281339917*^9}, {
   3.809112886099781*^9, 3.809112887412266*^9}, {3.8091129846852374`*^9, 
   3.8091130275356374`*^9}, {3.8091710604479513`*^9, 
   3.8091710606224804`*^9}, {3.809171400828907*^9, 3.809171402022711*^9}, {
   3.8091714772522526`*^9, 3.809171477782832*^9}, {3.809171511100316*^9, 
   3.8091715115022407`*^9}, {3.8091715458044825`*^9, 
   3.8091715597172594`*^9}, {3.809171600156865*^9, 3.809171608614219*^9}, {
   3.809171756140891*^9, 3.8091717690123625`*^9}, {3.809207125035655*^9, 
   3.8092071504934726`*^9}},
 CellLabel->
  "In[1153]:=",ExpressionUUID->"fed2124e-8107-45f8-a92a-52dae5ec8f4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Inspect Object Locations", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170807076165*^9}, {
  3.760353612711093*^9, 3.7603536153939342`*^9}, {3.760887234335846*^9, 
  3.7608872387609673`*^9}, {3.76088728531983*^9, 3.7608872861286664`*^9}, {
  3.808038103093626*^9, 3.8080381150860806`*^9}, {3.8081378237491384`*^9, 
  3.8081378552127466`*^9}, {3.8083039541583385`*^9, 
  3.8083039622615957`*^9}},ExpressionUUID->"6b67f1b4-081e-412f-845b-\
e7856dba678d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
       RowBox[{"getMetric", "[", 
        RowBox[{"filteredObjects", ",", "3"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ListQ", "@", "#"}], "\[Equal]", "False"}], "||", 
          RowBox[{
           RowBox[{"Length", "@", "#"}], "\[Equal]", "0"}]}], "&"}], 
        ")"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", "]"}], 
  "//", "Quiet"}]], "Input",
 CellChangeTimes->{{3.8091041452997847`*^9, 3.809104145852305*^9}, {
  3.809104241744555*^9, 3.8091043002758713`*^9}, {3.8091044159747095`*^9, 
  3.8091044258821754`*^9}, {3.8091045727127113`*^9, 3.809104590163062*^9}, {
  3.809104720301036*^9, 3.8091047374810224`*^9}, {3.8091129243401904`*^9, 
  3.8091129287716923`*^9}},
 CellLabel->
  "In[1158]:=",ExpressionUUID->"856c7ebe-d8ea-451d-a46e-03af7dc41652"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find & Eliminate False Positives", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170807076165*^9}, {
  3.760353612711093*^9, 3.7603536153939342`*^9}, {3.760887234335846*^9, 
  3.7608872387609673`*^9}, {3.76088728531983*^9, 3.7608872861286664`*^9}, {
  3.808038103093626*^9, 3.8080381150860806`*^9}, {3.8081378237491384`*^9, 
  3.8081378552127466`*^9}, {3.8081450527526693`*^9, 3.808145055633177*^9}, {
  3.8081539603823037`*^9, 
  3.8081539654378166`*^9}},ExpressionUUID->"aece2adc-449e-45f5-b835-\
d5e8e0b922d2"],

Cell["\<\
Defaults :
   
minimumArea=1000;
maximumArea=5500;   
minimumX = 0;
maxiumumX = widthPixels;\
\>", "Abstract",
 CellChangeTimes->{{3.808477902638389*^9, 3.8084779268088603`*^9}, {
   3.8085647853249273`*^9, 3.808564787637578*^9}, 3.8086463144597006`*^9, 
   3.809105456692817*^9},ExpressionUUID->"e843e7e9-ba32-4b27-8a51-\
113d4ed0e3e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"minimumArea", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maximumArea", "=", "7500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minimumX", "=", "220"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"maxiumumX", "=", "345"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getArea", "[", "dataset_", "]"}], ":=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dataset", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", "2"}], "\[IndentingNewLine]", 
        "]"}], "[", 
       RowBox[{"[", "6", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", 
        RowBox[{"dataset", "//", "Length"}]}], "}"}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getX", "[", "dataset_", "]"}], ":=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dataset", "[", 
          RowBox[{"[", "m", "]"}], "]"}], ",", "2"}], "\[IndentingNewLine]", 
        "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"m", ",", "1", ",", 
        RowBox[{"dataset", "//", "Length"}]}], "}"}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"unitConversion", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"widthPixels", "/", "defaultWidthPixels"}], ")"}], "*", 
     RowBox[{"fieldOfView", "/", "widthPixels"}]}], "//", "N"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8022441982711124`*^9, 3.802244198381796*^9}, {
   3.8022444161617413`*^9, 3.8022444444651556`*^9}, {3.802246327166068*^9, 
   3.802246338365137*^9}, {3.8022463787503767`*^9, 3.8022464693847523`*^9}, {
   3.8022465247588425`*^9, 3.8022466246251755`*^9}, {3.8022466818967376`*^9, 
   3.8022466822996407`*^9}, {3.8022468620642233`*^9, 3.802246866679878*^9}, {
   3.8022469111469297`*^9, 3.802246915380165*^9}, {3.806121677584551*^9, 
   3.8061216970849056`*^9}, {3.8061217699141407`*^9, 3.806121770179764*^9}, {
   3.8061218133365164`*^9, 3.8061218703216705`*^9}, {3.8061223545249467`*^9, 
   3.8061223783568764`*^9}, {3.8061224234609194`*^9, 
   3.8061225383845787`*^9}, {3.806134150333459*^9, 3.806134214474451*^9}, {
   3.806134385019904*^9, 3.8061343996273794`*^9}, {3.8061344450679717`*^9, 
   3.8061344629197927`*^9}, {3.806150194623948*^9, 3.8061502164796066`*^9}, {
   3.8061722560301585`*^9, 3.806172274426961*^9}, {3.8061723098015313`*^9, 
   3.8061723119344425`*^9}, {3.8061729716259427`*^9, 3.806172994797494*^9}, {
   3.806173212003304*^9, 3.8061732122518215`*^9}, {3.8061732437158594`*^9, 
   3.806173243940143*^9}, {3.8061734515462503`*^9, 3.806173451633873*^9}, {
   3.806261038525037*^9, 3.806261069690384*^9}, {3.8062616211417217`*^9, 
   3.806261625925152*^9}, {3.8063553473739147`*^9, 3.8063553696554546`*^9}, {
   3.8063555387827005`*^9, 3.8063555414233093`*^9}, {3.806961667292961*^9, 
   3.8069616704696264`*^9}, {3.8069619926591263`*^9, 3.8069619966025553`*^9}, 
   3.8073495290065594`*^9, {3.807635382793785*^9, 3.8076353848348503`*^9}, {
   3.8076355340445604`*^9, 3.807635536834098*^9}, {3.80770662871959*^9, 
   3.8077066317914295`*^9}, {3.8077067900634336`*^9, 
   3.8077067923093553`*^9}, {3.807795113581941*^9, 3.8077951198093367`*^9}, {
   3.8079405264293785`*^9, 3.807940529543042*^9}, {3.808125428926197*^9, 
   3.8081254368144712`*^9}, {3.808126656631917*^9, 3.808126657015889*^9}, {
   3.808130168282213*^9, 3.8081302125612764`*^9}, {3.8081302456296215`*^9, 
   3.808130254906503*^9}, {3.808131153865441*^9, 3.8081311645908504`*^9}, {
   3.8081336521290474`*^9, 3.80813365253369*^9}, {3.808133941036832*^9, 
   3.808133942087796*^9}, {3.8081339786868525`*^9, 3.808133980572489*^9}, {
   3.808134033791847*^9, 3.80813403522939*^9}, {3.8081342579952283`*^9, 
   3.808134305319646*^9}, {3.8081347324692583`*^9, 3.8081347329609404`*^9}, {
   3.808134875621649*^9, 3.8081348941379466`*^9}, {3.8081350734840345`*^9, 
   3.808135099011009*^9}, {3.80814463638244*^9, 3.8081446527182684`*^9}, {
   3.808144752962587*^9, 3.8081447571257954`*^9}, {3.808205211283781*^9, 
   3.8082052121211605`*^9}, {3.8082386941532726`*^9, 
   3.8082386984198246`*^9}, {3.8082392479375043`*^9, 
   3.8082392510421753`*^9}, {3.80830459465252*^9, 3.808304595337682*^9}, {
   3.8084778995337715`*^9, 3.8084779003711557`*^9}, {3.8084779608994036`*^9, 
   3.8084779610749335`*^9}, {3.8085647925751085`*^9, 
   3.8085648079656644`*^9}, {3.808587788132553*^9, 3.8085877899228253`*^9}, {
   3.8085878241796217`*^9, 3.808587835866336*^9}, {3.80863919952464*^9, 
   3.8086392038121505`*^9}, {3.8086469479883084`*^9, 
   3.8086469724972973`*^9}, {3.8086584042902827`*^9, 
   3.8086584071965027`*^9}, {3.808658687771858*^9, 3.808658713097715*^9}, {
   3.8086590560502057`*^9, 3.8086590732558546`*^9}, {3.8086592938878183`*^9, 
   3.8086592939985223`*^9}, {3.8086781120630007`*^9, 3.808678122028021*^9}, {
   3.8086783067007847`*^9, 3.8086783067546406`*^9}, 3.8090706405493317`*^9, {
   3.809105158026766*^9, 3.809105172054829*^9}, 3.809105228378561*^9, {
   3.809105422105941*^9, 3.809105440597922*^9}, {3.809112956182739*^9, 
   3.8091129718198957`*^9}, {3.8091717352572203`*^9, 
   3.8091717355653915`*^9}, {3.809171776261002*^9, 3.809171797261511*^9}, {
   3.809207193667798*^9, 3.809207194190398*^9}, {3.8092072288779664`*^9, 
   3.8092072291482425`*^9}},
 CellLabel->
  "In[1159]:=",ExpressionUUID->"5532f4c3-7285-4a1f-97f8-5514c7940350"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k", "=", "1"}], ",", 
    RowBox[{"k", "\[LessEqual]", 
     RowBox[{"Length", "@", "filteredObjects"}]}], ",", 
    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", "\n", 
    RowBox[{
     RowBox[{"detectionEvents", "=", 
      RowBox[{"filteredObjects", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}], ";", "\n", "\n", 
     RowBox[{"(*", 
      RowBox[{"SIZE", " ", "FILTER"}], "*)"}], "\n", "\[IndentingNewLine]", 
     RowBox[{"checkMinArea", "=", 
      RowBox[{
       RowBox[{"Position", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"getArea", "@", "detectionEvents"}], ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "<", "minimumArea"}], "&"}], ")"}]}]}], 
        "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"minAreaFilter", "=", 
      RowBox[{"eliminateEntries", "[", 
       RowBox[{"detectionEvents", ",", "checkMinArea"}], "]"}]}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"checkMaxArea", "=", 
      RowBox[{
       RowBox[{"Position", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"getArea", "@", "minAreaFilter"}], ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", "maximumArea"}], "&"}], ")"}]}]}], 
        "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"maxAreaFilter", "=", 
      RowBox[{"eliminateEntries", "[", 
       RowBox[{"minAreaFilter", ",", "checkMaxArea"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"POSITION", " ", "FILTER"}], "*)"}], "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"checkMinX", "=", 
      RowBox[{
       RowBox[{"Position", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"getX", "@", "maxAreaFilter"}], ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "<", "minimumX"}], "&"}], ")"}]}]}], 
        "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"minXFilter", "=", 
      RowBox[{"eliminateEntries", "[", 
       RowBox[{"maxAreaFilter", ",", "checkMinX"}], "]"}]}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"checkMaxX", "=", 
      RowBox[{
       RowBox[{"Position", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"getX", "@", "minXFilter"}], ",", 
         RowBox[{"_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", ">", "maxiumumX"}], "&"}], ")"}]}]}], 
        "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{"maxXFilter", "=", 
      RowBox[{"eliminateEntries", "[", 
       RowBox[{"minXFilter", ",", "checkMaxX"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\n", 
     RowBox[{
      RowBox[{"filteredEvents", "[", "k", "]"}], "=", "maxXFilter"}], ";"}]}],
    "\[IndentingNewLine]", "\n", "]"}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"actualBubbles", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filteredEvents", "[", "k", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "@", "filteredObjects"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8022441982711124`*^9, 3.802244198381796*^9}, {
   3.8022444161617413`*^9, 3.8022444444651556`*^9}, {3.802246327166068*^9, 
   3.802246338365137*^9}, {3.8022463787503767`*^9, 3.8022464693847523`*^9}, {
   3.8022465247588425`*^9, 3.8022466246251755`*^9}, {3.8022466818967376`*^9, 
   3.8022466822996407`*^9}, {3.8022468620642233`*^9, 3.802246866679878*^9}, {
   3.8022469111469297`*^9, 3.802246915380165*^9}, {3.806121677584551*^9, 
   3.8061216970849056`*^9}, {3.8061217699141407`*^9, 3.806121770179764*^9}, {
   3.8061218133365164`*^9, 3.8061218703216705`*^9}, {3.8061223545249467`*^9, 
   3.8061223783568764`*^9}, {3.8061224234609194`*^9, 
   3.8061225383845787`*^9}, {3.806134150333459*^9, 3.806134214474451*^9}, {
   3.806134385019904*^9, 3.8061343996273794`*^9}, {3.8061344450679717`*^9, 
   3.8061344629197927`*^9}, {3.806150194623948*^9, 3.8061502164796066`*^9}, {
   3.8061722560301585`*^9, 3.806172274426961*^9}, {3.8061723098015313`*^9, 
   3.8061723119344425`*^9}, {3.8061729716259427`*^9, 3.806172994797494*^9}, {
   3.806173212003304*^9, 3.8061732122518215`*^9}, {3.8061732437158594`*^9, 
   3.806173243940143*^9}, {3.8061734515462503`*^9, 3.806173451633873*^9}, {
   3.806261038525037*^9, 3.806261069690384*^9}, {3.8062616211417217`*^9, 
   3.806261625925152*^9}, {3.8063553473739147`*^9, 3.8063553696554546`*^9}, {
   3.8063555387827005`*^9, 3.8063555414233093`*^9}, {3.806961667292961*^9, 
   3.8069616704696264`*^9}, {3.8069619926591263`*^9, 
   3.8069619966025553`*^9}, {3.8073495290065594`*^9, 
   3.8073495333336215`*^9}, {3.807635403020239*^9, 3.8076354043307333`*^9}, {
   3.8081294898129964`*^9, 3.808129493814145*^9}, {3.8081297898629255`*^9, 
   3.8081297917974586`*^9}, {3.8081298393000755`*^9, 3.808129902648963*^9}, 
   3.8081299351552925`*^9, 3.8081333786818376`*^9, {3.808133417970496*^9, 
   3.808133452140994*^9}, {3.808133488269658*^9, 3.808133584398141*^9}, {
   3.8081336275175424`*^9, 3.8081336447452602`*^9}, {3.8081339934286084`*^9, 
   3.808134016524931*^9}, {3.8081340579196405`*^9, 3.8081341471878347`*^9}, {
   3.8081346091306295`*^9, 3.8081347183146133`*^9}, {3.808134775396394*^9, 
   3.8081347781717997`*^9}, {3.808137907408569*^9, 3.8081379484696703`*^9}, 
   3.808138201198206*^9, 3.808144555624254*^9, {3.8081448223817472`*^9, 
   3.8081448282539043`*^9}, {3.8081448846163783`*^9, 3.808144894478554*^9}, 
   3.808145004522854*^9, {3.808145162985938*^9, 3.8081451663628807`*^9}, {
   3.8081452354249983`*^9, 3.8081452355603347`*^9}, {3.808154992199277*^9, 
   3.8081549972021475`*^9}, 3.8081558974908886`*^9, {3.808301665963916*^9, 
   3.8083016746635046`*^9}, {3.8083057479311085`*^9, 3.808305749433079*^9}, {
   3.809105259596772*^9, 3.809105261242297*^9}, 3.8091053778437977`*^9, {
   3.809171811869982*^9, 3.8091718141488113`*^9}},
 CellLabel->
  "In[1166]:=",ExpressionUUID->"fb66a48c-ed4b-4563-9181-801fb3ba0449"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Post-process The True Positives", "Section",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.760170896953659*^9, 3.7601709031790094`*^9}, {3.8077952028241186`*^9, 
  3.8077952084087553`*^9}, {3.808138048434164*^9, 3.80813807006663*^9}, {
  3.808154094990706*^9, 3.8081540960935917`*^9}, {3.80830157475065*^9, 
  3.8083016041347637`*^9}, {3.8083080144842453`*^9, 
  3.8083080175400534`*^9}},ExpressionUUID->"7e3646c0-20e4-41ca-9958-\
5eb313501ada"],

Cell[CellGroupData[{

Cell["Generate Overlays For The True Positives", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.760170896953659*^9, 3.7601709031790094`*^9}, {3.8077952028241186`*^9, 
  3.8077952084087553`*^9}, {3.808138048434164*^9, 3.80813807006663*^9}, {
  3.808154094990706*^9, 3.8081540960935917`*^9}, {3.80830157475065*^9, 
  3.8083016041347637`*^9}},ExpressionUUID->"062eaf19-b465-4d75-8724-\
5e2aee8fb285"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"formattedPositives", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", "#", "}"}], "&"}], "/@", 
       RowBox[{"actualBubbles", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "actualBubbles"}]}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trueCentroids", "=", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorScan", "[", 
        RowBox[{"getCoordinates", ",", "formattedPositives", ",", "k"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "formattedPositives"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cleanCentroids", "=", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eliminateEntries", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"trueCentroids", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Position", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"VectorQ", "/@", 
            RowBox[{"trueCentroids", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"#", "\[Equal]", "False"}], "&"}], ")"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "trueCentroids"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], "/.", 
     RowBox[{
      RowBox[{"{", "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"blackCanvas", "=", 
    RowBox[{"Binarize", "[", 
     RowBox[{
      RowBox[{"images", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newShapes", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"cleanCentroids", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "#"}], "]"}], "]"}], "\[NotEqual]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"formattedPositives", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "#"}], "]"}], "]"}], ",", "2"}], 
            "\[IndentingNewLine]", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Image", "@", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "]"}], "&"}], "/@", 
       RowBox[{"Range", "@", 
        RowBox[{"Length", "@", 
         RowBox[{"formattedPositives", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "formattedPositives"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"shapeOverlay", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ImageCompose", "[", "\[IndentingNewLine]", 
        RowBox[{"blackCanvas", ",", "\[IndentingNewLine]", 
         RowBox[{"newShapes", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"cleanCentroids", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"Length", "@", "cleanCentroids"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "//", "Quiet"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"emptyFrames", "=", 
    RowBox[{"Position", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ImageQ", "/@", "shapeOverlay"}], ",", "\[IndentingNewLine]", 
      RowBox[{"_", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "\[Equal]", "False"}], "&"}], ")"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shapeMasks", "=", 
   RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
    RowBox[{"shapeOverlay", ",", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "@", 
      RowBox[{"eliminationRules", "@", "emptyFrames"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.809105971394882*^9, 3.80910605282663*^9}, {
  3.8091061228469324`*^9, 3.809106134179104*^9}, {3.809107639229476*^9, 
  3.8091076538907623`*^9}, {3.8092074006079655`*^9, 3.809207404804724*^9}},
 CellLabel->
  "In[1168]:=",ExpressionUUID->"32c1fdde-4a67-466c-95ec-00c015bbf518"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Preview True Positive Positions", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.760170896953659*^9, 3.7601709031790094`*^9}, {3.8077952028241186`*^9, 
  3.8077952084087553`*^9}, {3.808138048434164*^9, 3.80813807006663*^9}, {
  3.808154094990706*^9, 3.8081540960935917`*^9}, {3.80830157475065*^9, 
  3.8083016041347637`*^9}, {3.8091801291694546`*^9, 
  3.809180142921703*^9}},ExpressionUUID->"2aa80eab-6070-48a7-a47d-\
2e4d5c0de9aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dotSize", ":=", "0.015"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colorGrading", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"cleanCentroids", "//", "Length"}], ",", "1"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "//", "Rescale"}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colorPaletteAll", ":=", "\"\<SunsetColors\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colorTableAll", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Blend", "[", "\[IndentingNewLine]", 
       RowBox[{"colorPaletteAll", ",", 
        RowBox[{"colorGrading", "[", 
         RowBox[{"[", "t", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1", ",", 
        RowBox[{"cleanCentroids", "//", "Length"}], ",", "1"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"showAllDots", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Style", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cleanCentroids", "[", 
         RowBox[{"[", "k", "]"}], "]"}], ",", 
        RowBox[{"colorTableAll", "[", 
         RowBox[{"[", "k", "]"}], "]"}], ",", 
        RowBox[{"PointSize", "@", "dotSize"}]}], "\[IndentingNewLine]", "]"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"cleanCentroids", "//", "Length"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"overlayAllDots", "=", 
  RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Last", "@", "images"}], ",", "\[IndentingNewLine]", 
    "showAllDots"}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.8091800533769913`*^9, 3.8091800632839723`*^9}, {
  3.8091801820099363`*^9, 3.809180182933464*^9}},
 CellLabel->
  "In[1176]:=",ExpressionUUID->"43b99050-6b8f-4ccd-8c6c-a5ab2b240ce6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualize The True Positives", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.760170896953659*^9, 3.7601709031790094`*^9}, {3.8077952028241186`*^9, 
  3.8077952084087553`*^9}, {3.808138048434164*^9, 3.80813807006663*^9}, {
  3.808154094990706*^9, 3.8081540960935917`*^9}, {3.808301589967221*^9, 
  3.8083015981821637`*^9}, {3.808308119971815*^9, 
  3.8083081206988654`*^9}},ExpressionUUID->"54ca450f-6c7c-489e-9a35-\
b9f818084ffb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"centroidMarkerSize", "=", "0.02"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"viewDetectedBubbles", "[", "imageID_", "]"}], ":=", 
  RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"images", "[", 
       RowBox[{"[", "imageID", "]"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"shapeMasks", "[", 
         RowBox[{"[", "imageID", "]"}], "]"}], ",", "White"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"cleanCentroids", "[", 
       RowBox[{"[", "imageID", "]"}], "]"}], ",", "Orange", ",", 
      RowBox[{"PointSize", "@", "centroidMarkerSize"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8083115477008753`*^9, 3.8083115709272957`*^9}, {
   3.8083144529532146`*^9, 3.8083145044958086`*^9}, 3.809107825742959*^9},
 CellLabel->
  "In[1182]:=",ExpressionUUID->"833c0780-8cef-456d-b5af-e93ab4aae17a"],

Cell[BoxData[
 RowBox[{"viewDetectedBubbles", "@", "2109"}]], "Input",
 CellChangeTimes->{{3.8091066970482316`*^9, 3.809106705579682*^9}, {
  3.809107332204248*^9, 3.809107348195527*^9}, {3.8091078236814804`*^9, 
  3.809107827955103*^9}, {3.8091718391950283`*^9, 3.80917184649876*^9}},
 CellLabel->
  "In[1184]:=",ExpressionUUID->"a7b4a05e-f6d0-4259-82e2-b2d3f3ca3d2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export The Output Sequence >>", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.760170896953659*^9, 3.7601709031790094`*^9}, {3.7602506548965907`*^9, 
  3.760250655708435*^9}, {3.760250902949319*^9, 3.760250903588627*^9}, {
  3.7603536058963194`*^9, 
  3.760353609377013*^9}},ExpressionUUID->"327808da-abb1-4eee-a6c6-\
9d0b45707382"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"tally3", "=", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"filteredEvents", "[", "k", "]"}]}], "}"}], ",", "1"}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{
          RowBox[{"testBatch", "/", "reductionFactor"}], "//", "Round"}]}], 
        "}"}]}], "\[IndentingNewLine]", "]"}], "//", "TableForm"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "<>", "\"\<Filtered Bubble Sequence.pdf\>\""}], ",", 
     "\[IndentingNewLine]", "tally3"}], "\[IndentingNewLine]", "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.759936238978649*^9, 3.759936406537003*^9}, {
   3.759936527256872*^9, 3.759936528073693*^9}, {3.7599366538096*^9, 
   3.7599366541127977`*^9}, {3.7599368858040314`*^9, 3.759936896975786*^9}, {
   3.7599369536970854`*^9, 3.759936955200077*^9}, 3.759937033845038*^9, 
   3.7599372136429787`*^9, {3.759937860978798*^9, 3.7599378610266657`*^9}, {
   3.7599380785434794`*^9, 3.759938177642179*^9}, {3.759938559678397*^9, 
   3.7599385736814475`*^9}, {3.760079442022232*^9, 3.760079456236249*^9}, {
   3.760081048708661*^9, 3.760081081343079*^9}, {3.7600840418833275`*^9, 
   3.76008404300533*^9}, 3.760084943577952*^9, {3.760085270922016*^9, 
   3.760085270968891*^9}, {3.760086235435248*^9, 3.7600862799533467`*^9}, {
   3.76008634227604*^9, 3.760086355109507*^9}, {3.760087620370428*^9, 
   3.7600876209768057`*^9}, {3.760087694114527*^9, 3.7600878727117825`*^9}, {
   3.7600879280220037`*^9, 3.7600880544162865`*^9}, {3.7600881336239476`*^9, 
   3.7600881999435964`*^9}, {3.7600886212557015`*^9, 3.760089006927392*^9}, {
   3.7600891849852996`*^9, 3.760089190520499*^9}, {3.7600894908734684`*^9, 
   3.760089520800217*^9}, {3.7600901768234015`*^9, 3.760090186498553*^9}, {
   3.760090687249051*^9, 3.7600907275440207`*^9}, {3.7600973201801105`*^9, 
   3.760097340514758*^9}, {3.760097503419735*^9, 3.7600975390584235`*^9}, {
   3.7600976238516316`*^9, 3.760097625690712*^9}, {3.7600976803231993`*^9, 
   3.760097714076793*^9}, 3.7600977578396144`*^9, {3.760097816164647*^9, 
   3.7600978234159927`*^9}, {3.760098313546743*^9, 3.7600983360336046`*^9}, 
   3.760102316008825*^9, {3.7601608845025826`*^9, 3.7601608870996094`*^9}, {
   3.760160984415698*^9, 3.760160988064943*^9}, 3.760161914038392*^9, {
   3.7601711584586024`*^9, 3.7601712487145004`*^9}, {3.7601712995294495`*^9, 
   3.760171301432356*^9}, {3.7602508980753717`*^9, 3.7602508992910986`*^9}, {
   3.760454744672167*^9, 3.760454760642002*^9}, {3.7606764858832483`*^9, 
   3.760676486273232*^9}, {3.760887324906975*^9, 3.7608873359446445`*^9}, 
   3.7609293097424545`*^9, 3.7609301036755342`*^9, {3.7669427475072355`*^9, 
   3.766942751029067*^9}, 3.7819648060029464`*^9, 3.781965444314063*^9, 
   3.7819655296904173`*^9, 3.802247005526354*^9, {3.8061726004100027`*^9, 
   3.8061726006237507`*^9}, {3.8069617955952597`*^9, 3.806961795658903*^9}, {
   3.8076351887411547`*^9, 3.807635191314271*^9}, {3.8076354281320615`*^9, 
   3.8076354328988876`*^9}, {3.807706410269785*^9, 3.8077064141277184`*^9}, {
   3.8081280214115295`*^9, 
   3.808128022081644*^9}},ExpressionUUID->"e04e8516-e975-40f7-a898-\
7244a94c0988"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Filtering Statistics", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
   3.760170896953659*^9, 3.7601709031790094`*^9}, {3.7602506548965907`*^9, 
   3.760250655708435*^9}, {3.760250902949319*^9, 3.760250903588627*^9}, {
   3.7603536058963194`*^9, 3.760353609377013*^9}, 
   3.769227420389349*^9},ExpressionUUID->"b91a0d8f-6940-428e-846a-\
5e841f6f9aef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"assessDamage", "[", 
    RowBox[{"dataset_", ",", "criterion_"}], "]"}], ":=", 
   RowBox[{"Length", "@", 
    RowBox[{"Position", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Length", "/@", 
       RowBox[{"Flatten", "[", 
        RowBox[{"dataset", ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"_", "?", 
       RowBox[{"(", "criterion", ")"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"assessAcceptance", "[", 
   RowBox[{"dataset_", ",", "criterion_"}], "]"}], ":=", 
  RowBox[{"Length", "@", 
   RowBox[{"Position", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "@", "dataset"}], ",", "\[IndentingNewLine]", 
     RowBox[{"_", "?", 
      RowBox[{"(", "criterion", ")"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8082087122292304`*^9, 3.808208774511704*^9}, {
   3.808209121583316*^9, 3.808209135341077*^9}, {3.808210516818805*^9, 
   3.808210567841778*^9}, 3.8082106557807374`*^9, {3.8091080466559205`*^9, 
   3.8091080522958813`*^9}},
 CellLabel->
  "In[1185]:=",ExpressionUUID->"16f9d38e-6779-46e9-9872-7e4796bbdbf9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"zeroObjectsFound", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "@", 
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{"extract", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"#", "\[Equal]", 
           RowBox[{"{", "}"}]}], "&"}]}], "\[IndentingNewLine]", "]"}]}], "/", 
      RowBox[{"Length", "@", "extract"}]}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MRIFcasualties", "=", 
    RowBox[{
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"assessDamage", "[", 
        RowBox[{"detectedBubbles", ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "1"}], "&"}]}], "]"}], "/", 
       RowBox[{"assessDamage", "[", 
        RowBox[{"extract", ",", 
         RowBox[{
          RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}]}]}], "//", 
     "N"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"intensityFilterCasualties", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"assessAcceptance", "[", 
       RowBox[{"acceptanceMap", ",", 
        RowBox[{
         RowBox[{"#", "\[Equal]", "False"}], "&"}]}], "]"}], "/", 
      RowBox[{"Length", "@", 
       RowBox[{"Flatten", "@", "acceptanceMap"}]}]}], "//", "N"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"propertyFilterCasualties", "=", 
    RowBox[{
     RowBox[{"1", "-", 
      RowBox[{
       RowBox[{"assessAcceptance", "[", 
        RowBox[{"actualBubbles", ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "1"}], "&"}]}], "]"}], "/", 
       "\[IndentingNewLine]", 
       RowBox[{"assessAcceptance", "[", 
        RowBox[{"filteredObjects", ",", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "1"}], "&"}]}], "]"}]}]}], "//", "N"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"casualtyReport", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "MRIFcasualties", ",", "\[IndentingNewLine]", 
      "intensityFilterCasualties", ",", "\[IndentingNewLine]", 
      "propertyFilterCasualties"}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"survivors", "=", 
    RowBox[{"Times", "@@", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "#"}], ")"}], "&"}], "/@", "casualtyReport"}], 
      "\[IndentingNewLine]", ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"totalCasualties", "=", 
    RowBox[{"1", "-", "survivors"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullReport", "=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{"casualtyReport", ",", 
      RowBox[{"{", 
       RowBox[{"totalCasualties", ",", "survivors", ",", "zeroObjectsFound"}],
        "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PercentForm", "/@", "fullReport"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7733215040566397`*^9, 3.773321525118285*^9}, 
   3.7819654915955305`*^9, {3.782024197306452*^9, 3.7820241978181353`*^9}, {
   3.8081555851381006`*^9, 3.8081555867828307`*^9}, {3.8081556313972545`*^9, 
   3.8081556323447847`*^9}, {3.808155707105285*^9, 3.808155779751148*^9}, 
   3.8081558354695196`*^9, {3.808156296778544*^9, 3.8081563025497417`*^9}, {
   3.8081563931734514`*^9, 3.80815644555509*^9}, {3.808156512596884*^9, 
   3.808156530003205*^9}, {3.8081566302000017`*^9, 3.8081566700367947`*^9}, {
   3.808156797545255*^9, 3.8081568329764423`*^9}, {3.80815688812397*^9, 
   3.8081569106429195`*^9}, {3.8081569957909346`*^9, 
   3.8081570207478633`*^9}, {3.808157077769152*^9, 3.808157087418497*^9}, {
   3.8081575918657274`*^9, 3.8081575997097816`*^9}, 3.808157631568273*^9, {
   3.8081576647894974`*^9, 3.8081576822444825`*^9}, {3.8081577214722967`*^9, 
   3.8081578564851723`*^9}, {3.8082087877679367`*^9, 
   3.8082087907680235`*^9}, {3.8082090451801047`*^9, 3.808209073605894*^9}, {
   3.8082091379598475`*^9, 3.8082091437892656`*^9}, {3.8082106509496965`*^9, 
   3.808210667561327*^9}, {3.8082108332171307`*^9, 3.808210851382708*^9}, 
   3.8082109148337383`*^9, {3.8091078792883096`*^9, 3.8091078874502664`*^9}, {
   3.8091079272388334`*^9, 3.809107928955237*^9}, {3.80910796577101*^9, 
   3.809107972041623*^9}, {3.8091132707784705`*^9, 3.809113284865754*^9}, 
   3.8091217511211867`*^9, 3.8091225257244363`*^9, {3.8091719758462214`*^9, 
   3.809171976800668*^9}, {3.8091720393304553`*^9, 3.8091720874216223`*^9}},
 CellLabel->
  "In[1187]:=",ExpressionUUID->"55331abd-306f-49f1-9c1a-1e17530f804f"],

Cell[CellGroupData[{

Cell["Filtered False Positives", "Subsubsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
  3.760170896953659*^9, 3.7601709031790094`*^9}, {3.7602506548965907`*^9, 
  3.760250655708435*^9}, {3.760250902949319*^9, 3.760250903588627*^9}, {
  3.7603536058963194`*^9, 3.760353609377013*^9}, {3.769226895868867*^9, 
  3.7692269030925465`*^9}, {3.769227398227599*^9, 
  3.769227440639165*^9}},ExpressionUUID->"80cdbfe7-e6e7-4433-a2df-\
13a4e1e13482"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<Data Extraction Efficiency.txt\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", "fullReport"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.773321582038931*^9, 3.773321674692361*^9}, 
   3.7819648081314125`*^9, 3.7819656987115493`*^9, 3.782024199008398*^9, 
   3.808155872712623*^9, {3.8081568499778366`*^9, 3.8081568509143267`*^9}, 
   3.8082064221895857`*^9},
 CellLabel->
  "In[1196]:=",ExpressionUUID->"a2f38253-986d-421c-aad7-2ffc4d6b250c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Data For Tracing >>", "Subsection",
 CellChangeTimes->{{3.760170781307646*^9, 3.760170821065774*^9}, {
   3.760170896953659*^9, 3.7601709031790094`*^9}, {3.7602506548965907`*^9, 
   3.760250655708435*^9}, {3.760250902949319*^9, 3.760250903588627*^9}, {
   3.7603536058963194`*^9, 3.760353609377013*^9}, 3.769227420389349*^9, {
   3.807795164744633*^9, 
   3.8077951804485407`*^9}},ExpressionUUID->"f776727f-472d-4406-8c00-\
b48fd8506d11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tracerInputBubbles", "[", 
   RowBox[{"dataset_", ",", "parameters_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"shiftID", "=", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"m", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"Flatten", "@", 
               RowBox[{
               "Delete", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"dataset", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", ",", "k"}], "]"}], "]"}], ",", "1"}], 
                  "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"{", "1", "}"}], "}"}], ",", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Position", "[", "\n", 
                    RowBox[{"parameters", ",", "\n", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "==", "\"\<Image\>\""}], "||", 
                    RowBox[{"#", "==", "\"\<SemiAxes\>\""}]}], "&"}], 
                    ")"}]}]}], "\n", "]"}], "+", "shiftID"}]}], 
                  "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"dataset", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "1", ",", 
            RowBox[{"Length", "@", "dataset"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ListQ", "@", "#"}], "\[Equal]", "False"}], "&"}], 
         ")"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], "//", 
   "Quiet"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.808211606017293*^9, 3.8082116090195165`*^9}, {
   3.8082116486429996`*^9, 3.8082116713951926`*^9}, {3.8082117085120335`*^9, 
   3.8082118467876697`*^9}, {3.808211892545402*^9, 3.808211895354042*^9}, {
   3.808211964249071*^9, 3.8082119654567037`*^9}, {3.8082121566159835`*^9, 
   3.808212163273455*^9}, {3.808212281274626*^9, 3.808212305014526*^9}, {
   3.8082124573522716`*^9, 3.808212468280863*^9}, {3.8082125396610756`*^9, 
   3.8082125509173193`*^9}, {3.8082126264287677`*^9, 3.808212692677114*^9}, {
   3.808212768987544*^9, 3.8082127703568163`*^9}, {3.8082128219552937`*^9, 
   3.8082128879828997`*^9}, {3.808212926827403*^9, 3.80821314511597*^9}, {
   3.8082132974136896`*^9, 3.8082132983142786`*^9}, 3.8082134889109244`*^9, {
   3.8082141256175556`*^9, 3.8082141517593822`*^9}, {3.8082142960048976`*^9, 
   3.808214317555377*^9}, {3.8082143483978643`*^9, 3.8082143743142395`*^9}, {
   3.8082144157310553`*^9, 3.808214477019102*^9}, {3.8082145465220833`*^9, 
   3.8082145728173647`*^9}, {3.809121407187107*^9, 3.8091214374210978`*^9}, {
   3.8091217704807377`*^9, 3.8091217740741143`*^9}},
 CellLabel->
  "In[1197]:=",ExpressionUUID->"9faa1a79-b583-49b7-8947-c3bd2359e66d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<Tracer Input.txt\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", 
     RowBox[{"tracerInputBubbles", "[", 
      RowBox[{"actualBubbles", ",", "bubbleParameters"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.798716336045472*^9, 3.7987163784538975`*^9}, {
   3.798716484673237*^9, 3.7987165077582607`*^9}, {3.798716715607695*^9, 
   3.7987167431510496`*^9}, {3.7987167943731184`*^9, 3.798716844062994*^9}, {
   3.7987258915524864`*^9, 3.7987259042125263`*^9}, 3.7987355734753637`*^9, {
   3.8038417982780266`*^9, 3.8038418070856056`*^9}, {3.803886533898099*^9, 
   3.803886537912629*^9}, {3.803886630081352*^9, 3.8038866321280937`*^9}, {
   3.8038867008477135`*^9, 3.803886704042746*^9}, {3.8041700384055557`*^9, 
   3.8041700428648057`*^9}, 3.804170335741046*^9, 3.8082148766266594`*^9, {
   3.8091238221487427`*^9, 3.8091238300626717`*^9}},
 CellLabel->
  "In[1198]:=",ExpressionUUID->"b7d541e8-87c3-4dd2-bf76-99633f16b2d7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bubble Shape Statistics", "Section",
 CellChangeTimes->{{3.7600781788884287`*^9, 3.7600783995902357`*^9}, {
   3.7600784333729677`*^9, 3.7600784366320295`*^9}, {3.7600784966060867`*^9, 
   3.7600785787330112`*^9}, 3.7600787034230433`*^9, {3.7600810320525403`*^9, 
   3.7600810340443735`*^9}, {3.760081213527526*^9, 3.760081227965257*^9}, {
   3.760081453892193*^9, 3.760081456923087*^9}, {3.760081593756274*^9, 
   3.760081594350707*^9}, 3.760085294459019*^9, {3.7600992506048307`*^9, 
   3.7600992780434504`*^9}, 3.7601610300147495`*^9, 3.760161930493473*^9, {
   3.760162617031291*^9, 3.760162632328903*^9}, {3.7602793046528463`*^9, 
   3.7602793080717*^9}},ExpressionUUID->"a62d7327-78b1-4b65-ab3f-\
5c2e590aff1c"],

Cell[CellGroupData[{

Cell["Equivalent Radii, Eccentricity & Aspect Ratio", "Subsection",
 CellChangeTimes->{{3.760250920217156*^9, 
  3.7602509476386194`*^9}},ExpressionUUID->"ace74f6f-015b-4134-92ea-\
b380b60b5321"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"stats", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"5", ";;", "7"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"tracerInputBubbles", "[", 
       RowBox[{"actualBubbles", ",", "bubbleParameters"}], "]"}]}], "//", 
     "Transpose"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"radii", ",", "areas", ",", "eccentricity"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"unitConversion", ",", "\[IndentingNewLine]", 
         RowBox[{"unitConversion", "^", "2"}], ",", "\[IndentingNewLine]", 
         "1"}], "\[IndentingNewLine]", "}"}], "*", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
      "&"}], "@", "stats"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aspectRatio", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"#", "^", "2"}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ")"}]}], "&"}], "/@", 
    "eccentricity"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.809123021954521*^9, 3.8091230465951176`*^9}, {
  3.809123235195341*^9, 3.809123244724038*^9}, {3.8091232939461875`*^9, 
  3.8091233247878675`*^9}, {3.809123369497078*^9, 3.8091233727169986`*^9}, {
  3.809123569149434*^9, 3.809123571696597*^9}, {3.8091237409116364`*^9, 
  3.809123741422209*^9}},
 CellLabel->
  "In[1199]:=",ExpressionUUID->"db3ad4e0-3fd1-4425-a7fb-972dd5ea0163"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Data >>", "Subsection",
 CellChangeTimes->{{3.760279567027047*^9, 3.7602795773055716`*^9}, {
  3.760341259882349*^9, 
  3.7603412630987453`*^9}},ExpressionUUID->"e57ffc5c-12eb-4288-81e0-\
153fa945ea11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<Radii Areas Eccentricity.txt\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", 
     RowBox[{"{", 
      RowBox[{"radii", ",", "areas", ",", "eccentricity"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7602784666729693`*^9, 3.7602785224706163`*^9}, {
   3.760279210386878*^9, 3.760279248514292*^9}, {3.760279317172418*^9, 
   3.7602793633408585`*^9}, {3.760279587077422*^9, 3.7602795871462407`*^9}, 
   3.7604542959923363`*^9, {3.7604547764556074`*^9, 3.760454781032343*^9}, {
   3.7604549532406206`*^9, 3.760454963168089*^9}, {3.76067649710008*^9, 
   3.7606764976117077`*^9}, {3.7608924710602846`*^9, 3.760892475638091*^9}, 
   3.7609293121579776`*^9, {3.773322414853552*^9, 3.773322418352173*^9}, 
   3.781964810515518*^9, 3.782024559031142*^9, 3.7820246216458664`*^9, {
   3.808237843670707*^9, 3.8082378518128595`*^9}, 3.8082380180164895`*^9, {
   3.8091237791172895`*^9, 3.809123795870758*^9}},
 CellLabel->
  "In[1202]:=",ExpressionUUID->"bedd483f-6bcb-4423-8573-1ca60d679817"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialize from Imported Data", "Subsection",
 CellChangeTimes->{{3.760250920217156*^9, 3.7602509476386194`*^9}, {
  3.7743538411474037`*^9, 
  3.774353848434904*^9}},ExpressionUUID->"5b5e9ecf-5369-4925-b118-\
c3d1ca9b4e16"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"preProcessedData", "=", 
    RowBox[{"Uncompress", "@", 
     RowBox[{"Import", "[", "\[IndentingNewLine]", 
      RowBox[{"importData", "<>", "\"\<Radii Areas Eccentricity.txt\>\""}], 
      "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"radii", "=", 
    RowBox[{"First", "@", "preProcessedData"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"eccentricity", "=", 
    RowBox[{"preProcessedData", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"aspectRatio", "=", 
    RowBox[{"Last", "@", "preProcessedData"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.774353749203143*^9, 3.774353796419976*^9}, 
   3.774353882667982*^9, 3.7743539661148806`*^9, 3.7819644878398113`*^9, 
   3.7820245736121144`*^9, {3.7820246242942266`*^9, 3.7820246533953457`*^9}, {
   3.80224848930777*^9, 3.8022484904168015`*^9}, {3.8082380045247355`*^9, 
   3.8082380101556263`*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"130815c2-1265-4418-9a03-f5d12833fe9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Means & Standard Deviations", "Subsection",
 CellChangeTimes->{{3.760250979119912*^9, 3.7602509942716255`*^9}, {
  3.760251079027931*^9, 
  3.7602510851067486`*^9}},ExpressionUUID->"cc304fb7-4ad8-46e5-8188-\
3fa52fcc330f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"string1", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "@", 
   RowBox[{"Mean", "@", "x"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"string2", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{"100", "*", 
    RowBox[{
     RowBox[{"StandardDeviation", "@", "x"}], "/", 
     RowBox[{"Mean", "@", "x"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"char", "=", 
   RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Radius: \>\"", "<>", 
      RowBox[{"string1", "@", "radii"}], " ", "<>", "\"\< mm \>\"", "<>", 
      "\"\<\[PlusMinus] \>\"", "<>", 
      RowBox[{"string2", "@", "radii"}], " ", "<>", "\"\< %\>\""}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\"\<Area: \>\"", "<>", 
      RowBox[{"string1", "@", "areas"}], "<>", 
      "\"\< \!\(\*SuperscriptBox[\(mm\), \(2\)]\) \>\"", "<>", 
      "\"\<\[PlusMinus] \>\"", "<>", 
      RowBox[{"string2", "@", "areas"}], " ", "<>", "\"\< %\>\""}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<Eccentricity: \>\"", "<>", 
       RowBox[{"string1", "@", "eccentricity"}]}], 
      RowBox[{"\"\< \>\"", "<>", "\"\<\[PlusMinus] \>\"", "<>", 
       RowBox[{"string2", "@", "eccentricity"}], " ", "<>", 
       "\"\< %\>\""}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7600815960461493`*^9, 3.7600817150277224`*^9}, {
   3.760102324304635*^9, 3.7601023263591194`*^9}, {3.7601628767560906`*^9, 
   3.7601629974235954`*^9}, {3.7601630427030745`*^9, 3.760163148054846*^9}, {
   3.7601632149340096`*^9, 3.760163274420928*^9}, {3.760163368221089*^9, 
   3.7601634307229357`*^9}, {3.7601634998547173`*^9, 3.760163527042008*^9}, {
   3.760177761270328*^9, 3.7601777654890676`*^9}, {3.7601796564287214`*^9, 
   3.760179691662498*^9}, {3.760454414210601*^9, 3.760454520033403*^9}, {
   3.760454552572418*^9, 3.7604545602416368`*^9}, {3.7606946611096563`*^9, 
   3.760694661664174*^9}, {3.7609586503391476`*^9, 3.760958651151976*^9}, {
   3.7669434924297433`*^9, 3.7669435081990128`*^9}, {3.769223676189348*^9, 
   3.7692236906835623`*^9}, 3.774351097726406*^9, {3.782024576046607*^9, 
   3.782024577484717*^9}, {3.782024625340579*^9, 3.7820246262130384`*^9}, {
   3.782024671837757*^9, 3.782024682979498*^9}, {3.8082380603986464`*^9, 
   3.8082380660361567`*^9}, {3.8082382534504776`*^9, 
   3.8082382573461123`*^9}, {3.8082383650520287`*^9, 3.8082383728581305`*^9}, 
   3.8082384760193357`*^9, {3.8083196226760406`*^9, 3.8083196242627296`*^9}, 
   3.809207740826882*^9},
 CellLabel->
  "In[1203]:=",ExpressionUUID->"fdef8ec3-1844-4dee-8303-0fed011f9137"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ Sequence Histograms ]]", "Subsection",
 CellChangeTimes->{{3.760251091773941*^9, 3.760251105182669*^9}, {
  3.76034124817865*^9, 
  3.760341252771389*^9}},ExpressionUUID->"91793c95-5d42-4c1c-b5d2-\
e5eb97dbdd49"],

Cell[BoxData[{
 RowBox[{"histogramLabel", ":=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<r, mm\>\"", ",", "\"\<N\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<S, \!\(\*SuperscriptBox[\(mm\), \(2\)]\)\>\"", ",", "\"\<N\>\""}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\"\<a/b\>\"", ",", "\"\<N\>\""}], "}"}]}], 
   "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"statsSets", ":=", 
  RowBox[{"{", 
   RowBox[{"radii", ",", "areas", ",", "eccentricity"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numberOfColumns", "=", "25"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"k", "=", "1"}], ",", 
   RowBox[{"k", "\[LessEqual]", "3"}], ",", 
   RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"histogram", "[", "k", "]"}], "=", 
     RowBox[{"Histogram", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"statsSets", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Raw\>\"", ",", "numberOfColumns"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"histogramLabel", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"char", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Print", "@", 
     RowBox[{"histogram", "[", "k", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.760175350465681*^9, 3.760175410950226*^9}, {
   3.7601755352146206`*^9, 3.7601755837240505`*^9}, {3.760177160640563*^9, 
   3.760177179197315*^9}, {3.760177335610431*^9, 3.760177421860868*^9}, {
   3.7601778132661953`*^9, 3.760177918230587*^9}, {3.7601779869250593`*^9, 
   3.7601779992750726`*^9}, {3.760178044334377*^9, 3.760178100736888*^9}, {
   3.7601782036768703`*^9, 3.760178253121284*^9}, {3.760178501854521*^9, 
   3.760178623676265*^9}, {3.760178658281484*^9, 3.7601786641600447`*^9}, {
   3.7601787146979322`*^9, 3.760178807795167*^9}, {3.760178852782853*^9, 
   3.760178891203663*^9}, {3.7601789239132776`*^9, 3.7601790216160374`*^9}, {
   3.7601791056541643`*^9, 3.7601791653721704`*^9}, {3.7601791976000338`*^9, 
   3.7601792265421762`*^9}, {3.760179261973618*^9, 3.7601792666114388`*^9}, {
   3.7601793058030324`*^9, 3.7601793643039975`*^9}, {3.7601794283019753`*^9, 
   3.76017944785635*^9}, {3.760179540236863*^9, 3.7601795842534432`*^9}, {
   3.7601796211490774`*^9, 3.7601796538775496`*^9}, {3.760179701159214*^9, 
   3.7601797858730927`*^9}, {3.7601798973161383`*^9, 3.760179938895937*^9}, {
   3.7601799864385653`*^9, 3.760179996019515*^9}, {3.7601800718072596`*^9, 
   3.760180082721159*^9}, {3.7601801442493258`*^9, 3.7601801445415215`*^9}, {
   3.7601803332629604`*^9, 3.760180335980688*^9}, {3.7601803878142405`*^9, 
   3.7601804178489504`*^9}, {3.7601804971332517`*^9, 3.760180533330844*^9}, {
   3.7601806341786394`*^9, 3.7601806461400476`*^9}, {3.7601807229878917`*^9, 
   3.7601807283885217`*^9}, {3.7601810625987387`*^9, 3.760181086946849*^9}, {
   3.760182256667038*^9, 3.7601822706177287`*^9}, {3.760182426338513*^9, 
   3.7601824536592636`*^9}, {3.7602510204674597`*^9, 
   3.7602510461968403`*^9}, {3.7602744710067883`*^9, 3.76027447322186*^9}, {
   3.760279735609033*^9, 3.7602797401239643`*^9}, {3.7602798276338863`*^9, 
   3.7602798293868446`*^9}, {3.760455002527397*^9, 3.7604551489692726`*^9}, {
   3.760455815810978*^9, 3.7604558172860546`*^9}, {3.7609299460716944`*^9, 
   3.7609299488791637`*^9}, 3.7820245792146444`*^9, 3.7820246272044244`*^9, {
   3.7820247093980913`*^9, 3.7820247445891857`*^9}, {3.8082382118104787`*^9, 
   3.8082382342269697`*^9}, {3.808238421953901*^9, 3.808238445380505*^9}, {
   3.808319664050687*^9, 3.808319689208083*^9}},
 CellLabel->
  "In[1206]:=",ExpressionUUID->"b9e2bfc0-c732-4455-9af9-bdba468c25ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Histograms >>", "Subsection",
 CellChangeTimes->{{3.7602798683944836`*^9, 3.7602798774473085`*^9}, {
  3.7603412142174835`*^9, 
  3.760341216451516*^9}},ExpressionUUID->"0087650c-c7e8-4d1e-9e2f-\
53e4e376bc83"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"output", "<>", 
       RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.jpg\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"histogram", "[", "#", "]"}], ",", 
      RowBox[{"ImageResolution", "\[Rule]", "450"}]}], "\[IndentingNewLine]", 
     "]"}], "&"}], "/@", 
   RowBox[{"Range", "@", 
    RowBox[{"Length", "@", "statsSets"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.760279744287943*^9, 3.7602798032261047`*^9}, {
   3.760279865968474*^9, 3.760279867026623*^9}, {3.7604547935400624`*^9, 
   3.7604548005551662`*^9}, {3.7606765012829447`*^9, 
   3.7606765016041107`*^9}, {3.7608925154462566`*^9, 3.760892517057925*^9}, 
   3.760929314118787*^9, {3.766943581336278*^9, 3.7669435845114098`*^9}, 
   3.7819648135466423`*^9, 3.7820247457304783`*^9, {3.8092077586148577`*^9, 
   3.809207799858183*^9}},
 CellLabel->
  "In[1211]:=",ExpressionUUID->"0e3780af-4b57-4412-a5f9-82e2c82d27e2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bubble Velocimetry", "Section",
 CellChangeTimes->{{3.751958014864146*^9, 3.7519580276143217`*^9}, {
  3.760251127170804*^9, 3.7602511292422657`*^9}, {3.760711512885963*^9, 
  3.7607115349594793`*^9}},ExpressionUUID->"8ae1f463-c8fb-499c-b2a1-\
24304542d30e"],

Cell[CellGroupData[{

Cell["Read Centroids", "Subsection",
 CellChangeTimes->{{3.7602650029426937`*^9, 
  3.7602650161429205`*^9}},ExpressionUUID->"58498ae9-6fae-4c0c-9ae1-\
e65c58fb633c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bubbleLocations", "=", 
    RowBox[{"cleanCentroids", "/.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], "\[Rule]", "Nothing"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", "bubbleLocations"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7518088336554112`*^9, 3.751808833778096*^9}, {
   3.7518707643405304`*^9, 3.751870764439286*^9}, {3.7518711597673645`*^9, 
   3.7518711607328043`*^9}, {3.7518792237685976`*^9, 
   3.7518792238324265`*^9}, {3.7518825599013352`*^9, 3.7518825624953775`*^9}, 
   3.7519511591041346`*^9, {3.7519512098449535`*^9, 3.751951209991594*^9}, {
   3.7519513709397383`*^9, 3.75195150932121*^9}, {3.751951963951079*^9, 
   3.7519519684484987`*^9}, {3.7519521827949553`*^9, 3.751952183263075*^9}, {
   3.7519522576471825`*^9, 3.7519522580787134`*^9}, {3.7519546762745113`*^9, 
   3.751954676520849*^9}, {3.7519574161153555`*^9, 3.7519574210930443`*^9}, {
   3.751957545783086*^9, 3.75195754924483*^9}, 3.751957660027594*^9, {
   3.751958034211364*^9, 3.7519580345101724`*^9}, {3.7519863722352495`*^9, 
   3.7519863724137506`*^9}, {3.7519869491964626`*^9, 3.75198696429519*^9}, {
   3.7519873139141493`*^9, 3.751987332717868*^9}, {3.751987552702552*^9, 
   3.7519875543162217`*^9}, {3.751988231279371*^9, 3.7519882324741793`*^9}, {
   3.7519883625543118`*^9, 3.7519883990676603`*^9}, {3.7519884533009815`*^9, 
   3.75198848059398*^9}, {3.7519885114773865`*^9, 3.7519885328013344`*^9}, 
   3.751988640756645*^9, {3.751989079749445*^9, 3.7519891191171675`*^9}, {
   3.752000908491932*^9, 3.752000959249769*^9}, {3.752000993594683*^9, 
   3.7520009971974716`*^9}, {3.7520017268431053`*^9, 3.752001737669013*^9}, {
   3.75200242175712*^9, 3.7520024265268517`*^9}, {3.7523847952380543`*^9, 
   3.752384796668471*^9}, {3.75993656579086*^9, 3.7599366108784857`*^9}, {
   3.7601867319423285`*^9, 3.760186794045266*^9}, {3.760256593945408*^9, 
   3.760256603309383*^9}, {3.781965498187523*^9, 3.781965500786792*^9}, {
   3.7820247722602515`*^9, 3.782024773084741*^9}, {3.78202482185491*^9, 
   3.782024823880656*^9}, {3.806261742517768*^9, 3.8062617429300632`*^9}, {
   3.806355506125975*^9, 3.806355513516697*^9}, {3.8069620654650006`*^9, 
   3.806962066936877*^9}, {3.8076356091137843`*^9, 3.8076356118085747`*^9}, {
   3.8077067315258875`*^9, 3.8077067352368984`*^9}, {3.808238518823579*^9, 
   3.8082385521679535`*^9}, {3.808308368278743*^9, 3.808308424522052*^9}, {
   3.808309587244427*^9, 3.808309591335462*^9}},
 CellLabel->
  "In[1212]:=",ExpressionUUID->"e1437631-fb9e-4918-8a5c-fe852a75f669"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Frame Centroids >>", "Subsection",
 CellChangeTimes->{{3.760437682201171*^9, 
  3.7604377195430613`*^9}},ExpressionUUID->"e7081559-9768-4d4f-a5fc-\
dd47ea61101b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<Frame Centroids.txt\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", "bubbleLocations"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7605966533179016`*^9, 3.7605967705673075`*^9}, {
   3.7605968110366945`*^9, 3.7605969719424133`*^9}, {3.760597050899418*^9, 
   3.760597133012791*^9}, 3.7605972418859916`*^9, {3.760597274785719*^9, 
   3.7605972767683353`*^9}, {3.760597315556157*^9, 3.760597333342108*^9}, {
   3.7606765375568223`*^9, 3.760676538483344*^9}, {3.760900011747959*^9, 
   3.7609000171915903`*^9}, 3.7609293166229477`*^9, 3.781964816865962*^9, 
   3.782024774202049*^9},
 CellLabel->
  "In[1214]:=",ExpressionUUID->"9cd32f1e-2880-40a4-947a-462fb7664c7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Frame Pair Sets", "Subsection",
 CellChangeTimes->{{3.760265021596336*^9, 
  3.760265044382795*^9}},ExpressionUUID->"4a395079-7eba-40d3-bd5a-\
41a98958e6e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"centroidPairs", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Join", "@", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bubbleLocations", "[", 
           RowBox[{"[", 
            RowBox[{"k", "-", "1"}], "]"}], "]"}], ",", 
          RowBox[{"bubbleLocations", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
       "\[IndentingNewLine]", ",", "1"}], "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "2", ",", 
       RowBox[{"bubbleLocations", "//", "Length"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7601885486572423`*^9, 3.7601885732405043`*^9}, {
   3.76018868520563*^9, 3.760188693373786*^9}, {3.7601889493194156`*^9, 
   3.7601889508772235`*^9}, {3.7601892308883724`*^9, 3.760189232596834*^9}, {
   3.760189400071746*^9, 3.760189471201542*^9}, {3.760189513159918*^9, 
   3.7601895470014153`*^9}, 3.760190073221773*^9, {3.760257397959637*^9, 
   3.7602573981611247`*^9}, {3.7602710327066317`*^9, 
   3.7602710476429024`*^9}, {3.7602721965950766`*^9, 
   3.7602721967995024`*^9}, {3.767014257329146*^9, 3.7670142584720907`*^9}, {
   3.7820247751734476`*^9, 3.782024777098257*^9}, 3.78202484583346*^9},
 CellLabel->
  "In[1215]:=",ExpressionUUID->"98305265-f550-4478-9938-f88e58799674"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Coordinate Differences & Centroids For Bubble Pairs", \
"Subsection",
 CellChangeTimes->{{3.760265089590619*^9, 3.7602651172628264`*^9}, {
  3.7602700926475096`*^9, 3.7602701003668647`*^9}, {3.7614776973239202`*^9, 
  3.761477734763424*^9}, {3.761480228001358*^9, 
  3.7614802384309435`*^9}},ExpressionUUID->"d493a0b3-ed93-4a8c-8ed9-\
f29462b02be4"],

Cell["Possible Improvements", "Abstract",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
  3.769158606943906*^9, 3.7691586572504983`*^9}, {3.7692223025981207`*^9, 
  3.769222339641034*^9}},ExpressionUUID->"c74eed73-6eef-438d-bf41-\
8f2b7039fc39"],

Cell["Add more & better filtering criteria", "Subitem",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
   3.769158606943906*^9, 3.7691586572504983`*^9}, 3.7692223043414335`*^9, {
   3.769222342585159*^9, 3.769222345000705*^9}, {3.769230882123254*^9, 
   3.769230908195506*^9}},ExpressionUUID->"827a1617-de03-4469-9592-\
ce90d10e5355"],

Cell[BoxData[{
 RowBox[{"radiusMultiplier", ":=", "2"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"displacementLimit", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"radiusMultiplier", "/", "unitConversion"}], ")"}], "*", 
    RowBox[{"Mean", "@", "radii"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7601882565956335`*^9, 3.7601883061848087`*^9}, {
   3.7601883517918644`*^9, 3.7601884101454053`*^9}, {3.760188452592467*^9, 
   3.7601884668011336`*^9}, {3.7601885783448462`*^9, 
   3.7601886265419273`*^9}, {3.7601887051183763`*^9, 3.760188936697164*^9}, {
   3.760188975100463*^9, 3.7601892252863755`*^9}, {3.7601892617987337`*^9, 
   3.760189285122864*^9}, {3.7601895582483096`*^9, 3.760189635470788*^9}, {
   3.760189668993168*^9, 3.76018995004317*^9}, {3.760190003443381*^9, 
   3.7601900424221525`*^9}, {3.760190151534359*^9, 3.7601902146381497`*^9}, {
   3.760190628131642*^9, 3.760190628619199*^9}, {3.760251254768427*^9, 
   3.760251312427389*^9}, {3.7602513671579957`*^9, 3.7602513680246797`*^9}, {
   3.7602566846084166`*^9, 3.760256685422227*^9}, {3.76025755235266*^9, 
   3.7602575701516523`*^9}, {3.7602578207366314`*^9, 
   3.7602578501256123`*^9}, {3.760259104158413*^9, 3.760259107944938*^9}, {
   3.760259364395308*^9, 3.7602593674851704`*^9}, {3.760259453370038*^9, 
   3.7602594708609076`*^9}, {3.7602623310953608`*^9, 3.760262341093152*^9}, {
   3.7602638221249847`*^9, 3.7602639464004793`*^9}, {3.760264184333843*^9, 
   3.76026422819639*^9}, {3.7602667455401*^9, 3.760266762986936*^9}, {
   3.760266937763204*^9, 3.760266947338697*^9}, {3.7602671013002186`*^9, 
   3.7602671058481846`*^9}, {3.760267756338916*^9, 3.7602679339942675`*^9}, {
   3.7604553276200686`*^9, 3.760455340186301*^9}, 3.7604559137945766`*^9, 
   3.76045594685951*^9, {3.7604560028374343`*^9, 3.7604560163781595`*^9}, {
   3.761285949025632*^9, 3.761285951067527*^9}, 3.76147757930049*^9, {
   3.761477798556512*^9, 3.7614778339760885`*^9}, {3.7614796007641916`*^9, 
   3.7614796312008853`*^9}, {3.76147973016271*^9, 3.7614797366321626`*^9}, {
   3.761480249339246*^9, 3.761480250794938*^9}, {3.766942856525213*^9, 
   3.766942873288869*^9}, {3.7669928353849735`*^9, 3.7669928382328053`*^9}, 
   3.781965364381022*^9, {3.782024847244586*^9, 3.7820249380595245`*^9}, {
   3.782024969331477*^9, 3.7820250335698285`*^9}, 3.7821382761428556`*^9, {
   3.80225043533183*^9, 3.802250435415623*^9}, {3.8022504732218018`*^9, 
   3.8022504737014985`*^9}, 3.8022505232209744`*^9, 3.806121219528623*^9, {
   3.8073495777291365`*^9, 3.8073495797909393`*^9}, {3.808565314180678*^9, 
   3.808565314539747*^9}, 3.808565349555147*^9},
 CellLabel->
  "In[1216]:=",ExpressionUUID->"2408580a-a157-4a2a-8120-6c54b5084dbb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"k", "=", "1"}], ",", 
     RowBox[{"k", "\[LessEqual]", 
      RowBox[{"Length", "@", "centroidPairs"}]}], ",", 
     RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"centroidPairs", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], "\[NotEqual]", "0"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pairCombinations", "=", 
         RowBox[{"Subsets", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"centroidPairs", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ascendingCombinations", "=", 
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Reverse", "@", 
             RowBox[{"SortBy", "[", 
              RowBox[{"#", ",", "Last"}], "]"}]}], "&"}], ",", 
           "\[IndentingNewLine]", "pairCombinations"}], "\[IndentingNewLine]",
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"centroidDisplacement", "=", 
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"First", "@", "#"}], "-", 
             RowBox[{"Last", "@", "#"}]}], "&"}], ",", "\[IndentingNewLine]", 
           "ascendingCombinations"}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"velocityLocation", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"Mean", ",", "pairCombinations"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"velocitySet", "[", "k", "]"}], "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Norm", "@", 
               RowBox[{"centroidDisplacement", "[", 
                RowBox[{"[", "m", "]"}], "]"}]}], "<", "displacementLimit"}], 
             ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Flatten", "@", "\[IndentingNewLine]", 
                RowBox[{"Join", "@", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"velocityLocation", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"centroidDisplacement", "[", 
                    RowBox[{"[", "m", "]"}], "]"}]}], "\[IndentingNewLine]", 
                  "}"}]}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Norm", "@", 
                RowBox[{"centroidDisplacement", "[", 
                 RowBox[{"[", "m", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
              "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "Nothing"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"m", ",", "1", ",", 
             RowBox[{"velocityLocation", "//", "Length"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"velocitySet", "[", "k", "]"}], "=", 
         RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}], "//", "Quiet"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"frameVelocityVectors", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"velocitySet", "[", "k", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"centroidPairs", "//", "Length"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameData", "=", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
      RowBox[{"frameVelocityVectors", ",", "\[IndentingNewLine]", 
       RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", "1"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7601882565956335`*^9, 3.7601883061848087`*^9}, {
   3.7601883517918644`*^9, 3.7601884101454053`*^9}, {3.760188452592467*^9, 
   3.7601884668011336`*^9}, {3.7601885783448462`*^9, 
   3.7601886265419273`*^9}, {3.7601887051183763`*^9, 3.760188936697164*^9}, {
   3.760188975100463*^9, 3.7601892252863755`*^9}, {3.7601892617987337`*^9, 
   3.760189285122864*^9}, {3.7601895582483096`*^9, 3.760189635470788*^9}, {
   3.760189668993168*^9, 3.76018995004317*^9}, {3.760190003443381*^9, 
   3.7601900424221525`*^9}, {3.760190151534359*^9, 3.7601902146381497`*^9}, {
   3.760190628131642*^9, 3.760190628619199*^9}, {3.760251254768427*^9, 
   3.760251312427389*^9}, {3.7602513671579957`*^9, 3.7602513680246797`*^9}, {
   3.7602566846084166`*^9, 3.760256685422227*^9}, {3.76025755235266*^9, 
   3.7602575701516523`*^9}, {3.7602578207366314`*^9, 
   3.7602578501256123`*^9}, {3.760259104158413*^9, 3.760259107944938*^9}, {
   3.760259364395308*^9, 3.7602593674851704`*^9}, {3.760259453370038*^9, 
   3.7602594708609076`*^9}, {3.7602623310953608`*^9, 3.760262341093152*^9}, {
   3.7602638221249847`*^9, 3.7602639464004793`*^9}, {3.760264184333843*^9, 
   3.76026422819639*^9}, {3.7602667455401*^9, 3.760266762986936*^9}, {
   3.760266937763204*^9, 3.760266947338697*^9}, {3.7602671013002186`*^9, 
   3.7602671058481846`*^9}, {3.760267756338916*^9, 3.7602679339942675`*^9}, {
   3.7604553276200686`*^9, 3.760455340186301*^9}, 3.7604559137945766`*^9, 
   3.76045594685951*^9, {3.7604560028374343`*^9, 3.7604560163781595`*^9}, {
   3.761285949025632*^9, 3.761285951067527*^9}, 3.76147757930049*^9, {
   3.761477798556512*^9, 3.7614778339760885`*^9}, {3.7614796007641916`*^9, 
   3.7614796312008853`*^9}, {3.76147973016271*^9, 3.7614797366321626`*^9}, {
   3.761480249339246*^9, 3.761480250794938*^9}, {3.766942856525213*^9, 
   3.766942873288869*^9}, {3.7669928353849735`*^9, 3.7669928382328053`*^9}, 
   3.781965364381022*^9, {3.782024847244586*^9, 3.7820249380595245`*^9}, {
   3.782024969331477*^9, 3.7820250335698285`*^9}, 3.7821382761428556`*^9, {
   3.80225043533183*^9, 3.802250435415623*^9}, {3.8022504732218018`*^9, 
   3.8022504737014985`*^9}, 3.8022505232209744`*^9, 3.806121219528623*^9, {
   3.8073495777291365`*^9, 3.8073495828372707`*^9}, {3.8083084894127474`*^9, 
   3.8083085237895613`*^9}},
 CellLabel->
  "In[1218]:=",ExpressionUUID->"67c25fc7-b84c-4a26-9f42-0fb2013de156"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convert Pixels To Centimeters & Differences To Velocities", "Subsection",
 CellChangeTimes->{{3.760265089590619*^9, 3.7602651172628264`*^9}, {
  3.7602700926475096`*^9, 3.7602701003668647`*^9}, {3.7603351754409504`*^9, 
  3.760335192976043*^9}, {3.760335258927647*^9, 
  3.760335285152509*^9}},ExpressionUUID->"4fac3ccc-b373-4284-9646-\
0debbdcbc979"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"frameRate", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toCentimeters", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameDataPhysicalUnits", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "/", "toCentimeters"}], ",", "\[IndentingNewLine]", 
       RowBox[{"1", "/", "toCentimeters"}], ",", "\[IndentingNewLine]", 
       RowBox[{"frameRate", "/", "toCentimeters"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"frameRate", "/", "toCentimeters"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"frameRate", "/", "toCentimeters"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "}"}], "*", 
     RowBox[{"Transpose", "@", 
      RowBox[{"(", 
       RowBox[{"unitConversion", "*", "frameData"}], ")"}]}]}], "//", 
    "Transpose"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7602592168021727`*^9, 3.760259296470604*^9}, {
   3.7602593365184703`*^9, 3.760259338584316*^9}, 3.7602602311340466`*^9, {
   3.7602624631017213`*^9, 3.7602625398644185`*^9}, {3.7602625780777483`*^9, 
   3.7602626418685455`*^9}, 3.7602695178698063`*^9, {3.7602716805578537`*^9, 
   3.760271682322268*^9}, {3.7602732913330584`*^9, 3.760273330341797*^9}, {
   3.7602736475672646`*^9, 3.7602736505343614`*^9}, {3.7602742060237927`*^9, 
   3.760274206288061*^9}, {3.760274575919284*^9, 3.760274578988077*^9}, {
   3.760276569768463*^9, 3.760276608983991*^9}, {3.760276651373914*^9, 
   3.760276664420023*^9}, 3.7602767111186647`*^9, {3.7602771446221757`*^9, 
   3.760277179467381*^9}, {3.7602774968081264`*^9, 3.760277502859971*^9}, {
   3.760278056016466*^9, 3.760278065978877*^9}, {3.7603334576104665`*^9, 
   3.760333464704492*^9}, {3.760335243534814*^9, 3.760335256198942*^9}, {
   3.7604560741591053`*^9, 3.7604560769212933`*^9}, 3.7614778983414536`*^9, {
   3.7614795665940113`*^9, 3.7614795716326666`*^9}, {3.7614797619940004`*^9, 
   3.761479765728627*^9}, {3.7743541720334525`*^9, 3.7743541795553427`*^9}, {
   3.781964678148673*^9, 3.78196467941929*^9}, {3.781965276676009*^9, 
   3.781965280155959*^9}, 3.7819653654590635`*^9, 3.782025034849036*^9, {
   3.7820289150114317`*^9, 3.7820289308310704`*^9}, {3.8091242043556604`*^9, 
   3.809124216601411*^9}, {3.809180255938523*^9, 3.809180258218358*^9}},
 CellLabel->
  "In[1221]:=",ExpressionUUID->"ebba58e1-a2cd-4f79-b8b4-ce1d8c157e48"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocimetry Success Rate", "Subsection",
 CellChangeTimes->{{3.760265089590619*^9, 3.7602651172628264`*^9}, {
  3.7602700926475096`*^9, 3.7602701003668647`*^9}, {3.7603351754409504`*^9, 
  3.760335192976043*^9}, {3.760335258927647*^9, 3.760335285152509*^9}, {
  3.7692287640773582`*^9, 3.7692287760383472`*^9}, {3.7692288370830727`*^9, 
  3.7692288423579655`*^9}},ExpressionUUID->"51464088-c0de-47f5-a04c-\
cccaa9353bb1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"velEfficiency", "=", 
   RowBox[{
    RowBox[{"100", "*", 
     RowBox[{
      RowBox[{"Length", "@", "frameDataPhysicalUnits"}], "/", 
      RowBox[{"Length", "@", "shapes"}]}]}], " ", "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\"\<%\>\"", "velEfficiency"}], "//", "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.7692287796865873`*^9, 3.7692288167335005`*^9}, {
   3.773322034889025*^9, 3.7733220439278727`*^9}, {3.7733256581597724`*^9, 
   3.7733256593294916`*^9}, {3.773325806489956*^9, 3.773325817505679*^9}, 
   3.782028932361123*^9, {3.78202897518889*^9, 3.782028976750922*^9}},
 CellLabel->
  "In[1224]:=",ExpressionUUID->"9c67a3fc-9c87-4eea-beea-9d1bc9ca4d3b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Velocimetry Data >>", "Subsection",
 CellChangeTimes->{{3.760335310349119*^9, 3.760335334737877*^9}, {
  3.760341307971743*^9, 
  3.7603413102835464`*^9}},ExpressionUUID->"01d7e93f-35b9-42bb-a0f6-\
91cbab825584"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<X Y Vx Vy V.txt\>\""}], ",", 
    RowBox[{"Compress", "@", "frameDataPhysicalUnits"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<Velocimetry Efficiency.txt\>\""}], ",", 
    RowBox[{"Compress", "@", "velEfficiency"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7602781123305035`*^9, 3.7602781486148057`*^9}, {
   3.760327353095094*^9, 3.760327353165905*^9}, {3.7603347535226135`*^9, 
   3.760334764521196*^9}, 3.76045427458504*^9, {3.7604555498518033`*^9, 
   3.7604555719540253`*^9}, {3.7605974172546105`*^9, 3.760597422413292*^9}, {
   3.7606765441491904`*^9, 3.7606765449231205`*^9}, {3.7609000674979086`*^9, 
   3.760900072761859*^9}, 3.760929318751333*^9, {3.7733220483365035`*^9, 
   3.77332210382411*^9}, {3.7733221704823313`*^9, 3.7733221863738365`*^9}, {
   3.7819648181301856`*^9, 3.781964819393436*^9}, 3.7820289334854274`*^9, 
   3.782028977813266*^9, {3.8086470832669373`*^9, 3.8086470841595507`*^9}},
 CellLabel->
  "In[1226]:=",ExpressionUUID->"c9887ae2-5aa1-4db6-aa76-39526f486037"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocity/Position Correlations", "Section",
 CellChangeTimes->{{3.760340769662713*^9, 
  3.7603407886070395`*^9}},ExpressionUUID->"2c97dbcb-6df2-4d14-8afa-\
54bcd7a8a7c6"],

Cell[CellGroupData[{

Cell["Initialize from Imported Datasets", "Subsection",
 CellChangeTimes->{{3.7604202374291945`*^9, 3.7604202472815475`*^9}, {
  3.774353988067187*^9, 
  3.7743540072848234`*^9}},ExpressionUUID->"4dd7366d-7834-4d5e-9c74-\
31baed9442ac"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"frameDataPhysicalUnits", "=", 
    RowBox[{"Uncompress", "@", 
     RowBox[{"Import", "[", "\[IndentingNewLine]", 
      RowBox[{"importData", "<>", "\"\<X Y Vx Vy V.txt\>\""}], 
      "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"bubbleLocations", "=", 
    RowBox[{"Uncompress", "@", 
     RowBox[{"Import", "[", "\[IndentingNewLine]", 
      RowBox[{"importData", "<>", "\"\<Frame Centroids.txt\>\""}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7743543522117696`*^9, 3.7743543553025064`*^9}, {
   3.7819644882945304`*^9, 3.781964488740262*^9}, 3.782024778739241*^9, 
   3.7820289348136053`*^9, {3.802248798187714*^9, 3.8022487988409863`*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"981a7f59-e4ed-4f2f-8198-d866cdcd30e1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Datasets", "Subsection",
 CellChangeTimes->{{3.7604202374291945`*^9, 
  3.7604202472815475`*^9}},ExpressionUUID->"067a6abf-84a6-4673-b263-\
b3bf9ad40b08"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pairDataArrays", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"frameDataPhysicalUnits", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "x"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"frameDataPhysicalUnits", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "y"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", 
         RowBox[{"frameDataPhysicalUnits", "//", "Length"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.760353202877407*^9, 3.7603532262698436`*^9}, {
   3.7743568279567394`*^9, 3.77435689828127*^9}, {3.774356959560777*^9, 
   3.7743569646042905`*^9}, {3.7746962509379086`*^9, 3.77469625439367*^9}, 
   3.7819652813958797`*^9, 3.7819653664761963`*^9, {3.7820247837791214`*^9, 
   3.7820247914274054`*^9}, {3.7820289360638313`*^9, 
   3.7820289422779837`*^9}, {3.782029015645942*^9, 3.7820290604061203`*^9}, 
   3.8073495912102256`*^9},
 CellLabel->
  "In[1228]:=",ExpressionUUID->"8d49be18-206b-4e92-9fff-7e9017ecee78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vertVSy", ",", "horzVSy", ",", "velVSy", ",", "vertVSx", ",", "horzVSx",
       ",", "velVSx"}], "}"}], "=", "\[IndentingNewLine]", 
    RowBox[{"MapThread", "[", 
     RowBox[{"pairDataArrays", ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "2", ",", "2", ",", "1", ",", "1", ",", "1"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"4", ",", "3", ",", "5", ",", "4", ",", "3", ",", "5"}], 
         "}"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"getCentroids", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"p", "=", "1"}], ",", 
    RowBox[{"p", "\[LessEqual]", 
     RowBox[{"Length", "@", "bubbleLocations"}]}], ",", 
    RowBox[{"p", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", 
        RowBox[{"Length", "@", 
         RowBox[{"bubbleLocations", "[", 
          RowBox[{"[", "p", "]"}], "]"}]}]}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
         RowBox[{"getCentroids", ",", 
          RowBox[{"bubbleLocations", "[", 
           RowBox[{"[", 
            RowBox[{"p", ",", "k"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yVSx", "=", 
    RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"Reverse", "@", "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"unitConversion", "/", "toCentimeters"}], ")"}], "*", 
          RowBox[{"Transpose", "@", "getCentroids"}]}], "\[IndentingNewLine]",
          ")"}]}]}], ",", "First"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"correlatedSets", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
    "vertVSy", ",", "horzVSy", ",", "velVSy", ",", "vertVSx", ",", "horzVSx", 
     ",", "velVSx"}], "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.760353202877407*^9, 3.7603532262698436`*^9}, {
   3.7743568279567394`*^9, 3.77435689828127*^9}, {3.774356959560777*^9, 
   3.7743569646042905`*^9}, {3.7746962509379086`*^9, 3.77469625439367*^9}, 
   3.7819652813958797`*^9, 3.7819653664761963`*^9, {3.7820247837791214`*^9, 
   3.7820247914274054`*^9}, {3.7820289360638313`*^9, 
   3.7820289422779837`*^9}, {3.782029015645942*^9, 3.7820290604061203`*^9}, {
   3.8073495912102256`*^9, 3.807349594474827*^9}},
 CellLabel->
  "In[1229]:=",ExpressionUUID->"b1db6cff-edf7-4f66-9e3f-980e18f8e54a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Averaging Functions", "Subsection",
 CellChangeTimes->{{3.7603509038673973`*^9, 
  3.7603509199099803`*^9}},ExpressionUUID->"68b8594f-2581-415d-9e86-\
cad4ecb1a3d3"],

Cell["Possible Improvements", "Abstract",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
  3.769158606943906*^9, 3.7691586572504983`*^9}, {3.7692223025981207`*^9, 
  3.769222339641034*^9}},ExpressionUUID->"c1272593-03e3-448e-8d05-\
f7b99c841b98"],

Cell["Use TV/Wiener filtering", "Subitem",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
   3.769158606943906*^9, 3.7691586572504983`*^9}, 3.7692223043414335`*^9, {
   3.769222342585159*^9, 3.769222345000705*^9}, {3.769230882123254*^9, 
   3.769230908195506*^9}, {3.8076357947285657`*^9, 
   3.8076358068480806`*^9}},ExpressionUUID->"db2dcc10-76de-40fc-959d-\
06aa84a07f08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"binWindow", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"binFraction", "*", 
    RowBox[{"Length", "@", "x"}]}], "//", "Round"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"averagingWindow", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"windowScale", "*", 
    RowBox[{"binWindow", "[", "x", "]"}]}], "//", 
   "Round"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"averageData", "[", "x_", "]"}], ":=", 
  RowBox[{"MovingAverage", "[", 
   RowBox[{"x", ",", 
    RowBox[{"averagingWindow", "[", "x", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"binData", "[", "x_", "]"}], ":=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "+", 
         RowBox[{"binWindow", "[", "x", "]"}], "-", "1"}], "\[LessEqual]", 
        RowBox[{"Length", "@", "x"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Mean", "@", 
        RowBox[{"x", "[", "\[IndentingNewLine]", 
         RowBox[{"[", 
          RowBox[{"k", ";;", 
           RowBox[{"k", "+", 
            RowBox[{"binWindow", "[", "x", "]"}], "-", "1"}]}], "]"}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Mean", "@", 
        RowBox[{"x", "[", "\[IndentingNewLine]", 
         RowBox[{"[", 
          RowBox[{"k", ";;", 
           RowBox[{"Length", "@", "x"}]}], "]"}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"x", "//", "Length"}], ",", 
       RowBox[{"binWindow", "[", "x", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"binAverages", "[", "x_", "]"}], ":=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"k", "+", 
         RowBox[{"binWindow", "[", "x", "]"}], "-", "1"}], "\[LessEqual]", 
        RowBox[{"Length", "@", "x"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"k", ";;", 
          RowBox[{"k", "+", 
           RowBox[{"binWindow", "[", "x", "]"}], "-", "1"}]}], "]"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"k", ";;", 
          RowBox[{"Length", "@", "x"}]}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"x", "//", "Length"}], ",", 
       RowBox[{"binWindow", "[", "x", "]"}]}], "}"}]}], "\[IndentingNewLine]",
     "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"averageBinnedData", "[", "x_", "]"}], ":=", 
  RowBox[{"MovingAverage", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"binData", "@", "x"}], ",", "secondaryWindow"}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.760333636413926*^9, 3.7603337041947126`*^9}, {
   3.760333769225233*^9, 3.7603339366197395`*^9}, {3.7603341143468623`*^9, 
   3.7603341697606506`*^9}, {3.760334325343182*^9, 3.7603343474600496`*^9}, {
   3.760334415778301*^9, 3.760334416545253*^9}, {3.7603356193459163`*^9, 
   3.7603356494823203`*^9}, {3.760335738824351*^9, 3.7603358518420544`*^9}, {
   3.760335933796857*^9, 3.7603359821227303`*^9}, {3.760336021703769*^9, 
   3.7603361674149694`*^9}, 3.760336260057706*^9, {3.760336318299696*^9, 
   3.760336320206563*^9}, {3.7603363607844143`*^9, 3.760336450822962*^9}, {
   3.7603365079032965`*^9, 3.7603365130968637`*^9}, {3.760336549338478*^9, 
   3.760336630618775*^9}, {3.760336772676278*^9, 3.7603368538179617`*^9}, {
   3.760336910935498*^9, 3.76033694709118*^9}, {3.760337054011554*^9, 
   3.760337054155176*^9}, {3.7603508573322763`*^9, 3.760350900460486*^9}, 
   3.7603511190045433`*^9, {3.7603526553901644`*^9, 3.760352673805338*^9}, {
   3.760354916204028*^9, 3.760354974810273*^9}, {3.760355020186906*^9, 
   3.7603550574244*^9}, {3.7603552507767315`*^9, 3.7603552647982235`*^9}, {
   3.760355406668765*^9, 3.7603554302479944`*^9}, {3.7603555272071934`*^9, 
   3.760355549368046*^9}, 3.760356145816448*^9, {3.760356217303606*^9, 
   3.7603563508865757`*^9}, {3.7603563870927343`*^9, 3.760356512567131*^9}, {
   3.7603566632118287`*^9, 3.7603566768553357`*^9}, {3.7603568680906725`*^9, 
   3.7603568771255054`*^9}, {3.7603575618162036`*^9, 3.760357565640995*^9}, {
   3.7603576274541783`*^9, 3.7603576517452188`*^9}, {3.7603577868846173`*^9, 
   3.760357825080686*^9}, {3.7603578846278777`*^9, 3.7603578852133017`*^9}, {
   3.7603586055271044`*^9, 3.7603586060307627`*^9}, {3.760363960488239*^9, 
   3.760363962403116*^9}, {3.7604360474499493`*^9, 3.7604360593083344`*^9}, {
   3.7604362282816386`*^9, 3.7604362701852493`*^9}, 3.7605927723453426`*^9, {
   3.7605987464195147`*^9, 3.7605987832228217`*^9}, {3.760635431936271*^9, 
   3.7606354360257573`*^9}, 3.7606360078531322`*^9, {3.7606373748912816`*^9, 
   3.7606373769090395`*^9}, 3.782029139766534*^9, {3.7820292051173253`*^9, 
   3.782029208468261*^9}, {3.782029241621321*^9, 3.782029268418812*^9}, 
   3.782029323788039*^9, {3.7820293679161615`*^9, 3.782029369267309*^9}, {
   3.782029414362756*^9, 3.7820294327862773`*^9}, 3.7820295714173822`*^9, 
   3.78202961392099*^9, {3.7820298194214063`*^9, 3.782029822372579*^9}, 
   3.7820298580361533`*^9},
 CellLabel->
  "In[1234]:=",ExpressionUUID->"643979d5-fc82-44cd-9214-9483e4388dd4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Averaged Correlation Curves", "Subsection",
 CellChangeTimes->{{3.760352684206524*^9, 3.7603526919961452`*^9}, {
  3.760363544912324*^9, 3.760363557904788*^9}, {3.7606947129398894`*^9, 
  3.7606947149245834`*^9}, {3.7607103100465612`*^9, 
  3.7607103114967055`*^9}},ExpressionUUID->"d0740f30-7140-463f-a71e-\
05a811eb5174"],

Cell[BoxData[{
 RowBox[{"binFraction", ":=", "0.025"}], "\[IndentingNewLine]", 
 RowBox[{"windowScale", ":=", "1.3"}], "\[IndentingNewLine]", 
 RowBox[{"secondaryWindow", ":=", "5"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7606385319870176`*^9, {3.760639013724504*^9, 3.7606390140902786`*^9}, {
   3.760931464626253*^9, 3.7609314650660934`*^9}, {3.7612860785414524`*^9, 
   3.7612860842273245`*^9}, {3.769222045617428*^9, 3.7692220458957105`*^9}, {
   3.7692280784382067`*^9, 3.7692280882130527`*^9}, 3.7692309347454853`*^9, {
   3.769231182660924*^9, 3.769231185345743*^9}, {3.7733404252250223`*^9, 
   3.7733404269384537`*^9}, {3.773340729571272*^9, 3.7733407683980637`*^9}, 
   3.78202301855348*^9, {3.7820290636551094`*^9, 3.7820290708376913`*^9}, 
   3.782029140797896*^9, 3.782029242556744*^9, 3.7820293249563165`*^9, 
   3.7820295726656103`*^9, 3.782029851166406*^9, {3.782029923429773*^9, 
   3.7820299262920003`*^9}, {3.782029980268738*^9, 3.7820299817238364`*^9}, 
   3.782030032299573*^9, 3.808309617332415*^9},
 CellLabel->
  "In[1240]:=",ExpressionUUID->"598456b2-b156-43b0-9329-2d755684cb4b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"adaptivePlotRange", "[", "x_", "]"}], ":=", 
   RowBox[{"1.5", "*", 
    RowBox[{"Last", "@", 
     RowBox[{"StandardDeviation", "[", "x", "]"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"averagedCurve", "[", "x_", "]"}], ":=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{"x", ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"averageBinnedData", "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Thick"}], "}"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"adaptivePlotRange", "[", "x", "]"}]}], "+", 
           RowBox[{"Last", "@", 
            RowBox[{"Mean", "[", "x", "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"adaptivePlotRange", "[", "x", "]"}], "+", 
           RowBox[{"Last", "@", 
            RowBox[{"Mean", "[", "x", "]"}]}]}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"axesLabelsVelocity", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"k", "=", "1"}], ",", 
   RowBox[{"k", "\[LessEqual]", 
    RowBox[{"Length", "@", "correlatedSets"}]}], ",", 
   RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plotCurves", "[", "k", "]"}], "=", 
     RowBox[{"averagedCurve", "@", 
      RowBox[{"correlatedSets", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.7606385319870176`*^9, {3.760639013724504*^9, 3.7606390140902786`*^9}, {
   3.760931464626253*^9, 3.7609314650660934`*^9}, {3.7612860785414524`*^9, 
   3.7612860842273245`*^9}, {3.769222045617428*^9, 3.7692220458957105`*^9}, {
   3.7692280784382067`*^9, 3.7692280882130527`*^9}, 3.7692309347454853`*^9, {
   3.769231182660924*^9, 3.769231185345743*^9}, {3.7733404252250223`*^9, 
   3.7733404269384537`*^9}, {3.773340729571272*^9, 3.7733407683980637`*^9}, 
   3.78202301855348*^9, {3.7820290636551094`*^9, 3.7820290708376913`*^9}, 
   3.782029140797896*^9, 3.782029242556744*^9, 3.7820293249563165`*^9, 
   3.7820295726656103`*^9, 3.782029851166406*^9, {3.782029923429773*^9, 
   3.7820299262920003`*^9}, {3.782029980268738*^9, 3.7820299817238364`*^9}, 
   3.782030032299573*^9, 3.808309617332415*^9},
 CellLabel->
  "In[1243]:=",ExpressionUUID->"6763716e-f0a7-48c4-bcef-84f9a49c289b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ View The Correlation Curves ]]", "Subsection",
 CellChangeTimes->{{3.760710316676852*^9, 3.760710325813034*^9}, {
  3.7607107482305107`*^9, 
  3.7607107509821787`*^9}},ExpressionUUID->"e901a572-5638-4826-972b-\
ceffe5116eca"],

Cell[BoxData[
 RowBox[{"velocityCurves", "=", 
  RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"plotCurves", "[", "1", "]"}], ",", 
        RowBox[{"plotCurves", "[", "4", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"plotCurves", "[", "2", "]"}], ",", 
        RowBox[{"plotCurves", "[", "5", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"plotCurves", "[", "3", "]"}], ",", 
        RowBox[{"plotCurves", "[", "6", "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7606389182207947`*^9, 3.7606389268046665`*^9}, {
   3.76063897590897*^9, 3.7606389907106853`*^9}, 3.769224368902575*^9, {
   3.769224807449929*^9, 3.7692248125782127`*^9}, {3.7733407629340496`*^9, 
   3.7733407639283876`*^9}, {3.7820300327732787`*^9, 
   3.7820300345941515`*^9}, {3.8022521428963366`*^9, 3.8022521478675575`*^9}},
 CellLabel->
  "In[1246]:=",ExpressionUUID->"eba584bd-ba47-4270-a11f-332739bd69f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export The Velocimetry Plot >>", "Subsection",
 CellChangeTimes->{{3.7607118428764553`*^9, 3.76071185921566*^9}, {
  3.7615520070766373`*^9, 3.7615520160286875`*^9}, {3.806173309708044*^9, 
  3.806173314669473*^9}},ExpressionUUID->"48797cb0-2f1b-4347-9713-\
9d8c64149a6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<velocimetryPlots.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "velocityCurves", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7615520179794674`*^9, 3.761552019840833*^9}, {
   3.7615521913838577`*^9, 3.76155220635884*^9}, {3.7669437340167522`*^9, 
   3.766943736607154*^9}, 3.7819648209784546`*^9, {3.782030288040819*^9, 
   3.782030289031206*^9}, {3.8022521158611135`*^9, 3.8022521258798532`*^9}, {
   3.8022521578182964`*^9, 3.8022521850496025`*^9}, {3.8083110469635525`*^9, 
   3.8083110470652804`*^9}, {3.80839673258877*^9, 3.8083967597337866`*^9}},
 CellLabel->
  "In[1247]:=",ExpressionUUID->"8b0eb072-7d6c-4ed0-b183-89ed880b31c2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Trajectory Analysis", "Section",
 CellChangeTimes->{{3.760340769662713*^9, 3.7603407886070395`*^9}, {
  3.808401279625798*^9, 
  3.808401284857048*^9}},ExpressionUUID->"dfe3383f-3473-48a1-9d3d-\
4e47e4cf6cc5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"upperThreshold", "=", "0.90"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowerThreshold", "=", 
   RowBox[{"1", "-", "upperThreshold"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sizeFactor", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"splineOrder", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"toCentimeters", ":=", "10"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"controlValues", "=", "500"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.784548368209306*^9, 3.7845485624847603`*^9}, {
   3.7845505144507585`*^9, 3.7845505145288954`*^9}, {3.7845520014822865`*^9, 
   3.784552002365819*^9}, {3.78455253639357*^9, 3.784552539575742*^9}, {
   3.784552625836299*^9, 3.7845526281845584`*^9}, {3.805394070060497*^9, 
   3.8053940738441644`*^9}, {3.8053941059803543`*^9, 
   3.8053941109248133`*^9}, {3.8053942714505277`*^9, 3.805394319042187*^9}, {
   3.805394398202921*^9, 3.80539440192365*^9}, {3.805394446395267*^9, 
   3.8053944507845592`*^9}, {3.808392656940387*^9, 3.808392657270357*^9}, {
   3.8083976446279497`*^9, 3.808397644690779*^9}, {3.808398131639741*^9, 
   3.808398160319953*^9}, {3.8083984120259113`*^9, 3.808398412646911*^9}, {
   3.8084022742029963`*^9, 3.808402297160624*^9}, {3.8084119912461376`*^9, 
   3.808411991307972*^9}, {3.8084120849575057`*^9, 3.8084120858277583`*^9}, {
   3.808412116645873*^9, 3.808412144634777*^9}, {3.8084785069217753`*^9, 
   3.8084785609591246`*^9}, {3.8084786063852434`*^9, 3.808478656896698*^9}, 
   3.808478693968839*^9, {3.808478732343787*^9, 3.8084787324305534`*^9}, {
   3.8084787645835147`*^9, 3.8084787646692853`*^9}, {3.809124319039199*^9, 
   3.8091243190899944`*^9}},
 CellLabel->
  "In[1248]:=",ExpressionUUID->"88849c43-171e-4634-a0ef-de9c0a5d8cd3"],

Cell[CellGroupData[{

Cell["Set of Trajectory Points", "Subsection",
 CellChangeTimes->{{3.7607118428764553`*^9, 3.76071185921566*^9}, {
  3.7615520070766373`*^9, 3.7615520160286875`*^9}, {3.806173309708044*^9, 
  3.806173314669473*^9}, {3.8084873096295233`*^9, 
  3.808487336444872*^9}},ExpressionUUID->"93a553e2-9a7e-47b0-8fa6-\
15f5a1db8194"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"yVSx", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"unitConversion", "/", "toCentimeters"}], ")"}], "*", 
        RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
         RowBox[{"bubbleLocations", ",", "1"}], "\[IndentingNewLine]", 
         "]"}]}], "//", "Transpose"}], "//", "Reverse"}], "//", 
     "Transpose"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sweepValues", "=", 
    RowBox[{"Range", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Min", "@", 
       RowBox[{"First", "@", 
        RowBox[{"Transpose", "@", "yVSx"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Max", "@", 
       RowBox[{"First", "@", 
        RowBox[{"Transpose", "@", "yVSx"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Max", "@", 
        RowBox[{"First", "@", 
         RowBox[{"Transpose", "@", "yVSx"}]}]}], "/", "controlValues"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"yVSx", "//", "ListPlot"}]}], "Input",
 CellChangeTimes->{{3.8083969440261126`*^9, 3.8083969627595787`*^9}, {
   3.8083970697198615`*^9, 3.808397095019796*^9}, {3.8083971344959884`*^9, 
   3.8083971360933037`*^9}, {3.8083971962383327`*^9, 3.808397343380331*^9}, 
   3.8083974017030687`*^9, {3.8083981842397785`*^9, 3.80839818472748*^9}, {
   3.8084012988824053`*^9, 3.80840129928454*^9}, {3.809124250154457*^9, 
   3.809124254698205*^9}},
 CellLabel->
  "In[1254]:=",ExpressionUUID->"a300a896-b201-4e2e-adf1-6694c45b91b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute The Envelope Functions", "Subsection",
 CellChangeTimes->{{3.7607118428764553`*^9, 3.76071185921566*^9}, {
  3.7615520070766373`*^9, 3.7615520160286875`*^9}, {3.806173309708044*^9, 
  3.806173314669473*^9}, {3.8084873096295233`*^9, 
  3.8084873667168846`*^9}},ExpressionUUID->"2cea9f2f-dd08-45d1-93f6-\
33513713c5fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"envelopeFunctions", "=", 
   RowBox[{"QuantileRegression", "[", "\[IndentingNewLine]", 
    RowBox[{"yVSx", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sizeFactor", "*", 
       RowBox[{"Length", "@", "yVSx"}]}], "//", "Round"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"lowerThreshold", ",", "upperThreshold"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"InterpolationOrder", "\[Rule]", "splineOrder"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8083975511691275`*^9, 3.808397584324543*^9}, 
   3.8083981379322042`*^9, {3.808398169361369*^9, 3.8083981910078244`*^9}, {
   3.808402206232363*^9, 3.808402212904049*^9}},
 CellLabel->
  "In[1257]:=",ExpressionUUID->"a04d5dde-b2e2-4d72-b46f-34b1ccef04c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Trajectory Envelopes", "Subsection",
 CellChangeTimes->{{3.7607118428764553`*^9, 3.76071185921566*^9}, {
  3.7615520070766373`*^9, 3.7615520160286875`*^9}, {3.806173309708044*^9, 
  3.806173314669473*^9}, {3.8084873096295233`*^9, 
  3.808487389140973*^9}},ExpressionUUID->"c13b63dc-63e8-42f4-b99c-\
2db780e2f900"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"envelopeSampling", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"envelopeFunctions", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "[", "k", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", "sweepValues"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], "&"}], "/@", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "envelopeFunctions"}]}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"filteredEnvelopes", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"TotalVariationFilter", "[", 
       RowBox[{"#", ",", "1", ",", 
        RowBox[{"Method", "\[Rule]", "\"\<Gaussian\>\""}]}], "]"}], "&"}], "/@",
      "envelopeSampling"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"verticalEnvelopes", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Reverse", "/@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sweepValues", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"filteredEnvelopes", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "@", "sweepValues"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], "&"}], "/@", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "filteredEnvelopes"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"verticalTrajectories", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"Reverse", "@", 
     RowBox[{"Transpose", "@", "yVSx"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8083975511691275`*^9, 3.808397584324543*^9}, 
   3.8083981379322042`*^9, {3.808398169361369*^9, 3.8083981910078244`*^9}, {
   3.808402206232363*^9, 3.808402212904049*^9}, 3.8084022825043354`*^9, {
   3.808408207213346*^9, 3.80840822475449*^9}, {3.808412135733119*^9, 
   3.808412162414155*^9}},
 CellLabel->
  "In[1258]:=",ExpressionUUID->"23d8080e-cbe8-415e-b4e8-e52386829c4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plot Trajectory Envelopes & Compute Thickness", "Subsection",
 CellChangeTimes->{{3.7607118428764553`*^9, 3.76071185921566*^9}, {
  3.7615520070766373`*^9, 3.7615520160286875`*^9}, {3.806173309708044*^9, 
  3.806173314669473*^9}, {3.8084873096295233`*^9, 
  3.808487413924797*^9}},ExpressionUUID->"c60d9c29-406e-45c1-970c-\
061e669824ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"envelopeRange", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"Min", "@", 
      RowBox[{"First", "@", 
       RowBox[{"Transpose", "@", "yVSx"}]}]}], ",", 
     RowBox[{"Max", "@", 
      RowBox[{"First", "@", 
       RowBox[{"Transpose", "@", "yVSx"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"frameLabelEvelopes", ":=", 
  RowBox[{"{", 
   RowBox[{"\"\<x, cm\>\"", ",", "\"\<y, cm\>\""}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"frameLabelThickness", ":=", 
  RowBox[{"{", 
   RowBox[{"\"\<y, cm\>\"", ",", " ", "\"\<\[Delta], cm\>\""}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"envelopeStyle", "=", 
    RowBox[{"{", 
     RowBox[{"Red", ",", "Thick"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"envelopePlotAll", "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"verticalTrajectories", ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"verticalEnvelopes", ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", "envelopeStyle", "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"unitConversion", "*", 
           RowBox[{"widthPixels", "/", "toCentimeters"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", "Automatic"}], "\[IndentingNewLine]", "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", " ", "frameLabelEvelopes"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"envelopePlot", "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{"verticalTrajectories", ",", 
       RowBox[{"PlotStyle", "\[Rule]", "Gray"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"verticalEnvelopes", ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", "envelopeStyle", "}"}]}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", "frameLabelEvelopes"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"envelopeThickness", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"sweepValues", ",", "#"}], "}"}]}], "&"}], "@", 
     RowBox[{"Abs", "@", 
      RowBox[{"Last", "@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{"Subtract", "@@", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{"Reverse", "@", 
               RowBox[{"Transpose", "@", "#"}]}]}], "&"}], "/@", 
            "verticalEnvelopes"}], "\[IndentingNewLine]", ")"}]}], 
         "\[IndentingNewLine]", ")"}]}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"envelopeThicknessPlot", "=", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{"envelopeThickness", ",", 
    RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", "frameLabelThickness"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.808397660689254*^9, 3.808397666181888*^9}, {
  3.8083978331970453`*^9, 3.8083978371703997`*^9}, {3.8084002414467654`*^9, 
  3.808400242334381*^9}, {3.808402422871879*^9, 3.8084024259285583`*^9}, {
  3.808403518596443*^9, 3.808403575577288*^9}, {3.8084050220534573`*^9, 
  3.808405023024921*^9}},
 CellLabel->
  "In[1262]:=",ExpressionUUID->"7955f01d-76d5-40e2-b686-fd03065849f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export The Set Envelope Plot >>", "Subsection",
 CellChangeTimes->{{3.7607118428764553`*^9, 3.76071185921566*^9}, {
  3.7615520070766373`*^9, 
  3.7615520160286875`*^9}},ExpressionUUID->"ec58058f-61ab-4b43-8abb-\
e9e27837dfd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"envelopePlotLabels", ":=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<Envelope Plot All\>\"", ",", "\"\<Envelope Plot\>\"", ",", 
     "\"\<Envelope Thickness\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exportEnvelopePlots", ":=", 
    RowBox[{"{", 
     RowBox[{
     "envelopePlotAll", ",", "envelopePlot", ",", "envelopeThicknessPlot"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapThread", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Export", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"output", "<>", "#1", "<>", "\"\<.jpg\>\""}], ",", 
       "\[IndentingNewLine]", "#2", ",", 
       RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]",
       "]"}], "&"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"envelopePlotLabels", ",", "exportEnvelopePlots"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7615520179794674`*^9, 3.761552019840833*^9}, {
   3.7615521913838577`*^9, 3.76155220635884*^9}, {3.7669437340167522`*^9, 
   3.766943736607154*^9}, 3.7819648209784546`*^9, {3.782030288040819*^9, 
   3.782030289031206*^9}, {3.8083139203494225`*^9, 3.8083139204326487`*^9}, {
   3.808404758633765*^9, 3.8084047596939983`*^9}, {3.8084048680301256`*^9, 
   3.8084048799291935`*^9}},
 CellLabel->
  "In[1270]:=",ExpressionUUID->"f099276f-00ee-46f5-b40b-64843623c544"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Binning & Hit Count Trajectory Filters", "Subsection",
 CellChangeTimes->{{3.7603636267845545`*^9, 3.7603636490201116`*^9}, {
  3.7606948553333273`*^9, 
  3.760694858227581*^9}},ExpressionUUID->"81c234aa-c04b-4f42-98aa-\
99f449c000d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
    RowBox[{"DensityHistogram", ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "ChartElementFunction", "\[Rule]", "\"\<GradientScaleCube\>\""}], ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Black", ",", "Bold"}], "}"}]}], ",", 
       RowBox[{"ColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}], ",", 
       RowBox[{"ChartElementFunction", "\[Rule]", "\"\<Bubble\>\""}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"scale1", ":=", ".1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scale2", ":=", ".2"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"binnedBubbleEvents", "[", "x_", "]"}], ":=", 
  RowBox[{"DensityHistogram", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Transpose", "@", 
     RowBox[{"Reverse", "@", 
      RowBox[{"Transpose", "@", "yVSx"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "scale1", "}"}], ",", 
      RowBox[{"{", "scale2", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Automatic", ",", "Automatic", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"x", "-", "1"}], "]"}], "<>", "\"\<-hit filter\>\""}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"FrameLabel", "\[Rule]", "frameLabelEvelopes"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.760276727552304*^9, 3.7602768301195664`*^9}, {
   3.760276883286029*^9, 3.7602768883407164`*^9}, {3.7602773787498083`*^9, 
   3.760277403166599*^9}, {3.7603276129444733`*^9, 3.760327613501983*^9}, {
   3.760342250668009*^9, 3.7603422547401032`*^9}, {3.760342301311051*^9, 
   3.7603423079078703`*^9}, {3.7603423444943953`*^9, 3.760342431154257*^9}, {
   3.7603424747024293`*^9, 3.7603425067764883`*^9}, {3.760342538088621*^9, 
   3.7603427139151917`*^9}, {3.760342757225869*^9, 3.760342832353501*^9}, 
   3.7603428644177284`*^9, {3.7603429058740425`*^9, 3.760343064946843*^9}, {
   3.760343147189816*^9, 3.7603432139232535`*^9}, {3.760343254392013*^9, 
   3.760343342322917*^9}, {3.7603434474026856`*^9, 3.7603435233173547`*^9}, {
   3.7603436443676233`*^9, 3.7603436791711526`*^9}, {3.7604258432046075`*^9, 
   3.7604258701076612`*^9}, {3.760425906620015*^9, 3.760425928587266*^9}, {
   3.760425989763053*^9, 3.760425990997338*^9}, 3.760426022874013*^9, {
   3.760426816777557*^9, 3.7604268198116417`*^9}, {3.7604269240550504`*^9, 
   3.7604269253057737`*^9}, {3.760436573549133*^9, 3.7604365748755836`*^9}, {
   3.7604366100458455`*^9, 3.7604366150835495`*^9}, {3.7604366546464443`*^9, 
   3.7604367107475777`*^9}, {3.7604367512889023`*^9, 3.7604367924638863`*^9}, 
   3.760677097476925*^9, {3.7606805767692356`*^9, 3.7606806052161293`*^9}, {
   3.7606806488255444`*^9, 3.760680650676624*^9}, {3.7606962039652863`*^9, 
   3.760696204035097*^9}, {3.7607806629075565`*^9, 3.760780683330956*^9}, {
   3.760897339625575*^9, 3.7608973681109657`*^9}, {3.7608974169709444`*^9, 
   3.7608974173259954`*^9}, {3.7608975059619703`*^9, 
   3.7608975364938545`*^9}, {3.7608975707042036`*^9, 
   3.7608976094210653`*^9}, {3.761286743755907*^9, 3.7612867441099577`*^9}, {
   3.7613800492115545`*^9, 3.7613800732908897`*^9}, {3.766943248392553*^9, 
   3.766943267817549*^9}, 3.782030377457464*^9, {3.8085696366770964`*^9, 
   3.808569641026436*^9}},
 CellLabel->
  "In[1273]:=",ExpressionUUID->"79f28216-482b-408c-bc86-1d10b9c9c003"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ View Filtered Trajectories ]]", "Subsection",
 CellChangeTimes->{{3.7607126438236055`*^9, 3.760712683822731*^9}, 
   3.7607127183371363`*^9, 
   3.7692310382825685`*^9},ExpressionUUID->"359bb13a-e7d8-42a3-a093-\
4c6a2fb43d2d"],

Cell[BoxData[
 RowBox[{"densityPlot", "=", 
  RowBox[{
   RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"binnedBubbleEvents", "[", "1", "]"}], ",", 
         RowBox[{"binnedBubbleEvents", "[", "3", "]"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"binnedBubbleEvents", "[", "5", "]"}], ",", 
         RowBox[{"binnedBubbleEvents", "[", "7", "]"}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
    "]"}], "//", "Quiet"}]}]], "Input",
 CellChangeTimes->{{3.760276727552304*^9, 3.7602768301195664`*^9}, {
   3.760276883286029*^9, 3.7602768883407164`*^9}, {3.7602773787498083`*^9, 
   3.760277403166599*^9}, {3.7603276129444733`*^9, 3.760327613501983*^9}, {
   3.760342250668009*^9, 3.7603422547401032`*^9}, {3.760342301311051*^9, 
   3.7603423079078703`*^9}, {3.7603423444943953`*^9, 3.760342431154257*^9}, {
   3.7603424747024293`*^9, 3.7603425067764883`*^9}, {3.760342538088621*^9, 
   3.7603427139151917`*^9}, {3.760342757225869*^9, 3.760342832353501*^9}, 
   3.7603428644177284`*^9, {3.7603429058740425`*^9, 3.760343064946843*^9}, {
   3.760343147189816*^9, 3.7603432139232535`*^9}, {3.760343254392013*^9, 
   3.7603433798352995`*^9}, {3.7606963978765893`*^9, 3.7606963993407507`*^9}, 
   3.7691497314842606`*^9, 3.773325863306798*^9, {3.7743511822279243`*^9, 
   3.7743511849945493`*^9}, {3.774357558685172*^9, 3.7743575772325797`*^9}, {
   3.774358165982236*^9, 3.7743581660680065`*^9}, {3.7820303785697756`*^9, 
   3.782030396951975*^9}, {3.806962392313586*^9, 3.8069623970949593`*^9}},
 CellLabel->
  "In[1277]:=",ExpressionUUID->"9b91884d-a00b-4a65-b334-07ff96f9b1e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Density Histograms >>", "Subsection",
 CellChangeTimes->{{3.7607118428764553`*^9, 3.76071185921566*^9}, {
  3.7615520070766373`*^9, 3.7615520160286875`*^9}, {3.7615532921375833`*^9, 
  3.761553299235276*^9}},ExpressionUUID->"c6c627f8-9ef7-49b8-b2b5-\
1a511e5ddca9"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Export", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"output", "<>", "\"\<density_plot.jpg\>\""}], ",", 
     "\[IndentingNewLine]", "densityPlot", ",", 
     RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
    "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7615520179794674`*^9, 3.761552019840833*^9}, {
   3.7615521913838577`*^9, 3.76155220635884*^9}, {3.761553309525111*^9, 
   3.761553331490259*^9}, 3.7615585352463713`*^9, {3.7669438112816396`*^9, 
   3.7669438134627757`*^9}, {3.774350913326251*^9, 3.774350913657366*^9}, {
   3.7743564624124117`*^9, 3.7743564626378317`*^9}, 3.7819648292028728`*^9, 
   3.7820303980073214`*^9},
 CellLabel->
  "In[1278]:=",ExpressionUUID->"9c89235e-7e17-44a5-9280-30d81394c2d8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Shape/Position Correlations", "Section",
 CellChangeTimes->{{3.760340769662713*^9, 3.7603407886070395`*^9}, {
  3.7691544460766664`*^9, 
  3.76915445844557*^9}},ExpressionUUID->"7b15c882-365f-476a-9114-\
64c0d4124965"],

Cell["Possible Improvements", "Abstract",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
  3.769158606943906*^9, 3.7691586572504983`*^9}, {3.7692223025981207`*^9, 
  3.769222339641034*^9}},ExpressionUUID->"73ab739a-0089-4b65-937c-\
86ba5417e477"],

Cell["Implement logical filters for tilt angle and aspect ratio", "Subitem",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
   3.769158606943906*^9, 3.7691586572504983`*^9}, 3.7692223043414335`*^9, {
   3.769222342585159*^9, 3.769222345000705*^9}, {3.7692223822111645`*^9, 
   3.769222390298554*^9}, {3.7692313804825826`*^9, 3.7692313986110964`*^9}, {
   3.774351420771236*^9, 
   3.7743514434436417`*^9}},ExpressionUUID->"7d79f7c4-6949-4645-b5ca-\
27a46bac3e7c"],

Cell[CellGroupData[{

Cell["Get  {X, Y, R, a/b, e, \[Phi]}  Data & Convert to Length Units", \
"Subsection",
 CellChangeTimes->{{3.7691031356968827`*^9, 3.7691031575444593`*^9}, {
  3.7691553295766644`*^9, 3.769155387610015*^9}, {3.769155428892212*^9, 
  3.7691554666053414`*^9}, {3.7692310456289186`*^9, 
  3.769231045897194*^9}},ExpressionUUID->"dd96334a-7791-4e49-806a-\
52c32a78cd76"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"formatShapeData", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
     RowBox[{"Select", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"actualBubbles", ",", "1"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "#"}], ">", "0"}], "&"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"allStats", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"3", ";;", "All"}], "]"}], "]"}], "&"}], "/@", 
     "formatShapeData"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"shapeStats", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "4"}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Max", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"5", ";;", "6"}], "]"}], "]"}]}], "/", 
            RowBox[{"Min", "@", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"5", ";;", "6"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"#", "[", 
            RowBox[{"[", "7", "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"180", "/", "\[Pi]"}], ")"}]}], "*", 
            RowBox[{"ArcTan", "@", 
             RowBox[{"Tan", "@", 
              RowBox[{"Last", "@", "#"}]}]}]}]}], "\[IndentingNewLine]", 
          "}"}]}], "&"}], "@", 
       RowBox[{"Flatten", "@", 
        RowBox[{"allStats", "[", 
         RowBox[{"[", "k", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{"Length", "@", "allStats"}]}], "}"}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"shapeStatsPhysicalUnits", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"unitConversion", "/", "toCentimeters"}], ",", 
       RowBox[{"unitConversion", "/", "toCentimeters"}], ",", 
       "unitConversion", ",", 
       RowBox[{"unitConversion", "^", "2"}], ",", "1", ",", "1", ",", "1"}], 
      "}"}], "*", 
     RowBox[{"Transpose", "@", "shapeStats"}]}], "//", "Transpose"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.768657251291777*^9, 3.7686572745645084`*^9}, {
   3.76865731867054*^9, 3.768657410593388*^9}, {3.768657445237528*^9, 
   3.7686574904463415`*^9}, {3.7686580686452417`*^9, 
   3.7686581019052625`*^9}, {3.7686590782118816`*^9, 
   3.7686591095680156`*^9}, {3.7691044006018744`*^9, 3.76910451087961*^9}, {
   3.7691554397511597`*^9, 3.769155447743791*^9}, 3.7723579577861443`*^9, {
   3.7819652904541893`*^9, 3.781965291476145*^9}, {3.781965367531252*^9, 
   3.781965369388405*^9}, 3.7819655019057903`*^9, {3.782030409000168*^9, 
   3.7820304392711887`*^9}, {3.8083086589846506`*^9, 3.808308661263625*^9}, {
   3.8083089677127686`*^9, 3.8083089872868366`*^9}, {3.808309084936076*^9, 
   3.8083090961819353`*^9}, {3.8083093845897975`*^9, 3.808309449389898*^9}, {
   3.8083095074032497`*^9, 3.8083095080755157`*^9}, {3.8083105006042476`*^9, 
   3.808310503084603*^9}, {3.8091243730669928`*^9, 3.8091243755372996`*^9}, {
   3.809124411334931*^9, 3.8091244177995872`*^9}},
 CellLabel->
  "In[1279]:=",ExpressionUUID->"edc83ff9-cac3-4dbd-9d0f-8bee2dee6bc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export  {X, Y, R, a/b, e, \[Phi]}  Data", "Subsection",
 CellChangeTimes->{{3.7691031356968827`*^9, 3.7691031575444593`*^9}, {
  3.7691553295766644`*^9, 3.769155387610015*^9}, {3.769155428892212*^9, 
  3.7691554666053414`*^9}, {3.76916038820149*^9, 
  3.7691603923354335`*^9}},ExpressionUUID->"56f498b8-c7b5-4fd8-8ae7-\
2a55c6393096"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<X Y R S a-b e Angle.txt\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compress", "@", "shapeStatsPhysicalUnits"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7691603964544196`*^9, 3.769160473909032*^9}, 
   3.7743501462852173`*^9, 3.7819648300503483`*^9, 3.7820304411912613`*^9, {
   3.808310613740176*^9, 3.80831061404387*^9}, {3.835712153354802*^9, 
   3.835712153818177*^9}},ExpressionUUID->"e629e428-9e55-4332-be44-\
a5b96a273777"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import From Processed Sequences", "Subsection",
 CellChangeTimes->{{3.7520000744520516`*^9, 3.7520000907368383`*^9}, {
  3.7601695348999557`*^9, 3.7601695399544315`*^9}, {3.7602506683880315`*^9, 
  3.7602506728526797`*^9}, {3.7603536186791306`*^9, 3.760353621440745*^9}, {
  3.760353741639697*^9, 3.760353745734726*^9}, {3.7743527477800436`*^9, 
  3.774352769187813*^9}, {3.7743544396751733`*^9, 
  3.7743544524610004`*^9}},ExpressionUUID->"60f3776e-3f6f-4584-b705-\
0dacd5be24ac"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"shapeStatsPhysicalUnits", "=", 
    RowBox[{"Uncompress", "@", 
     RowBox[{"Import", "[", "\[IndentingNewLine]", 
      RowBox[{"importData", "<>", "\"\<X Y R a-b e Angle.txt\>\""}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.752051628073289*^9, 3.7520516683084273`*^9}, {
   3.752052107223207*^9, 3.7520521075779905`*^9}, {3.752211931433508*^9, 
   3.752211931624024*^9}, {3.7522119728671727`*^9, 3.7522119730357203`*^9}, {
   3.7600950555414543`*^9, 3.760095055715*^9}, {3.7601022898168464`*^9, 
   3.7601022898976574`*^9}, {3.7601691716785593`*^9, 
   3.7601691717892437`*^9}, {3.760169529419608*^9, 3.760169529514329*^9}, {
   3.7601756292171326`*^9, 3.7601756293418007`*^9}, {3.7601849737228966`*^9, 
   3.760184973930319*^9}, {3.760185141401884*^9, 3.7601851496269093`*^9}, {
   3.760208449086478*^9, 3.7602084492637234`*^9}, {3.760269991014202*^9, 
   3.7602700104487963`*^9}, {3.7603285080640154`*^9, 3.760328520373093*^9}, {
   3.7603345136322155`*^9, 3.760334513697034*^9}, {3.760676437070323*^9, 
   3.760676446020754*^9}, {3.7608866790157037`*^9, 3.7608866792540903`*^9}, {
   3.760896565491361*^9, 3.7608965809029293`*^9}, 3.7609300205634704`*^9, {
   3.7609650062622337`*^9, 3.760965006375925*^9}, {3.76128745138564*^9, 
   3.761287457267913*^9}, {3.7612947810342197`*^9, 3.7612947811110115`*^9}, {
   3.766942339093336*^9, 3.7669423504773107`*^9}, {3.7692486521726995`*^9, 
   3.7692486533056693`*^9}, {3.769248989786003*^9, 3.7692489900572395`*^9}, {
   3.7743528565334663`*^9, 3.774352860678387*^9}, 3.7819644894295206`*^9, 
   3.7820304425014486`*^9, {3.802249334547048*^9, 3.802249336726219*^9}},
 EmphasizeSyntaxErrors->
  True,ExpressionUUID->"60170b00-290f-426c-940d-ba4993ad9000"]
}, Closed]],

Cell[CellGroupData[{

Cell["Separate Data Arrays, Create Correlation Pairs", "Subsection",
 CellChangeTimes->{{3.7691031356968827`*^9, 3.7691031575444593`*^9}, {
  3.7691553295766644`*^9, 3.769155387610015*^9}, {3.7691556843931684`*^9, 
  3.7691557235635195`*^9}},ExpressionUUID->"31ec0166-5dbf-43c0-8544-\
a13e501b8461"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getStats", "=", 
    RowBox[{"Transpose", "@", "shapeStatsPhysicalUnits"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "xCoordinate", ",", "\[IndentingNewLine]", "yCoordinate", ",", 
      "\[IndentingNewLine]", "bubbleRadius", ",", "\[IndentingNewLine]", 
      "bubbleArea", ",", "\[IndentingNewLine]", "bubbleAspectRatio", ",", 
      "\[IndentingNewLine]", "bubbleEccentricity", ",", "\[IndentingNewLine]",
       "tiltAngle"}], "\[IndentingNewLine]", "}"}], "=", 
    "\[IndentingNewLine]", 
    RowBox[{"Map", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"getStats", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "getStats"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tiltAngleModulus", "=", 
    RowBox[{"Abs", "@", "tiltAngle"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"correlation", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Transpose", "@", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], ",", "First"}], 
    "\[IndentingNewLine]", "]"}]}], "\n", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yPlot", "[", "x_", "]"}], ":=", 
  RowBox[{"correlation", "[", 
   RowBox[{"yCoordinate", ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xPlot", "[", "x_", "]"}], ":=", 
  RowBox[{"correlation", "[", 
   RowBox[{"xCoordinate", ",", "x"}], "]"}]}], "\n", 
 RowBox[{"shapeParameters", ":=", 
  RowBox[{"{", 
   RowBox[{
   "bubbleRadius", ",", "bubbleArea", ",", "bubbleAspectRatio", ",", 
    "bubbleEccentricity", ",", "tiltAngle", ",", "tiltAngleModulus"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shapeData", "=", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{"yPlot", ",", "shapeParameters"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{"xPlot", ",", "shapeParameters"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.782030600403805*^9, 3.7820306270333595`*^9}, {
   3.7820309003470035`*^9, 3.7820309023277793`*^9}, 3.782030952960515*^9, {
   3.808310659221979*^9, 3.8083107233329496`*^9}, {3.8083107885583715`*^9, 
   3.8083107906192465`*^9}},
 CellLabel->
  "In[1284]:=",ExpressionUUID->"ebcbbb9a-0404-4178-a6ea-75a7673e2ab8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Averaged Correlation Curves", "Subsection",
 CellChangeTimes->{{3.760352684206524*^9, 3.7603526919961452`*^9}, {
  3.760363544912324*^9, 3.760363557904788*^9}, {3.7606947129398894`*^9, 
  3.7606947149245834`*^9}, {3.7607103100465612`*^9, 
  3.7607103114967055`*^9}},ExpressionUUID->"712c0e3c-0985-4ce6-aaa7-\
89b491934033"],

Cell["Possible Improvements", "Abstract",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
  3.769158606943906*^9, 3.7691586572504983`*^9}, {3.7692223025981207`*^9, 
  3.769222339641034*^9}},ExpressionUUID->"81abe807-3cb4-47b7-9fb5-\
0dddd0b1c865"],

Cell["Implement adaptive secondary averaging windows", "Subitem",
 CellChangeTimes->{{3.7691584846573277`*^9, 3.7691585387985277`*^9}, {
   3.769158606943906*^9, 3.7691586572504983`*^9}, 3.7692223043414335`*^9, {
   3.769222342585159*^9, 3.769222345000705*^9}, {3.7692238755850143`*^9, 
   3.7692238997593546`*^9}, {3.7692310043233976`*^9, 
   3.769231022600504*^9}},ExpressionUUID->"f7dee976-45af-4b9b-8852-\
85c4613f57a5"],

Cell[BoxData[{
 RowBox[{"binFraction", ":=", "0.035"}], "\[IndentingNewLine]", 
 RowBox[{"windowScale", ":=", "1.3"}], "\[IndentingNewLine]", 
 RowBox[{"secondaryWindow", ":=", "5"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7606385319870176`*^9, {3.760639013724504*^9, 3.7606390140902786`*^9}, {
   3.760931464626253*^9, 3.7609314650660934`*^9}, {3.7612860785414524`*^9, 
   3.7612860842273245`*^9}, {3.7691619768056254`*^9, 
   3.7691619781969047`*^9}, {3.769162058337578*^9, 3.7691620697640285`*^9}, {
   3.769162196126058*^9, 3.7691621978325043`*^9}, {3.769163552451063*^9, 
   3.7691635638994255`*^9}, {3.7691636374305325`*^9, 
   3.7691636518858767`*^9}, {3.7691639096285253`*^9, 3.769163910666772*^9}, {
   3.7691645652112093`*^9, 3.7691645828959074`*^9}, 3.7691646924199667`*^9, 
   3.782023054816476*^9, 3.782029144115842*^9, 3.782029243747007*^9, 
   3.7820293260666275`*^9, 3.782029574431518*^9, 3.782029856876871*^9, {
   3.782029928387703*^9, 3.7820299299797173`*^9}, {3.782029985803311*^9, 
   3.7820299919565*^9}, {3.782030953809989*^9, 3.782030965737875*^9}, 
   3.8083107463478193`*^9, 3.8083199228062506`*^9},
 CellLabel->
  "In[1292]:=",ExpressionUUID->"62afedf6-7202-4f0f-aa24-ccea3eb1270c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"adaptivePlotRange", "[", "x_", "]"}], ":=", 
   RowBox[{"1.5", "*", 
    RowBox[{"Last", "@", 
     RowBox[{"StandardDeviation", "[", "x", "]"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"averagedCurve", "[", "x_", "]"}], ":=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{"x", ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Black"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"averageBinnedData", "[", "x", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Red", ",", "Thick"}], "}"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"adaptivePlotRange", "[", "x", "]"}]}], "+", 
           RowBox[{"Last", "@", 
            RowBox[{"Mean", "[", "x", "]"}]}]}], ",", 
          RowBox[{
           RowBox[{"adaptivePlotRange", "[", "x", "]"}], "+", 
           RowBox[{"Last", "@", 
            RowBox[{"Mean", "[", "x", "]"}]}]}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"axesLabelsShape", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"k", "=", "1"}], ",", 
   RowBox[{"k", "\[LessEqual]", 
    RowBox[{"Length", "@", "shapeData"}]}], ",", 
   RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"shapeCurves", "[", "k", "]"}], "=", 
     RowBox[{"averagedCurve", "@", 
      RowBox[{"shapeData", "[", 
       RowBox[{"[", "k", "]"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.7606385319870176`*^9, {3.760639013724504*^9, 3.7606390140902786`*^9}, {
   3.760931464626253*^9, 3.7609314650660934`*^9}, {3.7612860785414524`*^9, 
   3.7612860842273245`*^9}, {3.7691619768056254`*^9, 
   3.7691619781969047`*^9}, {3.769162058337578*^9, 3.7691620697640285`*^9}, {
   3.769162196126058*^9, 3.7691621978325043`*^9}, {3.769163552451063*^9, 
   3.7691635638994255`*^9}, {3.7691636374305325`*^9, 
   3.7691636518858767`*^9}, {3.7691639096285253`*^9, 3.769163910666772*^9}, {
   3.7691645652112093`*^9, 3.7691645828959074`*^9}, 3.7691646924199667`*^9, 
   3.782023054816476*^9, 3.782029144115842*^9, 3.782029243747007*^9, 
   3.7820293260666275`*^9, 3.782029574431518*^9, 3.782029856876871*^9, {
   3.782029928387703*^9, 3.7820299299797173`*^9}, {3.782029985803311*^9, 
   3.7820299919565*^9}, {3.782030953809989*^9, 3.782030965737875*^9}, 
   3.8083107463478193`*^9, 3.8083199228062506`*^9},
 CellLabel->
  "In[1295]:=",ExpressionUUID->"06903d05-b1a3-448a-9c97-b3598ff6d0d0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ View The Correlation Curves ]]", "Subsection",
 CellChangeTimes->{{3.760710316676852*^9, 3.760710325813034*^9}, {
  3.7607107482305107`*^9, 
  3.7607107509821787`*^9}},ExpressionUUID->"1333a4ee-2f38-425e-af17-\
b3865c9bfcc6"],

Cell[BoxData[
 RowBox[{"shapePlots", "=", 
  RowBox[{"GraphicsGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"shapeCurves", "[", "1", "]"}], ",", 
        RowBox[{"shapeCurves", "[", "7", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"shapeCurves", "[", "2", "]"}], ",", 
        RowBox[{"shapeCurves", "[", "8", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"shapeCurves", "[", "3", "]"}], ",", 
        RowBox[{"shapeCurves", "[", "9", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"shapeCurves", "[", "5", "]"}], ",", 
        RowBox[{"shapeCurves", "[", "11", "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Dividers", "\[Rule]", "All"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7606389182207947`*^9, 3.7606389268046665`*^9}, {
  3.76063897590897*^9, 3.7606389907106853`*^9}, {3.769163581654928*^9, 
  3.7691636188502274`*^9}, {3.7691638672758045`*^9, 3.7691638741304703`*^9}, {
  3.7692326510703244`*^9, 3.7692326694331923`*^9}, {3.7820309680434475`*^9, 
  3.7820309703919935`*^9}, {3.802252276448655*^9, 3.802252305145165*^9}, {
  3.8083109026217804`*^9, 3.808310940825919*^9}},
 CellLabel->
  "In[1298]:=",ExpressionUUID->"e8e7e04d-364a-4f82-8d78-c3bfc016a31e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export The Shape Parameter Plots >>", "Subsection",
 CellChangeTimes->{{3.7607118428764553`*^9, 3.76071185921566*^9}, {
  3.7615520070766373`*^9, 3.7615520160286875`*^9}, {3.8061736405516977`*^9, 
  3.8061736463739557`*^9}},ExpressionUUID->"d443c9a6-1d0e-4022-87d2-\
e2d6940a6aff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<shapePlots.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "shapePlots", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7615520179794674`*^9, 3.761552019840833*^9}, {
   3.7615521913838577`*^9, 3.76155220635884*^9}, {3.7669437340167522`*^9, 
   3.766943736607154*^9}, 3.7819648209784546`*^9, {3.782030288040819*^9, 
   3.782030289031206*^9}, {3.8022521158611135`*^9, 3.8022521258798532`*^9}, {
   3.8022521578182964`*^9, 3.8022521850496025`*^9}, {3.802252294824751*^9, 
   3.8022523413017464`*^9}, {3.8083109787164183`*^9, 3.808310978857131*^9}, {
   3.8083110162456284`*^9, 3.8083110169696994`*^9}, {3.808422701461195*^9, 
   3.8084227015449705`*^9}},
 CellLabel->
  "In[1299]:=",ExpressionUUID->"b50ed1d1-072b-4fd0-ad66-c33adf4239ec"],

Cell[BoxData[
 RowBox[{"--", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.808402701489294*^9, 
  3.808402705396675*^9}},ExpressionUUID->"06529d3b-605c-4051-abc0-\
4ec0b2023913"],

Cell["Test QSE Data Filtering", "Abstract",
 CellChangeTimes->{{3.808418833184719*^9, 3.80841884915672*^9}},
 FontSize->36,ExpressionUUID->"ef9f560c-e9af-4107-ac44-2b8ce5a2832b"],

Cell["\<\
correlatedSets[[1]]
correlatedSets[[2]]
correlatedSets[[4]]
shapeData[[2]]
shapeData[[3]]
shapeData[[5]]\
\>", "Abstract",
 CellChangeTimes->{{3.8084214072254453`*^9, 3.8084214233336554`*^9}, {
  3.8084215674446325`*^9, 3.8084215797292204`*^9}, {3.8084216741793723`*^9, 
  3.808421674433694*^9}},ExpressionUUID->"567ecb94-45b2-435c-8c53-\
43142c7e7b97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testSubject", "=", 
   RowBox[{"shapeData", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "@", "testSubject"}]}], "Input",
 CellChangeTimes->{{3.8083992236936*^9, 3.808399253428237*^9}, {
   3.808399312091526*^9, 3.808399362874717*^9}, {3.808403200392321*^9, 
   3.808403457669774*^9}, {3.8084036795718985`*^9, 3.808403901682046*^9}, {
   3.808404086250163*^9, 3.8084041603748674`*^9}, {3.8084041947280564`*^9, 
   3.808404296341914*^9}, {3.8084043760062604`*^9, 3.8084044190389953`*^9}, {
   3.8084044972804265`*^9, 3.808404569052745*^9}, {3.8084046407319613`*^9, 
   3.8084046529560657`*^9}, {3.8084059624651823`*^9, 3.808405964825794*^9}, {
   3.8084205338209496`*^9, 3.8084205339705505`*^9}, {3.8084211072228937`*^9, 
   3.808421140496837*^9}, {3.8084213246578274`*^9, 3.808421326415122*^9}, {
   3.8084214262897406`*^9, 3.8084214399517517`*^9}, {3.8084215280972576`*^9, 
   3.8084215318621845`*^9}, {3.8084215738645124`*^9, 3.808421595446144*^9}, {
   3.8084216764877105`*^9, 3.808421682060794*^9}, {3.8084218294176817`*^9, 
   3.808421830708227*^9}, {3.8084793291644135`*^9, 3.8084793292581644`*^9}, {
   3.808480080099949*^9, 3.8084800813585787`*^9}, {3.8084802511877565`*^9, 
   3.8084802523815594`*^9}, 3.8084848856249876`*^9, {3.8085660039878645`*^9, 
   3.8085660041754723`*^9}, 3.808566165767828*^9, {3.809180684780887*^9, 
   3.809180684976364*^9}, {3.809208011448069*^9, 3.8092080143842936`*^9}, {
   3.809208281855226*^9, 3.8092082819290314`*^9}},
 CellLabel->
  "In[1339]:=",ExpressionUUID->"c7f997bc-0136-4d0f-9550-830a97e2f71b"],

Cell["Generate Envelope Functions", "Abstract",
 CellChangeTimes->{{3.808418833184719*^9, 3.80841884915672*^9}, {
  3.8084912265331235`*^9, 3.8084912348615866`*^9}},
 FontSize->24,ExpressionUUID->"b79228f8-8ff0-4318-9d97-79d8fca2233d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testThreshold", "=", "0.90"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8084059740690823`*^9, 3.8084059760507617`*^9}, {
   3.8084061589285507`*^9, 3.808406189160034*^9}, {3.8084062839195075`*^9, 
   3.80840631590282*^9}, {3.808407178688931*^9, 3.808407196506467*^9}, 
   3.808407390433344*^9, {3.808407446047789*^9, 3.808407447415123*^9}, 
   3.808407831862463*^9, 3.8084078718377795`*^9, {3.8084211494733267`*^9, 
   3.808421154392722*^9}, {3.808480137503909*^9, 3.808480165308832*^9}, {
   3.808565545491434*^9, 3.808565545522419*^9}, {3.8085657421772566`*^9, 
   3.808565742286791*^9}, {3.808565790427083*^9, 3.8085658117078333`*^9}, 
   3.808647297464489*^9},
 CellLabel->
  "In[1341]:=",ExpressionUUID->"d3b67e91-092d-4bf5-ae8d-0e030657e7fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testFunctions", "=", 
   RowBox[{"QuantileRegression", "[", "\[IndentingNewLine]", 
    RowBox[{"testSubject", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sizeFactor", "*", 
       RowBox[{"Length", "@", "testSubject"}]}], "//", "Round"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", "testThreshold"}], ",", "testThreshold"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"InterpolationOrder", "\[Rule]", "splineOrder"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8084059740690823`*^9, 3.8084059760507617`*^9}, {
   3.8084061589285507`*^9, 3.808406189160034*^9}, {3.8084062839195075`*^9, 
   3.80840631590282*^9}, {3.808407178688931*^9, 3.808407196506467*^9}, 
   3.808407390433344*^9, {3.808407446047789*^9, 3.808407447415123*^9}, 
   3.808407831862463*^9, 3.8084078718377795`*^9, {3.8084211494733267`*^9, 
   3.808421154392722*^9}, {3.808480137503909*^9, 3.808480165308832*^9}, {
   3.808565545491434*^9, 3.808565545522419*^9}, {3.8085657421772566`*^9, 
   3.808565742286791*^9}, {3.808565790427083*^9, 3.8085658117078333`*^9}, {
   3.808647297464489*^9, 3.8086473016393075`*^9}},
 CellLabel->
  "In[1342]:=",ExpressionUUID->"86b49194-ee77-47de-afc6-f18451b4dfa0"],

Cell["Generate Envelope Points", "Abstract",
 CellChangeTimes->{{3.808418833184719*^9, 3.80841884915672*^9}, {
  3.8084912265331235`*^9, 3.8084912490130143`*^9}},
 FontSize->24,ExpressionUUID->"f9ee2530-2b2f-449b-a467-cd4a7a6a53b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testValues", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Range", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Min", "@", "#"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Max", "@", "#"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Max", "@", "#"}], "/", "controlValues"}]}], 
       "\[IndentingNewLine]", "]"}], "&"}], "@", 
     RowBox[{"First", "@", 
      RowBox[{"Transpose", "@", "testSubject"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"testSampling", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"testFunctions", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "[", "k", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", "testValues"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], "&"}], "/@", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "testFunctions"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{"testSampling", "//", "ListPlot"}]}], "Input",
 CellChangeTimes->{{3.808406372518511*^9, 3.8084064073969526`*^9}, {
   3.8084064733978415`*^9, 3.8084065371821127`*^9}, {3.808407405740506*^9, 
   3.808407408670762*^9}, 3.8084211583869467`*^9},
 CellLabel->
  "In[1343]:=",ExpressionUUID->"e0583d81-de65-4ae8-a369-d7a8ecf2bf2d"],

Cell["Compute Filtered Envelopes", "Abstract",
 CellChangeTimes->{{3.808418833184719*^9, 3.80841884915672*^9}, {
  3.8084912265331235`*^9, 3.8084912832446823`*^9}},
 FontSize->24,ExpressionUUID->"c07b6776-4ea3-49b6-a5ab-243a2db49afc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"filteredEnvelopes", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"TotalVariationFilter", "[", 
       RowBox[{"#", ",", "1", ",", 
        RowBox[{"Method", "\[Rule]", "\"\<Gaussian\>\""}], ",", 
        RowBox[{"MaxIterations", "\[Rule]", "Automatic"}]}], "]"}], "&"}], "/@",
      "testSampling"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListPlot", "@", "testSubject"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"testValues", ",", "#"}], "}"}]}], "&"}], "/@", 
     "filteredEnvelopes"}], "//", "ListLinePlot"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8084066037183743`*^9, 3.8084066238915515`*^9}, {
   3.8084067210133753`*^9, 3.80840686722606*^9}, {3.8084070973231916`*^9, 
   3.8084071345773087`*^9}, {3.8084074213385077`*^9, 
   3.8084074310090947`*^9}, {3.808407482838169*^9, 3.8084075453695107`*^9}, {
   3.8084083719485536`*^9, 3.8084083796250486`*^9}, {3.8084105969107103`*^9, 
   3.8084106032677445`*^9}, {3.808412054318325*^9, 3.808412072219627*^9}, 
   3.808412213157071*^9, {3.808412715626507*^9, 3.808412737608407*^9}, {
   3.808420090694994*^9, 3.808420162828169*^9}, 3.808421179802844*^9, {
   3.808565641537407*^9, 3.808565693865059*^9}, {3.8085657275365353`*^9, 
   3.8085657329118795`*^9}, {3.8085661819022193`*^9, 3.808566196814822*^9}},
 CellLabel->
  "In[1346]:=",ExpressionUUID->"767854d0-2cec-403f-a8ed-4784e4d230b7"],

Cell["Find & Remove Outliers", "Abstract",
 CellChangeTimes->{{3.808418833184719*^9, 3.80841884915672*^9}, {
  3.8084912265331235`*^9, 3.808491315821167*^9}},
 FontSize->24,ExpressionUUID->"13eadc33-12e8-4af6-a2d3-cdd9d6bee15c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"interpolateEnvelope", "[", "envelope_", "]"}], ":=", 
   RowBox[{"Interpolation", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Last", "@", 
      RowBox[{"Transpose", "@", "envelope"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Method", "\[Rule]", "\"\<Spline\>\""}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "3"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generateArguments", "[", 
    RowBox[{"dataset_", ",", "envelope_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Position", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"First", "@", 
          RowBox[{"Transpose", "@", "envelope"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"First", "@", 
          RowBox[{"Nearest", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{"Transpose", "@", "envelope"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"First", "@", 
             RowBox[{"dataset", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}],
      "&"}], "/@", 
    RowBox[{"Range", "@", 
     RowBox[{"Length", "@", "dataset"}]}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"envelopeConstraints", "[", 
    RowBox[{"dataset_", ",", "lowLimits_", ",", "highLimits_"}], "]"}], ":=", 
   RowBox[{"Delete", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"dataset", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Position", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "<", 
           RowBox[{"Last", "@", "#3"}], "<", "#2"}], "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"lowLimits", ",", "highLimits", ",", "dataset"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"#", "\[Equal]", "False"}], "&"}], ")"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8084177354534855`*^9, 3.808417765511569*^9}, {
   3.808417829014351*^9, 3.8084179103356504`*^9}, {3.808418557074894*^9, 
   3.808418583251995*^9}, {3.808418627011814*^9, 3.8084187150269856`*^9}, {
   3.8084187651630106`*^9, 3.8084187661044893`*^9}, 3.808479847004327*^9},
 CellLabel->
  "In[1348]:=",ExpressionUUID->"b6706c63-1144-45e3-8595-69394da9b35d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"low", ",", "high"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"testValues", ",", "#"}], "}"}]}], "&"}], "/@", 
     "filteredEnvelopes"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"functionLow", ",", "functionHigh"}], "}"}], "=", 
    RowBox[{"interpolateEnvelope", "/@", 
     RowBox[{"{", 
      RowBox[{"low", ",", "high"}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"argumentsLow", ",", "argumentsHigh"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"generateArguments", "[", "\[IndentingNewLine]", 
       RowBox[{"testSubject", ",", "#"}], "\[IndentingNewLine]", "]"}], "&"}],
      "/@", 
     RowBox[{"{", 
      RowBox[{"low", ",", "high"}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lowLimits", "=", 
   RowBox[{"functionLow", "@", "argumentsLow"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"highLimits", "=", 
    RowBox[{"functionHigh", "@", "argumentsHigh"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outliersRemoved", "=", 
    RowBox[{"envelopeConstraints", "[", 
     RowBox[{"testSubject", ",", "lowLimits", ",", "highLimits"}], "]"}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{"testSubject", ",", "outliersRemoved"}], "]"}], ",", 
        "\[IndentingNewLine]", "outliersRemoved"}], "\[IndentingNewLine]", 
       "}"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Gray"}], "}"}]}]}], "\[IndentingNewLine]", "]"}],
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{"testValues", ",", "#"}], "}"}]}], "&"}], "/@", 
      "filteredEnvelopes"}], "//", "ListLinePlot"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.8084096830543675`*^9, 3.808409752128846*^9}, {
   3.808410239993473*^9, 3.8084102483191643`*^9}, {3.8084105061989126`*^9, 
   3.808410512300498*^9}, {3.8084105705181427`*^9, 3.8084105761236444`*^9}, {
   3.808410788348982*^9, 3.8084108385715504`*^9}, {3.8084108690522118`*^9, 
   3.808410906009754*^9}, {3.808410945092614*^9, 3.808410973201477*^9}, {
   3.8084117401748514`*^9, 3.808411772367957*^9}, {3.808411813991358*^9, 
   3.8084118490288734`*^9}, {3.808412317769762*^9, 3.808412333601822*^9}, {
   3.8084124166443467`*^9, 3.8084124265054493`*^9}, {3.8084175005325584`*^9, 
   3.808417500839735*^9}, {3.808417695703744*^9, 3.8084177139954805`*^9}, {
   3.808417774553358*^9, 3.808417780429423*^9}, {3.808418486287409*^9, 
   3.808418505909624*^9}, {3.8084187730209703`*^9, 3.8084187762493234`*^9}, {
   3.808420193124617*^9, 3.8084202047790117`*^9}, {3.8084211980834217`*^9, 
   3.80842122459344*^9}, 3.8084798533613834`*^9, {3.809180817677355*^9, 
   3.80918084348886*^9}},
 CellLabel->
  "In[1351]:=",ExpressionUUID->"67e39a7c-ef66-4f3e-b481-a17b9c2ff424"],

Cell["Filter The Outlier-Free Dataset", "Abstract",
 CellChangeTimes->{{3.808418833184719*^9, 3.80841884915672*^9}, {
  3.8084912265331235`*^9, 3.8084912832446823`*^9}, {3.808491327220828*^9, 
  3.8084913487411604`*^9}},
 FontSize->24,ExpressionUUID->"b07c7f36-d8e0-4879-b246-89d385e6d807"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testFilteredValues", "=", 
    RowBox[{"TotalVariationFilter", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Last", "@", 
       RowBox[{"Transpose", "@", "outliersRemoved"}]}], ",", 
      "\[IndentingNewLine]", "5", ",", 
      RowBox[{"Method", "\[Rule]", "\"\<Gaussian\>\""}], ",", 
      RowBox[{"MaxIterations", "\[Rule]", "300"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cleanData", "=", 
    RowBox[{"Transpose", "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"First", "@", 
        RowBox[{"Transpose", "@", "outliersRemoved"}]}], ",", 
       "\[IndentingNewLine]", "testFilteredValues"}], "\[IndentingNewLine]", 
      "}"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"testSubject", ",", "cleanData"}], "}"}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"cleanData", ",", 
   RowBox[{"Filling", "\[Rule]", "Axis"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.808419790721904*^9, 3.8084198489980216`*^9}, {
   3.808420380441946*^9, 3.808420519754105*^9}, 3.808421262394885*^9, {
   3.8084802933375177`*^9, 3.808480298749181*^9}, {3.8085658452704787`*^9, 
   3.8085659204414387`*^9}, {3.8085660493467817`*^9, 
   3.8085661345496635`*^9}, {3.8085662150486603`*^9, 
   3.8085662446424108`*^9}, {3.809180802878834*^9, 3.809180805255672*^9}},
 CellLabel->
  "In[1358]:=",ExpressionUUID->"78b9b7cd-1c14-4c4a-8e2b-e60fffbb808f"],

Cell[BoxData[
 RowBox[{"--", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8084124449193068`*^9, 
  3.808412449921074*^9}},ExpressionUUID->"6144916c-912b-4d81-aee4-\
7c6eea291295"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bubble Trajectory & Shape Overlays", "Section",
 CellChangeTimes->{{3.760265089590619*^9, 3.7602651172628264`*^9}, {
  3.7602700926475096`*^9, 3.7602701003668647`*^9}, {3.7603351754409504`*^9, 
  3.760335192976043*^9}, {3.760335258927647*^9, 3.760335285152509*^9}, {
  3.760335344455892*^9, 3.7603353478547945`*^9}, {3.7603369879970007`*^9, 
  3.760336988399926*^9}, {3.760712288838989*^9, 
  3.7607123287975273`*^9}},ExpressionUUID->"c63702c1-a394-48ee-b193-\
2d3e4d46b10e"],

Cell[CellGroupData[{

Cell["Generate Trajectory Point Frames For The Entire Sequence", "Subsection",
 CellChangeTimes->{{3.760712251804734*^9, 3.7607122594242268`*^9}, {
  3.760712338856566*^9, 3.7607123754747734`*^9}, {3.7607125184149294`*^9, 
  3.760712529183816*^9}},ExpressionUUID->"28ad85fe-f71a-4275-898a-\
603d82ff4984"],

Cell[BoxData[{
 RowBox[{"dotLimit", ":=", "15"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotSize", ":=", "0.015"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"colorPalette", ":=", 
  RowBox[{"{", 
   RowBox[{"Purple", ",", "Red", ",", "Orange", ",", "Yellow", ",", "White"}],
    "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"colorPaletteWhite", ":=", "White"}], "\n", 
 RowBox[{
  RowBox[{"colorTableAnimation", ":=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{"White", ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", 
        RowBox[{
         RowBox[{"0.01", "*", 
          RowBox[{"Length", "@", "cleanCentroids"}]}], "//", "Round"}]}], 
       "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colorGrading", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{"k", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", 
          RowBox[{"cleanCentroids", "//", "Length"}], ",", "1"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "//", "Rescale"}], "//", "N"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dotColors", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Blend", "[", "\[IndentingNewLine]", 
       RowBox[{"colorTableAnimation", ",", 
        RowBox[{"colorGrading", "[", 
         RowBox[{"[", "t", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1", ",", 
        RowBox[{"cleanCentroids", "//", "Length"}], ",", "1"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"overlayTrajectoryPoints", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k", "\[LessEqual]", "dotLimit"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Style", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"cleanCentroids", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", 
           RowBox[{"dotColors", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", 
           RowBox[{"PointSize", "@", "dotSize"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"m", ",", "1", ",", "k"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Style", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"cleanCentroids", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", 
           RowBox[{"dotColors", "[", 
            RowBox[{"[", "m", "]"}], "]"}], ",", 
           RowBox[{"PointSize", "@", "dotSize"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"m", ",", 
           RowBox[{"k", "-", "dotLimit"}], ",", "k"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"cleanCentroids", "//", "Length"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7518088336554112`*^9, 3.751808833778096*^9}, {
   3.7518707643405304`*^9, 3.751870764439286*^9}, {3.7518711597673645`*^9, 
   3.7518711607328043`*^9}, {3.7518792237685976`*^9, 
   3.7518792238324265`*^9}, {3.7518825599013352`*^9, 3.7518825624953775`*^9}, 
   3.7519511591041346`*^9, {3.7519512098449535`*^9, 3.751951209991594*^9}, {
   3.7519513709397383`*^9, 3.75195150932121*^9}, {3.751951963951079*^9, 
   3.7519519684484987`*^9}, {3.7519521827949553`*^9, 3.751952183263075*^9}, {
   3.7519522576471825`*^9, 3.7519522580787134`*^9}, {3.7519546762745113`*^9, 
   3.751954676520849*^9}, {3.7519574161153555`*^9, 3.7519574210930443`*^9}, {
   3.751957545783086*^9, 3.75195754924483*^9}, 3.751957660027594*^9, {
   3.751958034211364*^9, 3.7519580345101724`*^9}, {3.7519863722352495`*^9, 
   3.7519863724137506`*^9}, {3.7519869491964626`*^9, 3.75198696429519*^9}, {
   3.7519873139141493`*^9, 3.751987332717868*^9}, {3.751987552702552*^9, 
   3.7519875543162217`*^9}, {3.751988231279371*^9, 3.7519882324741793`*^9}, {
   3.7519883625543118`*^9, 3.7519883990676603`*^9}, {3.7519884533009815`*^9, 
   3.75198848059398*^9}, {3.7519885114773865`*^9, 3.7519885328013344`*^9}, 
   3.751988640756645*^9, {3.751989079749445*^9, 3.7519891191171675`*^9}, {
   3.752000908491932*^9, 3.752000959249769*^9}, {3.752000993594683*^9, 
   3.7520009971974716`*^9}, {3.7520017268431053`*^9, 3.752001737669013*^9}, {
   3.75200242175712*^9, 3.7520024265268517`*^9}, {3.7523847952380543`*^9, 
   3.752384796668471*^9}, {3.75993656579086*^9, 3.7599366108784857`*^9}, {
   3.7601867319423285`*^9, 3.760186794045266*^9}, 3.7601868976117396`*^9, {
   3.7602782926218524`*^9, 3.7602782927076206`*^9}, 3.760278333515128*^9, {
   3.7604283964160223`*^9, 3.7604283965606585`*^9}, {3.760691640006768*^9, 
   3.7606916421909285`*^9}, {3.760699093027953*^9, 3.7606991099125853`*^9}, {
   3.7607003119128265`*^9, 3.760700409595916*^9}, {3.76070048747919*^9, 
   3.7607004935479927`*^9}, {3.760701087232769*^9, 3.760701101403026*^9}, {
   3.7607011416280932`*^9, 3.760701303791312*^9}, {3.76070146707268*^9, 
   3.7607014901791058`*^9}, {3.7607015242106175`*^9, 3.760701524550708*^9}, {
   3.7607016442871437`*^9, 3.7607016445065536`*^9}, {3.760701677025343*^9, 
   3.760701710851102*^9}, {3.7607022628002996`*^9, 3.760702292183274*^9}, {
   3.7607023357516985`*^9, 3.7607023602976427`*^9}, {3.7607036251234913`*^9, 
   3.7607036399137745`*^9}, {3.760703694698728*^9, 3.76070375197346*^9}, {
   3.7607037918544593`*^9, 3.760703825717725*^9}, {3.760703878287715*^9, 
   3.7607038957255063`*^9}, {3.7607039286249666`*^9, 
   3.7607039288683233`*^9}, {3.7607039674799147`*^9, 
   3.7607039687907815`*^9}, {3.7607043720715065`*^9, 3.760704450268816*^9}, {
   3.760708854412287*^9, 3.7607088890247235`*^9}, {3.7607091457896757`*^9, 
   3.760709150461417*^9}, {3.7607091847728367`*^9, 3.7607091965046053`*^9}, {
   3.7607094368695*^9, 3.760709521216991*^9}, {3.760710096422129*^9, 
   3.760710120850543*^9}, 3.760712244374708*^9, {3.760712440632737*^9, 
   3.7607124419138355`*^9}, {3.7608977098244815`*^9, 3.760897744337561*^9}, {
   3.761288211914033*^9, 3.761288237151808*^9}, 3.761303842766664*^9, {
   3.761308471613958*^9, 3.761308497313163*^9}, {3.7613791144205027`*^9, 
   3.7613791149231586`*^9}, {3.7613798274046893`*^9, 
   3.7613798759874306`*^9}, {3.76137992013955*^9, 3.761379925770079*^9}, {
   3.766943281342203*^9, 3.7669433281637344`*^9}, {3.767011253376182*^9, 
   3.767011253672146*^9}, {3.773322980584749*^9, 3.7733229820219307`*^9}, {
   3.78202479245177*^9, 3.7820247971068907`*^9}, {3.7820310100982523`*^9, 
   3.7820310954158535`*^9}, 3.7820312873568134`*^9, {3.807940600424323*^9, 
   3.8079406036127863`*^9}, {3.808119372226326*^9, 3.80811937772644*^9}, 
   3.8081373019641943`*^9, 3.808314400084977*^9, {3.808487589241158*^9, 
   3.8084875931496925`*^9}, 3.808564859574382*^9, {3.808569818833851*^9, 
   3.808569819032259*^9}, {3.8085706331330757`*^9, 3.808570646893735*^9}, {
   3.808658533774328*^9, 3.8086585349781723`*^9}, {3.8091239510931873`*^9, 
   3.809123977751257*^9}},
 CellLabel->
  "In[1323]:=",ExpressionUUID->"b01a0623-27b0-4838-8901-545ea48b4d15"],

Cell[BoxData[
 RowBox[{"--", 
  RowBox[{"--", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8085704295794773`*^9, 
  3.808570432480699*^9}},ExpressionUUID->"0074c942-2c50-46de-9f81-\
7be0714574a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Accumulated Point Set", "Subsection",
 CellChangeTimes->{{3.7607124645821395`*^9, 3.7607125031592665`*^9}, {
  3.7607125386928883`*^9, 
  3.760712547905212*^9}},ExpressionUUID->"55505fd0-c017-46c0-a5a6-\
961cc14a2b9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colorPaletteAll", ":=", "\"\<SunsetColors\>\""}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colorTableAll", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Blend", "[", "\[IndentingNewLine]", 
       RowBox[{"colorPaletteAll", ",", 
        RowBox[{"colorGrading", "[", 
         RowBox[{"[", "t", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1", ",", 
        RowBox[{"cleanCentroids", "//", "Length"}], ",", "1"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showAllDots", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Style", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cleanCentroids", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       RowBox[{"colorTableAll", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       RowBox[{"PointSize", "@", "dotSize"}]}], "\[IndentingNewLine]", "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"cleanCentroids", "//", "Length"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7607124645821395`*^9, 3.7607124768811245`*^9}, {
   3.7613797739722395`*^9, 3.761379792738236*^9}, {3.761379832043831*^9, 
   3.761379853899453*^9}, {3.7669433179620295`*^9, 3.7669433332765794`*^9}, {
   3.7820247981802254`*^9, 3.7820248006496964`*^9}, 3.782031024375828*^9, 
   3.782031079383522*^9, {3.7820311213127823`*^9, 3.7820311413683167`*^9}, 
   3.8084911882863016`*^9, {3.808570989066691*^9, 3.808570992241721*^9}},
 CellLabel->
  "In[1331]:=",ExpressionUUID->"a6d66661-1356-4058-b346-8aba2f0799c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["[[ View The Accumulated Point Set ]]", "Subsection",
 CellChangeTimes->{{3.7607125899698305`*^9, 
  3.760712618036704*^9}},ExpressionUUID->"30411647-9621-4220-bb23-\
908abf46f818"],

Cell[BoxData[
 RowBox[{"overlayAllDots", "=", 
  RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Last", "@", "images"}], ",", "\[IndentingNewLine]", 
    "showAllDots"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.761379490653239*^9, 3.7613796330347605`*^9}, 
   3.761379678602796*^9, {3.766942388617775*^9, 3.766942390302738*^9}, 
   3.781965399187592*^9, 3.782031141985935*^9, 3.7820311913196697`*^9},
 CellLabel->
  "In[1334]:=",ExpressionUUID->"1e652275-19eb-462f-bb1b-f44d276df64d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Accumulated Trajectories >>", "Subsection",
 CellChangeTimes->{{3.7607118428764553`*^9, 3.76071185921566*^9}, {
  3.7615520070766373`*^9, 3.7615520160286875`*^9}, {3.7615532921375833`*^9, 
  3.761553299235276*^9}, {3.761553689410019*^9, 
  3.761553695853011*^9}},ExpressionUUID->"665c6e48-42f4-4c89-94a2-\
6a3da708e075"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"output", "<>", "\"\<trajectories.jpg\>\""}], ",", 
    "\[IndentingNewLine]", "overlayAllDots", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7615520179794674`*^9, 3.761552019840833*^9}, {
   3.7615521913838577`*^9, 3.76155220635884*^9}, {3.761553309525111*^9, 
   3.761553331490259*^9}, {3.7615537204881945`*^9, 3.761553734268787*^9}, {
   3.7669438998025675`*^9, 3.7669439027257633`*^9}, 3.7819648306979475`*^9, 
   3.782031191855338*^9},
 CellLabel->
  "In[1335]:=",ExpressionUUID->"34cf8fbf-a8ec-4273-8d0a-ea35b242be9c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Shape & Centroid Detection Overlays", "Subsection",
 CellChangeTimes->{{3.7607124645821395`*^9, 3.7607124768811245`*^9}, {
  3.7607125605197573`*^9, 
  3.7607125806513805`*^9}},ExpressionUUID->"0daef9d0-7341-4f56-b312-\
f8695cb56ef6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"centroidMarkerSize", "=", "0.025"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"overlayDotsAndShapes", "[", "imageID_", "]"}], ":=", 
  RowBox[{"HighlightImage", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viewDetectedBubbles", "@", "imageID"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"overlayTrajectoryPoints", "[", 
     RowBox[{"[", "imageID", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7518088336554112`*^9, 3.751808833778096*^9}, {
   3.7518707643405304`*^9, 3.751870764439286*^9}, {3.7518711597673645`*^9, 
   3.7518711607328043`*^9}, {3.7518792237685976`*^9, 
   3.7518792238324265`*^9}, {3.7518825599013352`*^9, 3.7518825624953775`*^9}, 
   3.7519511591041346`*^9, {3.7519512098449535`*^9, 3.751951209991594*^9}, {
   3.7519513709397383`*^9, 3.75195150932121*^9}, {3.751951963951079*^9, 
   3.7519519684484987`*^9}, {3.7519521827949553`*^9, 3.751952183263075*^9}, {
   3.7519522576471825`*^9, 3.7519522580787134`*^9}, {3.7519546762745113`*^9, 
   3.751954676520849*^9}, {3.7519574161153555`*^9, 3.7519574210930443`*^9}, {
   3.751957545783086*^9, 3.75195754924483*^9}, 3.751957660027594*^9, {
   3.751958034211364*^9, 3.7519580345101724`*^9}, {3.7519863722352495`*^9, 
   3.7519863724137506`*^9}, {3.7519869491964626`*^9, 3.75198696429519*^9}, {
   3.7519873139141493`*^9, 3.751987332717868*^9}, {3.751987552702552*^9, 
   3.7519875543162217`*^9}, {3.751988231279371*^9, 3.7519882324741793`*^9}, {
   3.7519883625543118`*^9, 3.7519883990676603`*^9}, {3.7519884533009815`*^9, 
   3.75198848059398*^9}, {3.7519885114773865`*^9, 3.7519885328013344`*^9}, 
   3.751988640756645*^9, {3.751989079749445*^9, 3.7519891191171675`*^9}, {
   3.752000908491932*^9, 3.752000959249769*^9}, {3.752000993594683*^9, 
   3.7520009971974716`*^9}, {3.7520017268431053`*^9, 3.752001737669013*^9}, {
   3.75200242175712*^9, 3.7520024265268517`*^9}, {3.7523847952380543`*^9, 
   3.752384796668471*^9}, {3.75993656579086*^9, 3.7599366108784857`*^9}, {
   3.7601867319423285`*^9, 3.760186794045266*^9}, {3.7601868976117396`*^9, 
   3.760186905556492*^9}, {3.7602782970849147`*^9, 3.7602782972434897`*^9}, {
   3.760278328116565*^9, 3.7602783320829587`*^9}, {3.760699213440055*^9, 
   3.760699213561728*^9}, {3.760701416587208*^9, 3.7607014233691025`*^9}, {
   3.76070335727628*^9, 3.760703420104371*^9}, {3.7607035294725876`*^9, 
   3.7607035295407467`*^9}, {3.760703586031547*^9, 3.7607035863437047`*^9}, 
   3.7607101303417273`*^9, 3.760712558751754*^9, 3.7669439371502075`*^9, {
   3.7669439684560504`*^9, 3.7669439708835382`*^9}, 3.7819653976446657`*^9, {
   3.7820232301033325`*^9, 3.782023231147687*^9}, 3.782023444648912*^9, {
   3.7820311575520253`*^9, 3.78203117582405*^9}, 3.782031288333209*^9, {
   3.808313020970913*^9, 3.8083130480925503`*^9}, {3.809124090099845*^9, 
   3.8091241097556314`*^9}},
 CellLabel->
  "In[1336]:=",ExpressionUUID->"93a579ab-8056-4c9a-b0e2-035e635cba3a"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"overlayDotsAndShapes", "[", "k", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"k", ",", "1", ",", 
     RowBox[{"Length", "@", "bubbleLocations"}], ",", "1"}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7607102469039335`*^9, 3.760710248654275*^9}, {
   3.760712777036174*^9, 3.7607128133656764`*^9}, {3.7607130084686136`*^9, 
   3.760713012620864*^9}, {3.7607140396793337`*^9, 3.7607140540049734`*^9}, {
   3.7612880161453953`*^9, 3.761288016967374*^9}, {3.7669433680021515`*^9, 
   3.7669433682769823`*^9}, {3.7670116093489585`*^9, 3.767011610491256*^9}, 
   3.7820248015311513`*^9, {3.8077070952685857`*^9, 3.807707096181145*^9}, {
   3.808313097198724*^9, 3.8083131150778284`*^9}, 3.808314047971946*^9},
 CellLabel->
  "In[1338]:=",ExpressionUUID->"adb63223-1aa1-4508-9661-fd954075809e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["<< Export Images With Detection Overlays >>", "Subsection",
 CellChangeTimes->{{3.7607124645821395`*^9, 3.7607124768811245`*^9}, {
  3.7607125605197573`*^9, 3.7607125806513805`*^9}, {3.8083199566447244`*^9, 
  3.808319985299646*^9}},ExpressionUUID->"01d6b984-5e7d-4a27-8bf3-\
77ceecd0a6cb"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DirectoryQ", "[", 
       RowBox[{"output", "<>", "traceFolder"}], "]"}], ",", 
      "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"output", "<>", "traceFolder"}], "//", "CreateDirectory"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Map", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Export", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"output", "<>", "traceFolder", "<>", "\"\<Frame_\>\"", "<>", 
          RowBox[{"ToString", "@", "#"}], "<>", "\"\<.jpg\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"overlayDotsAndShapes", "@", "#"}], ",", 
         RowBox[{"ImageResolution", "\[Rule]", "60"}]}], 
        "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "images"}]}]}], "\[IndentingNewLine]", "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8083148128938785`*^9, 3.808314813733629*^9}, {
  3.808314886191124*^9, 3.808314922508477*^9}, {3.8083149903819027`*^9, 
  3.8083150094203267`*^9}, {3.8085666862019777`*^9, 3.8085666878897276`*^9}, {
  3.8091241623266973`*^9, 3.8091241632033434`*^9}, {3.8091750028245263`*^9, 
  3.8091750029921465`*^9}},
 CellLabel->
  "In[1362]:=",ExpressionUUID->"517aa383-712b-499c-98fc-76526f141e64"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1200, 1837},
WindowMargins->{{Automatic, -1208}, {Automatic, 73}},
TaggingRules->{
 "TryRealOnly" -> False, "PresenterSettings" -> {"Dialogs" -> {}}},
CellContext->Notebook,
Magnification:>1.2 Inherited,
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 9, 2020)",
StyleDefinitions->FrontEnd`FileName[{"PresenterTools"}, "Sky.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"355dcb51-1679-49b4-9e0f-28b133f903bf"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 681, 16, 233, "Abstract",ExpressionUUID->"76b6aff5-3fbb-4e32-afe8-4cc5af2f6a3c"],
Cell[1242, 38, 270, 4, 73, "Abstract",ExpressionUUID->"3dc700d4-5b6b-41d8-9979-0e29b4ad4067"],
Cell[1515, 44, 474, 7, 30, "Subitem",ExpressionUUID->"2820d418-f4f9-41d2-ba5d-5f1758558e62"],
Cell[CellGroupData[{
Cell[2014, 55, 157, 3, 77, "Section",ExpressionUUID->"ca134099-a44f-4fdc-af75-6ea375b76f8d"],
Cell[2174, 60, 23768, 491, 3654, "Input",ExpressionUUID->"edac2b02-475e-4e60-b366-13d62ed9901a",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[25967, 555, 432, 6, 56, "Subsection",ExpressionUUID->"017da1e3-7fcb-4307-b933-24e60c1d6fe2"],
Cell[26402, 563, 10799, 156, 152, "Input",ExpressionUUID->"47925b52-880c-4534-8e82-9c8c13d9193b",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37250, 725, 263, 4, 77, "Section",ExpressionUUID->"35abad1e-7e64-4b42-bdf8-50951d2c24e3"],
Cell[CellGroupData[{
Cell[37538, 733, 306, 4, 62, "Subsection",ExpressionUUID->"eac7f8cb-4351-460b-bda7-41520db751b0"],
Cell[37847, 739, 3877, 82, 821, "Input",ExpressionUUID->"ae3c69d3-3b63-4707-8988-3bf867d4b302"]
}, Closed]],
Cell[CellGroupData[{
Cell[41761, 826, 165, 3, 46, "Subsection",ExpressionUUID->"5551d25d-20c7-431b-8299-80566cdd9a9c"],
Cell[41929, 831, 6121, 103, 396, "Input",ExpressionUUID->"d4381aa1-91bc-498f-ae1f-ae9879b13ef8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48087, 939, 384, 6, 56, "Subsection",ExpressionUUID->"25fd5b27-2d4e-4bea-8607-f6b7b1b934ab"],
Cell[48474, 947, 2014, 33, 132, "Input",ExpressionUUID->"73c4344f-b100-4e22-bd4f-f410eaa567bf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50537, 986, 425, 6, 77, "Section",ExpressionUUID->"73171e84-ff78-4f70-8ad6-58ce60256525"],
Cell[CellGroupData[{
Cell[50987, 996, 417, 6, 56, "Subsection",ExpressionUUID->"c9bcd0c6-5d88-4c60-b234-c425b1f6174a"],
Cell[51407, 1004, 438, 15, 313, "Abstract",ExpressionUUID->"e42d8b65-6fa7-4c27-8d7b-edffa91acb40"],
Cell[51848, 1021, 6154, 113, 824, "Input",ExpressionUUID->"06671b36-aca7-4947-911e-c04466145ab8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[58039, 1139, 512, 8, 46, "Subsection",ExpressionUUID->"67689526-4625-490a-a673-d716c66eed63"],
Cell[58554, 1149, 294, 11, 206, "Abstract",ExpressionUUID->"b6e66938-af96-4838-b3ae-71ea1601ab69"],
Cell[58851, 1162, 4220, 83, 536, "Input",ExpressionUUID->"b3657ebc-015d-4dae-ab75-a0feff1304db",
 InitializationCell->True],
Cell[63074, 1247, 1898, 38, 276, "Input",ExpressionUUID->"ee835835-713c-4ed0-be06-c25acdbdf70b"],
Cell[64975, 1287, 2301, 43, 348, "Input",ExpressionUUID->"aebc364d-d081-4371-ad47-cda9c1c090ca"]
}, Closed]],
Cell[CellGroupData[{
Cell[67313, 1335, 497, 7, 46, "Subsection",ExpressionUUID->"7ef77be6-35e1-48ff-8fa7-55a51994d53a"],
Cell[67813, 1344, 270, 4, 73, "Abstract",ExpressionUUID->"be4aaeef-0081-4d6a-a2c3-395d604ef133"],
Cell[68086, 1350, 547, 9, 30, "Subitem",ExpressionUUID->"c2e83949-2696-47a3-9384-b835195024bb"],
Cell[68636, 1361, 3500, 74, 444, "Input",ExpressionUUID->"bd37bc39-e5cd-41cc-81bb-80dface241d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72173, 1440, 427, 6, 56, "Subsection",ExpressionUUID->"99adb542-1bb8-47b6-b181-df6e79a763bf"],
Cell[72603, 1448, 5106, 78, 220, "Input",ExpressionUUID->"a0c52905-37b7-4e1f-a8fb-0c4a99b54622"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77758, 1532, 281, 4, 77, "Section",ExpressionUUID->"fa407044-2d2f-45bd-acae-09dd04cf05a8"],
Cell[CellGroupData[{
Cell[78064, 1540, 232, 4, 56, "Subsection",ExpressionUUID->"603b9821-0f7f-4cb3-a916-a850c4cb7bea"],
Cell[78299, 1546, 2832, 51, 444, "Input",ExpressionUUID->"033a074b-7352-4fd5-81cd-1999fec08685"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81168, 1602, 358, 5, 56, "Subsection",ExpressionUUID->"76dde5e4-d54b-4046-a156-9e2abb4bcd05"],
Cell[81529, 1609, 3240, 57, 444, "Input",ExpressionUUID->"498933b0-c3a4-45fe-a819-f21062c0ab04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84806, 1671, 190, 3, 56, "Subsection",ExpressionUUID->"a67736a4-2bfb-44f8-a593-9ad050d68387"],
Cell[84999, 1676, 3223, 60, 540, "Input",ExpressionUUID->"4ca4521a-1507-42a8-bab3-5422b188811b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88259, 1741, 343, 5, 56, "Subsection",ExpressionUUID->"4eb7c598-ba33-450d-9d89-b88294287f54"],
Cell[88605, 1748, 3892, 70, 540, "Input",ExpressionUUID->"81c48a80-21ae-4be4-b551-d8e30d945f45"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[92546, 1824, 327, 5, 77, "Section",ExpressionUUID->"0c10bdc7-1e83-4f75-afc1-ae629374c1d2"],
Cell[92876, 1831, 2085, 38, 176, "Input",ExpressionUUID->"66f11905-9bdc-43d3-83ac-6259c5fced5b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[94986, 1873, 373, 6, 56, "Subsection",ExpressionUUID->"81e3ee31-d34f-40c6-873b-a998302564a0"],
Cell[95362, 1881, 1296, 30, 324, "Input",ExpressionUUID->"c6a14208-3ff4-438c-ae5d-d8baece47a39"],
Cell[96661, 1913, 1431, 44, 35, "Input",ExpressionUUID->"129c71d1-56f4-437a-8351-1f9831882359"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98129, 1962, 329, 5, 56, "Subsection",ExpressionUUID->"1a910300-7101-44a2-af4d-ec92bd3299c2"],
Cell[98461, 1969, 2354, 44, 396, "Input",ExpressionUUID->"5fbe028c-c19a-43a5-8c0d-f62c3c410e28"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[100864, 2019, 343, 5, 77, "Section",ExpressionUUID->"7a32f6d2-0e5e-41cc-978c-e18beb807099"],
Cell[101210, 2026, 270, 4, 73, "Abstract",ExpressionUUID->"b93ab03c-57c7-412a-a260-033d0edf2014"],
Cell[101483, 2032, 511, 7, 30, "Subitem",ExpressionUUID->"54af23c8-d623-4688-bd68-a9a3e2295ff0"],
Cell[CellGroupData[{
Cell[102019, 2043, 318, 5, 56, "Subsection",ExpressionUUID->"137c5652-b25d-44b0-91bb-ca84bd73119a"],
Cell[102340, 2050, 396, 14, 313, "Abstract",ExpressionUUID->"5daf6f3c-7958-4b8b-aa06-cd95a80e9d0b"],
Cell[102739, 2066, 20565, 455, 3707, "Input",ExpressionUUID->"ec29e171-4e98-407a-a37f-1a21dae477c8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[123341, 2526, 392, 6, 46, "Subsection",ExpressionUUID->"8e5b27ee-b6a8-4e8b-aa53-240ff0456546"],
Cell[123736, 2534, 17500, 421, 3992, "Input",ExpressionUUID->"acf519cd-e47c-4529-97ce-7f686ed4b641",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[141273, 2960, 503, 8, 56, "Subsection",ExpressionUUID->"a3fccd37-3b17-47bd-b563-6a5621524ed2"],
Cell[141779, 2970, 26402, 529, 6656, "Input",ExpressionUUID->"dfc1ae93-77e0-4b26-b6ce-adfbcfd9e9dd",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[168218, 3504, 577, 8, 56, "Subsection",ExpressionUUID->"bb0ffe00-ded1-43eb-af55-196c62a1a892"],
Cell[168798, 3514, 2749, 49, 252, "Input",ExpressionUUID->"f9aa589e-ed54-427a-a44f-42a0cbd7d871"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171584, 3568, 632, 9, 56, "Subsection",ExpressionUUID->"1761a9ad-ae22-4eb5-a40f-1a28984dd337"],
Cell[172219, 3579, 1611, 27, 80, "Input",ExpressionUUID->"26c30288-3801-4c33-9bf3-ee3de75e6ba8",
 InitializationCell->True],
Cell[173833, 3608, 2315, 45, 324, "Input",ExpressionUUID->"d859eb99-abcd-4b60-85c6-f4417775207a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176185, 3658, 581, 8, 56, "Subsection",ExpressionUUID->"41d4df71-8b25-4f6d-82cc-8ba6d7d60222"],
Cell[176769, 3668, 1963, 48, 464, "Input",ExpressionUUID->"35c9c40b-9bde-4e88-8bd1-7b7a334882c7",
 InitializationCell->True],
Cell[178735, 3718, 6154, 149, 1452, "Input",ExpressionUUID->"1a81dab7-4a2b-4eb9-ae1d-e6031f46615f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184926, 3872, 625, 9, 56, "Subsection",ExpressionUUID->"264210da-1b9a-4180-90a2-b43edd8750d8"],
Cell[185554, 3883, 1225, 29, 296, "Input",ExpressionUUID->"72105171-acb6-42ee-b30e-0ca436786f21",
 InitializationCell->True],
Cell[186782, 3914, 5182, 107, 1188, "Input",ExpressionUUID->"53dcc669-ecc2-4a9c-a11d-f9ebe8658a65"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[192013, 4027, 371, 6, 77, "Section",ExpressionUUID->"74bfa0ca-5143-45f7-bc3f-0badd313be74"],
Cell[CellGroupData[{
Cell[192409, 4037, 520, 8, 56, "Subsection",ExpressionUUID->"95b43ea5-4164-42cd-95e6-455771216ad6"],
Cell[192932, 4047, 4151, 78, 536, "Input",ExpressionUUID->"e3c6f3b5-fd1c-41ff-a424-447d7ff12a6f",
 InitializationCell->True],
Cell[197086, 4127, 2982, 64, 396, "Input",ExpressionUUID->"58c9947e-8e0b-42d5-9524-e17535ec7f26"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200105, 4196, 424, 6, 56, "Subsection",ExpressionUUID->"b1f5d2bd-0a97-4bcc-af4b-a76dec3b51f1"],
Cell[200532, 4204, 1867, 40, 276, "Input",ExpressionUUID->"df1f7568-b5d7-44e7-bce4-c5076c16fd1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202436, 4249, 415, 6, 56, "Subsection",ExpressionUUID->"80358d00-3f0b-4f4e-9fb8-b2a09b6a500f"],
Cell[202854, 4257, 217, 7, 127, "Abstract",ExpressionUUID->"4c0d205f-b95e-4639-8fa0-cc9bbdd5c3ca"],
Cell[203074, 4266, 1418, 22, 55, "Input",ExpressionUUID->"94c65b4a-fdeb-46bf-8a27-7c9aa7912e75",
 InitializationCell->True],
Cell[204495, 4290, 1644, 40, 156, "Input",ExpressionUUID->"899840c2-f2b7-4a13-a737-d2e599a1d150"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206176, 4335, 471, 7, 56, "Subsection",ExpressionUUID->"2fc3274a-2d09-42ce-830c-3eac2268c4f8"],
Cell[206650, 4344, 2711, 58, 372, "Input",ExpressionUUID->"5db0ba91-54b1-4107-b39e-4d291e91b3ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209398, 4407, 380, 6, 56, "Subsection",ExpressionUUID->"6fd83c9f-a61c-48bf-b045-76b0e561fb46"],
Cell[209781, 4415, 2423, 44, 348, "Input",ExpressionUUID->"02d3884b-4c30-4100-8898-6808d054c629"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[212253, 4465, 218, 4, 77, "Section",ExpressionUUID->"021d79a9-e1d3-4ae4-94b5-353f0667ecdf"],
Cell[CellGroupData[{
Cell[212496, 4473, 574, 8, 56, "Subsection",ExpressionUUID->"aee27611-2370-44b9-bc54-e111f9895f75"],
Cell[213073, 4483, 2175, 54, 372, "Input",ExpressionUUID->"a1d75601-c001-451e-a702-c001c9ada3d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215285, 4542, 429, 6, 56, "Subsection",ExpressionUUID->"2aa355e3-e5e5-440a-bc6d-72dbc22e9a3a"],
Cell[215717, 4550, 270, 4, 73, "Abstract",ExpressionUUID->"89dd722e-3bb3-45ba-932a-7f5ee3921be9"],
Cell[215990, 4556, 504, 7, 30, "Subitem",ExpressionUUID->"0ebe6d5b-ebca-43a0-a671-d0f5dd40c79b"],
Cell[216497, 4565, 4196, 88, 564, "Input",ExpressionUUID->"fed2124e-8107-45f8-a92a-52dae5ec8f4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220730, 4658, 475, 7, 56, "Subsection",ExpressionUUID->"6b67f1b4-081e-412f-845b-e7856dba678d"],
Cell[221208, 4667, 1357, 32, 180, "Input",ExpressionUUID->"856c7ebe-d8ea-451d-a46e-03af7dc41652"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222602, 4704, 534, 8, 56, "Subsection",ExpressionUUID->"aece2adc-449e-45f5-b835-d5e8e0b922d2"],
Cell[223139, 4714, 347, 11, 206, "Abstract",ExpressionUUID->"e843e7e9-ba32-4b27-8a51-113d4ed0e3e9"],
Cell[223489, 4727, 6024, 112, 632, "Input",ExpressionUUID->"5532f4c3-7285-4a1f-97f8-5514c7940350",
 InitializationCell->True],
Cell[229516, 4841, 6448, 129, 1020, "Input",ExpressionUUID->"fb66a48c-ed4b-4563-9181-801fb3ba0449"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[236013, 4976, 476, 7, 77, "Section",ExpressionUUID->"7e3646c0-20e4-41ca-9958-5eb313501ada"],
Cell[CellGroupData[{
Cell[236514, 4987, 435, 6, 56, "Subsection",ExpressionUUID->"062eaf19-b465-4d75-8724-5e2aee8fb285"],
Cell[236952, 4995, 5673, 145, 1452, "Input",ExpressionUUID->"32c1fdde-4a67-466c-95ec-00c015bbf518"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242662, 5145, 477, 7, 56, "Subsection",ExpressionUUID->"2aa80eab-6070-48a7-a47d-2e4d5c0de9aa"],
Cell[243142, 5154, 2372, 60, 636, "Input",ExpressionUUID->"43b99050-6b8f-4ccd-8c6c-a5ab2b240ce6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[245551, 5219, 475, 7, 56, "Subsection",ExpressionUUID->"54ca450f-6c7c-489e-9a35-b9f818084ffb"],
Cell[246029, 5228, 1247, 29, 296, "Input",ExpressionUUID->"833c0780-8cef-456d-b5af-e93ab4aae17a",
 InitializationCell->True],
Cell[247279, 5259, 369, 6, 35, "Input",ExpressionUUID->"a7b4a05e-f6d0-4259-82e2-b2d3f3ca3d2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247685, 5270, 379, 6, 56, "Subsection",ExpressionUUID->"327808da-abb1-4eee-a6c6-9d0b45707382"],
Cell[248067, 5278, 3543, 59, 300, "Input",ExpressionUUID->"e04e8516-e975-40f7-a898-7244a94c0988"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251647, 5342, 393, 6, 56, "Subsection",ExpressionUUID->"b91a0d8f-6940-428e-846a-5e841f6f9aef"],
Cell[252043, 5350, 1256, 30, 248, "Input",ExpressionUUID->"16f9d38e-6779-46e9-9872-7e4796bbdbf9",
 InitializationCell->True],
Cell[253302, 5382, 4791, 115, 708, "Input",ExpressionUUID->"55331abd-306f-49f1-9c1a-1e17530f804f"],
Cell[CellGroupData[{
Cell[258118, 5501, 471, 7, 44, "Subsubsection",ExpressionUUID->"80cdbfe7-e6e7-4433-a2df-13a4e1e13482"],
Cell[258592, 5510, 615, 13, 108, "Input",ExpressionUUID->"a2f38253-986d-421c-aad7-2ffc4d6b250c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[259256, 5529, 454, 7, 56, "Subsection",ExpressionUUID->"f776727f-472d-4406-8c00-b48fd8506d11"],
Cell[259713, 5538, 4344, 90, 872, "Input",ExpressionUUID->"9faa1a79-b583-49b7-8947-c3bd2359e66d",
 InitializationCell->True],
Cell[264060, 5630, 1107, 20, 108, "Input",ExpressionUUID->"b7d541e8-87c3-4dd2-bf76-99633f16b2d7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[265216, 5656, 723, 10, 77, "Section",ExpressionUUID->"a62d7327-78b1-4b65-ab3f-5c2e590aff1c"],
Cell[CellGroupData[{
Cell[265964, 5670, 195, 3, 56, "Subsection",ExpressionUUID->"ace74f6f-015b-4134-92ea-b380b60b5321"],
Cell[266162, 5675, 1917, 53, 276, "Input",ExpressionUUID->"db3ad4e0-3fd1-4425-a7fb-972dd5ea0163"]
}, Open  ]],
Cell[CellGroupData[{
Cell[268116, 5733, 218, 4, 56, "Subsection",ExpressionUUID->"e57ffc5c-12eb-4288-81e0-153fa945ea11"],
Cell[268337, 5739, 1164, 21, 108, "Input",ExpressionUUID->"bedd483f-6bcb-4423-8573-1ca60d679817"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269538, 5765, 230, 4, 56, "Subsection",ExpressionUUID->"5b5e9ecf-5369-4925-b118-c3d1ca9b4e16"],
Cell[269771, 5771, 1085, 21, 180, "Input",ExpressionUUID->"130815c2-1265-4418-9a03-f5d12833fe9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[270893, 5797, 228, 4, 56, "Subsection",ExpressionUUID->"cc304fb7-4ad8-46e5-8188-3fa52fcc330f"],
Cell[271124, 5803, 2774, 53, 305, "Input",ExpressionUUID->"fdef8ec3-1844-4dee-8303-0fed011f9137",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[273935, 5861, 221, 4, 56, "Subsection",ExpressionUUID->"91793c95-5d42-4c1c-b5d2-e5eb97dbdd49"],
Cell[274159, 5867, 4119, 78, 408, "Input",ExpressionUUID->"b9e2bfc0-c732-4455-9af9-bdba468c25ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[278315, 5950, 226, 4, 56, "Subsection",ExpressionUUID->"0087650c-c7e8-4d1e-9e2f-53e4e376bc83"],
Cell[278544, 5956, 1026, 22, 108, "Input",ExpressionUUID->"0e3780af-4b57-4412-a5f9-82e2c82d27e2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[279619, 5984, 264, 4, 77, "Section",ExpressionUUID->"8ae1f463-c8fb-499c-b2a1-24304542d30e"],
Cell[CellGroupData[{
Cell[279908, 5992, 166, 3, 56, "Subsection",ExpressionUUID->"58498ae9-6fae-4c0c-9ae1-e65c58fb633c"],
Cell[280077, 5997, 2931, 50, 156, "Input",ExpressionUUID->"e1437631-fb9e-4918-8a5c-fe852a75f669"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283045, 6052, 178, 3, 56, "Subsection",ExpressionUUID->"e7081559-9768-4d4f-a5fc-dd47ea61101b"],
Cell[283226, 6057, 838, 16, 108, "Input",ExpressionUUID->"9cd32f1e-2880-40a4-947a-462fb7664c7c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[284101, 6078, 172, 3, 56, "Subsection",ExpressionUUID->"4a395079-7eba-40d3-bd5a-41a98958e6e6"],
Cell[284276, 6083, 1535, 31, 252, "Input",ExpressionUUID->"98305265-f550-4478-9938-f88e58799674"]
}, Open  ]],
Cell[CellGroupData[{
Cell[285848, 6119, 364, 6, 56, "Subsection",ExpressionUUID->"d493a0b3-ed93-4a8c-8ed9-f29462b02be4"],
Cell[286215, 6127, 270, 4, 73, "Abstract",ExpressionUUID->"c74eed73-6eef-438d-bf41-8f2b7039fc39"],
Cell[286488, 6133, 358, 5, 30, "Subitem",ExpressionUUID->"827a1617-de03-4469-9592-ce90d10e5355"],
Cell[286849, 6140, 2730, 42, 80, "Input",ExpressionUUID->"2408580a-a157-4a2a-8120-6c54b5084dbb",
 InitializationCell->True],
Cell[289582, 6184, 7151, 139, 1404, "Input",ExpressionUUID->"67c25fc7-b84c-4a26-9f42-0fb2013de156"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296770, 6328, 357, 5, 56, "Subsection",ExpressionUUID->"4fac3ccc-b373-4284-9646-0debbdcbc979"],
Cell[297130, 6335, 2451, 43, 276, "Input",ExpressionUUID->"ebba58e1-a2cd-4f79-b8b4-ce1d8c157e48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[299618, 6383, 427, 6, 56, "Subsection",ExpressionUUID->"51464088-c0de-47f5-a04c-cccaa9353bb1"],
Cell[300048, 6391, 737, 16, 60, "Input",ExpressionUUID->"9c67a3fc-9c87-4eea-beea-9d1bc9ca4d3b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[300822, 6412, 228, 4, 56, "Subsection",ExpressionUUID->"01d7e93f-35b9-42bb-a0f6-91cbab825584"],
Cell[301053, 6418, 1182, 22, 60, "Input",ExpressionUUID->"c9887ae2-5aa1-4db6-aa76-39526f486037"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[302284, 6446, 177, 3, 77, "Section",ExpressionUUID->"2c97dbcb-6df2-4d14-8afa-54bcd7a8a7c6"],
Cell[CellGroupData[{
Cell[302486, 6453, 236, 4, 56, "Subsection",ExpressionUUID->"4dd7366d-7834-4d5e-9c74-31baed9442ac"],
Cell[302725, 6459, 878, 17, 168, "Input",ExpressionUUID->"981a7f59-e4ed-4f2f-8198-d866cdcd30e1"]
}, Closed]],
Cell[CellGroupData[{
Cell[303640, 6481, 169, 3, 46, "Subsection",ExpressionUUID->"067a6abf-84a6-4673-b263-b3bf9ad40b08"],
Cell[303812, 6486, 1551, 35, 272, "Input",ExpressionUUID->"8d49be18-206b-4e92-9fff-7e9017ecee78",
 InitializationCell->True],
Cell[305366, 6523, 3228, 75, 756, "Input",ExpressionUUID->"b1db6cff-edf7-4f66-9e3f-980e18f8e54a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[308631, 6603, 171, 3, 56, "Subsection",ExpressionUUID->"68b8594f-2581-415d-9e86-cad4ecb1a3d3"],
Cell[308805, 6608, 270, 4, 73, "Abstract",ExpressionUUID->"c1272593-03e3-448e-8d05-f7b99c841b98"],
Cell[309078, 6614, 399, 6, 30, "Subitem",ExpressionUUID->"db2dcc10-76de-40fc-959d-06aa84a07f08"],
Cell[309480, 6622, 5786, 118, 824, "Input",ExpressionUUID->"643979d5-fc82-44cd-9214-9483e4388dd4",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[315303, 6745, 329, 5, 56, "Subsection",ExpressionUUID->"d0740f30-7140-463f-a71e-05a811eb5174"],
Cell[315635, 6752, 1129, 18, 104, "Input",ExpressionUUID->"598456b2-b156-43b0-9329-2d755684cb4b",
 InitializationCell->True],
Cell[316767, 6772, 3256, 73, 564, "Input",ExpressionUUID->"6763716e-f0a7-48c4-bcef-84f9a49c289b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[320060, 6850, 234, 4, 56, "Subsection",ExpressionUUID->"e901a572-5638-4826-972b-ceffe5116eca"],
Cell[320297, 6856, 1323, 30, 204, "Input",ExpressionUUID->"eba584bd-ba47-4270-a11f-332739bd69f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[321657, 6891, 281, 4, 56, "Subsection",ExpressionUUID->"48797cb0-2f1b-4347-9713-9d8c64149a6c"],
Cell[321941, 6897, 841, 15, 108, "Input",ExpressionUUID->"8b0eb072-7d6c-4ed0-b183-89ed880b31c2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[322831, 6918, 215, 4, 77, "Section",ExpressionUUID->"dfe3383f-3473-48a1-9d3d-4e47e4cf6cc5"],
Cell[323049, 6924, 1826, 32, 176, "Input",ExpressionUUID->"88849c43-171e-4634-a0ef-de9c0a5d8cd3",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[324900, 6960, 323, 5, 56, "Subsection",ExpressionUUID->"93a553e2-9a7e-47b0-8fa6-15f5a1db8194"],
Cell[325226, 6967, 1672, 40, 300, "Input",ExpressionUUID->"a300a896-b201-4e2e-adf1-6694c45b91b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326935, 7012, 331, 5, 56, "Subsection",ExpressionUUID->"2cea9f2f-dd08-45d1-93f6-33513713c5fa"],
Cell[327269, 7019, 828, 18, 156, "Input",ExpressionUUID->"a04d5dde-b2e2-4d72-b46f-34b1ccef04c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328134, 7042, 328, 5, 56, "Subsection",ExpressionUUID->"c13b63dc-63e8-42f4-b99c-2db780e2f900"],
Cell[328465, 7049, 2325, 62, 324, "Input",ExpressionUUID->"23d8080e-cbe8-415e-b4e8-e52386829c4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[330827, 7116, 344, 5, 56, "Subsection",ExpressionUUID->"c60d9c29-406e-45c1-970c-061e669824ce"],
Cell[331174, 7123, 3937, 101, 732, "Input",ExpressionUUID->"7955f01d-76d5-40e2-b686-fd03065849f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[335148, 7229, 236, 4, 56, "Subsection",ExpressionUUID->"ec58058f-61ab-4b43-8abb-e9e27837dfd0"],
Cell[335387, 7235, 1574, 35, 324, "Input",ExpressionUUID->"f099276f-00ee-46f5-b40b-64843623c544"]
}, Open  ]],
Cell[CellGroupData[{
Cell[336998, 7275, 241, 4, 56, "Subsection",ExpressionUUID->"81c234aa-c04b-4f42-98aa-99f449c000d8"],
Cell[337242, 7281, 3916, 73, 420, "Input",ExpressionUUID->"79f28216-482b-408c-bc86-1d10b9c9c003"]
}, Open  ]],
Cell[CellGroupData[{
Cell[341195, 7359, 235, 4, 56, "Subsection",ExpressionUUID->"359bb13a-e7d8-42a3-a093-4c6a2fb43d2d"],
Cell[341433, 7365, 2023, 36, 276, "Input",ExpressionUUID->"9b91884d-a00b-4a65-b334-07ff96f9b1e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[343493, 7406, 281, 4, 56, "Subsection",ExpressionUUID->"c6c627f8-9ef7-49b8-b2b5-1a511e5ddca9"],
Cell[343777, 7412, 825, 16, 132, "Input",ExpressionUUID->"9c89235e-7e17-44a5-9280-30d81394c2d8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[344651, 7434, 224, 4, 77, "Section",ExpressionUUID->"7b15c882-365f-476a-9114-64c0d4124965"],
Cell[344878, 7440, 270, 4, 73, "Abstract",ExpressionUUID->"73ab739a-0089-4b65-937c-86ba5417e477"],
Cell[345151, 7446, 487, 7, 30, "Subitem",ExpressionUUID->"7d79f7c4-6949-4645-b5ca-27a46bac3e7c"],
Cell[CellGroupData[{
Cell[345663, 7457, 366, 6, 56, "Subsection",ExpressionUUID->"dd96334a-7791-4e49-806a-52c32a78cd76"],
Cell[346032, 7465, 3954, 98, 540, "Input",ExpressionUUID->"edc83ff9-cac3-4dbd-9d0f-8bee2dee6bc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[350023, 7568, 340, 5, 56, "Subsection",ExpressionUUID->"56f498b8-c7b5-4fd8-8ae7-2a55c6393096"],
Cell[350366, 7575, 594, 12, 108, "Input",ExpressionUUID->"e629e428-9e55-4332-be44-a5b96a273777"]
}, Open  ]],
Cell[CellGroupData[{
Cell[350997, 7592, 487, 7, 56, "Subsection",ExpressionUUID->"60f3776e-3f6f-4584-b705-0dacd5be24ac"],
Cell[351487, 7601, 1820, 28, 101, "Input",ExpressionUUID->"60170b00-290f-426c-940d-ba4993ad9000"]
}, Closed]],
Cell[CellGroupData[{
Cell[353344, 7634, 299, 4, 46, "Subsection",ExpressionUUID->"31ec0166-5dbf-43c0-8544-a13e501b8461"],
Cell[353646, 7640, 2767, 70, 756, "Input",ExpressionUUID->"ebcbbb9a-0404-4178-a6ea-75a7673e2ab8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[356450, 7715, 329, 5, 56, "Subsection",ExpressionUUID->"712c0e3c-0985-4ce6-aaa7-89b491934033"],
Cell[356782, 7722, 270, 4, 73, "Abstract",ExpressionUUID->"81abe807-3cb4-47b7-9fb5-0dddd0b1c865"],
Cell[357055, 7728, 424, 6, 30, "Subitem",ExpressionUUID->"f7dee976-45af-4b9b-8852-85c4613f57a5"],
Cell[357482, 7736, 1232, 20, 104, "Input",ExpressionUUID->"62afedf6-7202-4f0f-aa24-ccea3eb1270c",
 InitializationCell->True],
Cell[358717, 7758, 3347, 75, 564, "Input",ExpressionUUID->"06903d05-b1a3-448a-9c97-b3598ff6d0d0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[362101, 7838, 234, 4, 56, "Subsection",ExpressionUUID->"1333a4ee-2f38-425e-af17-b3865c9bfcc6"],
Cell[362338, 7844, 1580, 36, 228, "Input",ExpressionUUID->"e8e7e04d-364a-4f82-8d78-c3bfc016a31e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[363955, 7885, 290, 4, 56, "Subsection",ExpressionUUID->"d443c9a6-1d0e-4022-87d2-e2d6940a6aff"],
Cell[364248, 7891, 936, 17, 108, "Input",ExpressionUUID->"b50ed1d1-072b-4fd0-ad66-c33adf4239ec"],
Cell[365187, 7910, 1504, 46, 35, "Input",ExpressionUUID->"06529d3b-605c-4051-abc0-4ec0b2023913"],
Cell[366694, 7958, 178, 2, 104, "Abstract",ExpressionUUID->"ef9f560c-e9af-4107-ac44-2b8ce5a2832b"],
Cell[366875, 7962, 363, 11, 206, "Abstract",ExpressionUUID->"567ecb94-45b2-435c-8c53-43142c7e7b97"],
Cell[367241, 7975, 1632, 25, 60, "Input",ExpressionUUID->"c7f997bc-0136-4d0f-9550-830a97e2f71b"],
Cell[368876, 8002, 235, 3, 87, "Abstract",ExpressionUUID->"b79228f8-8ff0-4318-9d97-79d8fca2233d"],
Cell[369114, 8007, 808, 14, 55, "Input",ExpressionUUID->"d3b67e91-092d-4bf5-ae8d-0e030657e7fd",
 InitializationCell->True],
Cell[369925, 8023, 1311, 25, 156, "Input",ExpressionUUID->"86b49194-ee77-47de-afc6-f18451b4dfa0"],
Cell[371239, 8050, 232, 3, 87, "Abstract",ExpressionUUID->"f9ee2530-2b2f-449b-a467-cd4a7a6a53b3"],
Cell[371474, 8055, 1433, 38, 300, "Input",ExpressionUUID->"e0583d81-de65-4ae8-a369-d7a8ecf2bf2d"],
Cell[372910, 8095, 234, 3, 87, "Abstract",ExpressionUUID->"c07b6776-4ea3-49b6-a5ab-243a2db49afc"],
Cell[373147, 8100, 1609, 34, 156, "Input",ExpressionUUID->"767854d0-2cec-403f-a8ed-4784e4d230b7"],
Cell[374759, 8136, 228, 3, 87, "Abstract",ExpressionUUID->"13eadc33-12e8-4af6-a2d3-cdd9d6bee15c"],
Cell[374990, 8141, 3034, 69, 824, "Input",ExpressionUUID->"b6706c63-1144-45e3-8595-69394da9b35d",
 InitializationCell->True],
Cell[378027, 8212, 3592, 88, 660, "Input",ExpressionUUID->"67e39a7c-ef66-4f3e-b481-a17b9c2ff424"],
Cell[381622, 8302, 290, 4, 87, "Abstract",ExpressionUUID->"b07c7f36-d8e0-4879-b246-89d385e6d807"],
Cell[381915, 8308, 1748, 38, 372, "Input",ExpressionUUID->"78b9b7cd-1c14-4c4a-8e2b-e60fffbb808f"],
Cell[383666, 8348, 1506, 46, 35, "Input",ExpressionUUID->"6144916c-912b-4d81-aee4-7c6eea291295"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[385221, 8400, 481, 7, 77, "Section",ExpressionUUID->"c63702c1-a394-48ee-b193-2d3e4d46b10e"],
Cell[CellGroupData[{
Cell[385727, 8411, 305, 4, 56, "Subsection",ExpressionUUID->"28ad85fe-f71a-4275-898a-603d82ff4984"],
Cell[386035, 8417, 7799, 146, 1020, "Input",ExpressionUUID->"b01a0623-27b0-4838-8901-545ea48b4d15"],
Cell[393837, 8565, 1357, 42, 35, "Input",ExpressionUUID->"0074c942-2c50-46de-9f81-7be0714574a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[395231, 8612, 233, 4, 56, "Subsection",ExpressionUUID->"55505fd0-c017-46c0-a5a6-961cc14a2b9c"],
Cell[395467, 8618, 1875, 42, 372, "Input",ExpressionUUID->"a6d66661-1356-4058-b346-8aba2f0799c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[397379, 8665, 186, 3, 56, "Subsection",ExpressionUUID->"30411647-9621-4220-bb23-908abf46f818"],
Cell[397568, 8670, 540, 10, 108, "Input",ExpressionUUID->"1e652275-19eb-462f-bb1b-f44d276df64d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[398145, 8685, 336, 5, 56, "Subsection",ExpressionUUID->"665c6e48-42f4-4c89-94a2-6a3da708e075"],
Cell[398484, 8692, 708, 14, 108, "Input",ExpressionUUID->"34cf8fbf-a8ec-4273-8d0a-ea35b242be9c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[399229, 8711, 240, 4, 56, "Subsection",ExpressionUUID->"0daef9d0-7341-4f56-b312-f8695cb56ef6"],
Cell[399472, 8717, 3046, 49, 176, "Input",ExpressionUUID->"93a579ab-8056-4c9a-b0e2-035e635cba3a",
 InitializationCell->True],
Cell[402521, 8768, 934, 17, 108, "Input",ExpressionUUID->"adb63223-1aa1-4508-9661-fd954075809e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[403492, 8790, 296, 4, 56, "Subsection",ExpressionUUID->"01d6b984-5e7d-4a27-8bf3-77ceecd0a6cb"],
Cell[403791, 8796, 1588, 34, 396, "Input",ExpressionUUID->"517aa383-712b-499c-98fc-76526f141e64"]
}, Open  ]]
}, Open  ]]
}
]
*)

